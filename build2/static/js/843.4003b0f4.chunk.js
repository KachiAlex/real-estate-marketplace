"use strict";(self.webpackChunkreal_estate_marketplace=self.webpackChunkreal_estate_marketplace||[]).push([[843],{843:(e,t,r)=>{r.r(t),r.d(t,{default:()=>h});var s=r(5043),i=r(3216),n=r(5475),o=r(4345),a=r(5016),l=r(5369),d=r(3768),c=r(5032),m=r(2407),u=r(7210),p=r(579);const v=e=>{let{property:t,className:r=""}=e;const{user:i}=(0,a.As)(),[n,o]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if(n){const{style:e}=document.body,t=e.overflow;return e.overflow="hidden",()=>{e.overflow=t}}},[n]);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("button",{onClick:()=>{i?o(!0):d.Ay.error("Login is temporarily unavailable while we rebuild the auth experience.")},className:`w-full bg-brand-blue hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors flex items-center justify-center space-x-2 ${r}`,children:[(0,p.jsx)(l.AsH,{className:"h-5 w-5"}),(0,p.jsx)("span",{children:"Buy with Escrow Protection"}),(0,p.jsx)(l.SMR,{className:"h-4 w-4"})]}),n&&(0,p.jsx)(u.default,{property:t,onClose:()=>o(!1),isModal:!0})]})},h=()=>{var e,t,r,u,h,g,x,y,f,b,N,j,w,I,S,A,k,_,$,P,E,C,q;const{id:D}=(0,i.g)(),{properties:L,loading:V,error:O,toggleFavorite:T}=((0,i.Zp)(),(0,o.NC)()),{user:B,setAuthRedirect:M}=(0,a.As)(),[J,U]=(0,s.useState)(null),[R,F]=(0,s.useState)(0),[z,W]=(0,s.useState)(!1),[X,H]=(0,s.useState)(""),[Q,Z]=(0,s.useState)(!1),[G,K]=(0,s.useState)(""),[Y,ee]=(0,s.useState)(""),[te,re]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if(L&&D){const e=L.find(e=>{var t;return e.id===D||e.propertyId===D||e.numericId===parseInt(D)||e.id===`prop_${D}`||(null===(t=e.id)||void 0===t?void 0:t.toString())===(null===D||void 0===D?void 0:D.toString())});if(e){if(e.location&&"string"===typeof e.location&&e.location.includes("undefined")){const t=[e.address,e.city,e.state].filter(e=>e&&"undefined"!==e&&void 0!==e&&null!==e);t.length>0&&(e.location=t.join(", "))}U(e),F(0)}}},[L,D]),(0,s.useEffect)(()=>{if(J&&B&&B.id){const e=`favorites_${B.id}`,t=new Set(JSON.parse(localStorage.getItem(e)||"[]"));re(t.has(J.id))}else re(!1)},[J,B]);const se=e=>"string"===typeof e?e:e&&e.url?e.url:"https://images.unsplash.com/photo-1564013799919-ab600027ffc6?w=80&h=80&fit=crop",ie=()=>{navigator.clipboard.writeText(window.location.href).then(()=>{d.Ay.success("Property link copied to clipboard!")}).catch(()=>{d.Ay.error("Failed to copy link")})},ne=function(e,t){var r,s,i,n,o,a,l,d,c,m,u,p,v,h,g,x;let y=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!B||!B.id||!e)return void console.warn("createInquiry: Missing user or property information");const f=JSON.parse(localStorage.getItem("inquiries")||"[]"),b=f.find(t=>t.propertyId===e.id&&(t.userId===B.id||t.buyerId===B.id)&&("new"===t.status||"pending"===t.status||"contacted"===t.status));if(b)return b;const N={id:`inquiry-${Date.now()}`,propertyId:e.id,propertyTitle:e.title,propertyLocation:"string"===typeof e.location?e.location:(null===(r=e.location)||void 0===r?void 0:r.address)||(null===(s=e.location)||void 0===s?void 0:s.city)||"Location not specified",propertyPrice:e.price||0,propertyImage:(null===(i=e.images)||void 0===i||null===(n=i[0])||void 0===n?void 0:n.url)||e.image||(null===(o=e.images)||void 0===o?void 0:o[0])||"",propertyBedrooms:e.bedrooms||(null===(a=e.details)||void 0===a?void 0:a.bedrooms)||0,propertyBathrooms:e.bathrooms||(null===(l=e.details)||void 0===l?void 0:l.bathrooms)||0,propertyArea:e.area||(null===(d=e.details)||void 0===d?void 0:d.sqft)||0,userId:B.id,buyerId:B.id,buyerName:`${B.firstName} ${B.lastName}`,buyerEmail:B.email,buyerPhone:B.phone||"",vendorId:e.vendorId||(null===(c=e.owner)||void 0===c?void 0:c.id)||(null===(m=e.vendor)||void 0===m?void 0:m.id)||"",vendorName:null!==(u=e.owner)&&void 0!==u&&u.firstName?`${e.owner.firstName} ${e.owner.lastName||""}`.trim():null!==(p=e.vendor)&&void 0!==p&&p.firstName?`${e.vendor.firstName} ${e.vendor.lastName||""}`.trim():"Property Vendor",vendorEmail:(null===(v=e.owner)||void 0===v?void 0:v.email)||(null===(h=e.vendor)||void 0===h?void 0:h.email)||e.vendorEmail||"",vendorPhone:(null===(g=e.owner)||void 0===g?void 0:g.phone)||e.vendorPhone||e.contactPhone||(null===(x=e.vendor)||void 0===x?void 0:x.phone)||"",inquiryType:t,message:y||`I'm interested in ${e.title}. Please contact me.`,status:"new",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),responses:[]};return f.push(N),localStorage.setItem("inquiries",JSON.stringify(f)),window.dispatchEvent(new CustomEvent("inquiriesUpdated",{detail:{inquiry:N,action:"created"}})),window.dispatchEvent(new StorageEvent("storage",{key:"inquiries",newValue:JSON.stringify(f)})),N};if(V)return(0,p.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,p.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})});if(O)return(0,p.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,p.jsxs)("div",{className:"text-center",children:[(0,p.jsx)("h2",{className:"text-2xl font-bold text-red-600 mb-4",children:"Error Loading Property"}),(0,p.jsx)("p",{className:"text-gray-600",children:O})]})});if(!J)return(0,p.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,p.jsxs)("div",{className:"text-center",children:[(0,p.jsx)(m.A,{items:[{label:"Home",path:"/"},{label:"Properties",path:"/properties"},{label:"Property Not Found",path:"#"}]}),(0,p.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Property Not Found"}),(0,p.jsx)("p",{className:"text-gray-600",children:"The property you're looking for doesn't exist."}),(0,p.jsx)(n.N_,{to:"/properties",className:"mt-4 inline-block text-blue-600 hover:text-blue-500",children:"Back to Properties"})]})});const oe=[{label:"Home",path:"/"},{label:"Properties",path:"/properties"},{label:(null===J||void 0===J?void 0:J.title)||"Property Details",path:"#"}];return(0,p.jsxs)("div",{className:"min-h-screen bg-gray-50 py-8",children:[(0,p.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,p.jsx)("div",{className:"mb-8",children:(0,p.jsx)(m.A,{items:oe})}),(0,p.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,p.jsxs)("div",{className:"lg:col-span-2",children:[(0,p.jsxs)("div",{className:"mb-8",children:[(0,p.jsxs)("div",{className:"relative",children:[(0,p.jsx)("img",{src:(()=>{if(!J)return"https://images.unsplash.com/photo-1564013799919-ab600027ffc6?w=800&h=600&fit=crop";if(J.images&&Array.isArray(J.images)&&J.images.length>0){const e=Math.max(0,Math.min(R,J.images.length-1)),t=J.images[e];if("string"===typeof t)return t;if(t&&t.url)return t.url}return J.image?J.image:"https://images.unsplash.com/photo-1564013799919-ab600027ffc6?w=800&h=600&fit=crop"})(),alt:J.title,className:"w-full h-96 object-cover rounded-lg"},`main-image-${R}`),(0,p.jsxs)("div",{className:"absolute top-4 right-4 flex gap-2",children:[(0,p.jsxs)("span",{className:"bg-blue-600 text-white px-3 py-1 rounded-full text-sm font-medium",children:["\u20a6",null===(e=J.price)||void 0===e?void 0:e.toLocaleString()]}),(0,p.jsx)("button",{onClick:async()=>{if(!B||!B.id)return void d.Ay.error("Please login to add favorites");if(!J||!J.id)return void d.Ay.error("Property information not available");const e=`favorites_${B.id}`,t=te,r=String(J.id);let s;re(!t);try{const i=new Set(JSON.parse(localStorage.getItem(e)||"[]"));t?(i.delete(r),d.Ay.success("Property removed from saved properties")):(i.add(r),d.Ay.success("Property added to saved properties")),s=Array.from(i),localStorage.setItem(e,JSON.stringify(s))}catch{}try{const i=await T(r,J);if(!i||void 0===i.success)throw new Error("Failed to toggle favorite on server");window.dispatchEvent(new CustomEvent("favoritesUpdated",{detail:{propertyId:r,favorited:!t}})),s&&window.dispatchEvent(new StorageEvent("storage",{key:e,newValue:JSON.stringify(s)}))}catch(O){console.error("Error toggling favorite:",O),re(t);try{const s=new Set(JSON.parse(localStorage.getItem(e)||"[]"));t?s.add(r):s.delete(r),localStorage.setItem(e,JSON.stringify(Array.from(s)))}catch{}d.Ay.error("Failed to update saved properties. Please try again.")}},className:"bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-75 transition-colors "+(te?"text-red-500":""),title:te?"Remove from favorites":"Add to favorites",children:(0,p.jsx)(l.Mbv,{className:te?"fill-current":""})}),(0,p.jsx)("button",{onClick:async()=>{if(navigator.share)try{await navigator.share({title:J.title,text:J.description,url:window.location.href})}catch(O){console.log("Error sharing:",O),ie()}else ie()},className:"bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-75 transition-colors",children:(0,p.jsx)(l.Zzu,{})})]})]}),J.images&&Array.isArray(J.images)&&J.images.length>1&&(0,p.jsx)("div",{className:"mt-4 flex space-x-2 overflow-x-auto pb-2",children:J.images.map((e,t)=>(0,p.jsx)("button",{type:"button",onClick:e=>{e.preventDefault(),F(t)},className:"flex-shrink-0 w-20 h-20 rounded-md overflow-hidden border-2 transition-all "+(R===t?"border-blue-500 ring-2 ring-blue-300 ring-offset-2":"border-gray-200 hover:border-gray-300"),children:(0,p.jsx)("img",{src:se(e),alt:`${J.title} ${t+1}`,className:"w-full h-full object-cover"})},`thumb-${t}`))})]}),(0,p.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:[(0,p.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:J.title}),(0,p.jsx)("p",{className:"text-lg text-gray-600 mb-6",children:(()=>{if("string"===typeof J.location)return J.location;if(J.location&&"object"===typeof J.location){return[J.location.address||"",J.location.city||"",J.location.state||""].filter(Boolean).join(", ")||"Location not specified"}return"Location not specified"})()}),(0,p.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[(0,p.jsxs)("div",{className:"text-center",children:[(0,p.jsxs)("div",{className:"text-2xl font-bold text-blue-600 flex items-center justify-center",children:[(0,p.jsx)(l.TiC,{className:"mr-2"}),J.bedrooms||(null===(t=J.details)||void 0===t?void 0:t.bedrooms)||0]}),(0,p.jsx)("div",{className:"text-sm text-gray-500",children:"Bedrooms"})]}),(0,p.jsxs)("div",{className:"text-center",children:[(0,p.jsxs)("div",{className:"text-2xl font-bold text-blue-600 flex items-center justify-center",children:[(0,p.jsx)(l.F6e,{className:"mr-2"}),J.bathrooms||(null===(r=J.details)||void 0===r?void 0:r.bathrooms)||0]}),(0,p.jsx)("div",{className:"text-sm text-gray-500",children:"Bathrooms"})]}),(0,p.jsxs)("div",{className:"text-center",children:[(0,p.jsxs)("div",{className:"text-2xl font-bold text-blue-600 flex items-center justify-center",children:[(0,p.jsx)(l.VlX,{className:"mr-2"}),J.area||(null===(u=J.details)||void 0===u?void 0:u.sqft)||0]}),(0,p.jsx)("div",{className:"text-sm text-gray-500",children:"Sq Ft"})]}),(0,p.jsxs)("div",{className:"text-center",children:[(0,p.jsx)("div",{className:"text-2xl font-bold text-blue-600 capitalize",children:J.type}),(0,p.jsx)("div",{className:"text-sm text-gray-500",children:"Type"})]})]}),(0,p.jsxs)("div",{className:"border-t pt-6",children:[(0,p.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Description"}),(0,p.jsx)("p",{className:"text-gray-600 leading-relaxed",children:J.description})]})]}),J.amenities&&J.amenities.length>0&&(0,p.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:[(0,p.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Amenities"}),(0,p.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:J.amenities.map((e,t)=>(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)("svg",{className:"w-5 h-5 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,p.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,p.jsx)("span",{className:"text-gray-700",children:e})]},t))})]})]}),(0,p.jsxs)("div",{className:"lg:col-span-1",children:[(0,p.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,p.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),(0,p.jsxs)("div",{className:"space-y-3",children:[(0,p.jsxs)("button",{onClick:()=>{var e,t;if(console.log("Contact Owner clicked, property:",J,"user:",B),!B)return void d.Ay.error("Please login to contact property vendor");ne(J,"message",`I'm interested in ${J.title}. Please contact me via WhatsApp.`);const r=(null===J||void 0===J||null===(e=J.owner)||void 0===e?void 0:e.phone)||(null===J||void 0===J?void 0:J.vendorPhone)||(null===J||void 0===J?void 0:J.contactPhone)||(null===J||void 0===J||null===(t=J.vendor)||void 0===t?void 0:t.phone);if(!r)return void d.Ay.error("Vendor phone number not available");let s=r.replace(/\D/g,"");s.startsWith("234")||(s=s.startsWith("0")?"234"+s.substring(1):"234"+s);const i=(null===J||void 0===J?void 0:J.title)||"Property",n=null!==J&&void 0!==J&&J.price?`\u20a6${J.price.toLocaleString()}`:"",o=`https://wa.me/${s}?text=${encodeURIComponent(`Hi, I'm interested in your property: ${i}${n?` (${n})`:""}. Could you please provide more information?`)}`;window.open(o,"_blank"),d.Ay.success("Opening WhatsApp... Inquiry saved to My Inquiries.")},className:"w-full bg-green-600 text-white py-3 px-4 rounded-md hover:bg-green-700 transition-colors flex items-center justify-center",children:[(0,p.jsx)(l.EcP,{className:"mr-2"}),"Contact Vendor"]}),(0,p.jsxs)("button",{onClick:()=>{B?Z(!0):d.Ay.error("Please login to schedule a viewing")},className:"w-full bg-green-600 text-white py-3 px-4 rounded-md hover:bg-green-700 transition-colors flex items-center justify-center",children:[(0,p.jsx)(l.itz,{className:"mr-2"}),"Schedule Viewing"]}),(0,p.jsxs)("button",{onClick:()=>{var e,t;if(!B)return void d.Ay.error("Please login to call property vendor");ne(J,"call",`I'm interested in ${J.title}. Please contact me via phone call.`);const r=(null===J||void 0===J||null===(e=J.owner)||void 0===e?void 0:e.phone)||(null===J||void 0===J?void 0:J.vendorPhone)||(null===J||void 0===J?void 0:J.contactPhone)||(null===J||void 0===J||null===(t=J.vendor)||void 0===t?void 0:t.phone);if(!r)return void d.Ay.error("Vendor phone number not available");let s=r.replace(/\D/g,"");s.startsWith("234")||(s=s.startsWith("0")?"234"+s.substring(1):"234"+s),window.location.href=`tel:+${s}`,d.Ay.success("Inquiry saved to My Inquiries.")},className:"w-full bg-blue-600 text-white py-3 px-4 rounded-md hover:bg-blue-700 transition-colors flex items-center justify-center",children:[(0,p.jsx)(l.Cab,{className:"mr-2"}),"Call Vendor"]})]})]}),(0,p.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,p.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Property Vendor"}),(0,p.jsxs)("div",{className:"space-y-3",children:[(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)("div",{className:"w-12 h-12 bg-gray-300 rounded-full flex items-center justify-center mr-3",children:(0,p.jsxs)("span",{className:"text-gray-600 font-semibold",children:[(null===(h=J.owner)||void 0===h||null===(g=h.firstName)||void 0===g?void 0:g[0])||(null===(x=J.vendor)||void 0===x||null===(y=x.firstName)||void 0===y?void 0:y[0])||"V",(null===(f=J.owner)||void 0===f||null===(b=f.lastName)||void 0===b?void 0:b[0])||(null===(N=J.vendor)||void 0===N||null===(j=N.lastName)||void 0===j?void 0:j[0])||"D"]})}),(0,p.jsxs)("div",{children:[(0,p.jsxs)("div",{className:"font-semibold text-gray-900",children:[(null===(w=J.owner)||void 0===w?void 0:w.firstName)||(null===(I=J.vendor)||void 0===I?void 0:I.firstName)||"Vendor"," ",(null===(S=J.owner)||void 0===S?void 0:S.lastName)||(null===(A=J.vendor)||void 0===A?void 0:A.lastName)||""]}),(0,p.jsx)("div",{className:"text-sm text-gray-500",children:"Property Vendor"})]})]}),(0,p.jsxs)("div",{className:"pt-3 border-t",children:[(0,p.jsxs)("div",{className:"flex items-start text-gray-600 mb-3",children:[(0,p.jsx)(l.vq8,{className:"mr-2 mt-0.5 flex-shrink-0"}),(0,p.jsx)("span",{className:"text-sm",children:(()=>{const e=J.address||"",t=J.city||"",r=J.state||"",s=J.zipCode||"";if(e||t||r){const i=[e,t,r,s].filter(e=>e&&""!==e&&null!==e&&void 0!==e&&"undefined"!==e);if(i.length>0)return i.join(", ")}if(J.location&&"object"===typeof J.location){const e=[J.location.address,J.location.city,J.location.state,J.location.zipCode].filter(e=>e&&""!==e&&null!==e&&void 0!==e&&"undefined"!==e);if(e.length>0)return e.join(", ")}return"string"!==typeof J.location||""===J.location.trim()||J.location.includes("undefined")?"Location not specified":J.location})()})]}),J.createdAt&&(0,p.jsxs)("div",{className:"flex items-center text-gray-600 mb-3 text-sm",children:[(0,p.jsx)(l.itz,{className:"mr-2"}),(0,p.jsxs)("span",{children:["Listed: ",(()=>{const e=new Date(J.createdAt);return isNaN(e.getTime())?J.createdAt:e.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})()]})]}),(0,p.jsxs)("div",{className:"flex items-center text-gray-600 text-sm",children:[(0,p.jsxs)("span",{children:["Views: ",J.views||0]}),(0,p.jsx)("span",{className:"mx-2",children:"\u2022"}),(0,p.jsx)("span",{children:J.isVerified?"\u2705 Verified":"\u23f3 Pending Verification"})]})]})]})]}),(0,p.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,p.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Purchase Information"}),(0,p.jsxs)("div",{className:"space-y-3",children:[(0,p.jsxs)("div",{className:"flex justify-between",children:[(0,p.jsx)("span",{className:"text-gray-600",children:"Property Value:"}),(0,p.jsxs)("span",{className:"font-semibold",children:["\u20a6",null===(k=J.price)||void 0===k?void 0:k.toLocaleString()]})]}),(0,p.jsxs)("div",{className:"flex justify-between",children:[(0,p.jsx)("span",{className:"text-gray-600",children:"Property Type:"}),(0,p.jsx)("span",{className:"font-semibold capitalize",children:null===(_=J.status)||void 0===_?void 0:_.replace("-"," ")})]}),(0,p.jsxs)("div",{className:"flex justify-between",children:[(0,p.jsx)("span",{className:"text-gray-600",children:"Escrow Fee (0.5%):"}),(0,p.jsxs)("span",{className:"font-semibold",children:["\u20a6",Math.round(.005*(J.price||0)).toLocaleString()]})]}),(0,p.jsxs)("div",{className:"flex justify-between border-t pt-3",children:[(0,p.jsx)("span",{className:"text-gray-900 font-semibold",children:"Total Amount:"}),(0,p.jsxs)("span",{className:"font-bold text-lg",children:["\u20a6",Math.round(1.005*(J.price||0)).toLocaleString()]})]})]}),(0,p.jsx)("div",{className:"mt-4 space-y-2",children:(0,p.jsx)(v,{property:J,className:"bg-green-600 hover:bg-green-700"})})]}),(0,p.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,p.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Property Information"}),(0,p.jsxs)("div",{className:"space-y-3",children:[(0,p.jsxs)("div",{className:"flex justify-between",children:[(0,p.jsx)("span",{className:"text-gray-600",children:"Property ID:"}),(0,p.jsx)("span",{className:"font-medium",children:J.id})]}),J.createdAt&&(0,p.jsxs)("div",{className:"flex justify-between",children:[(0,p.jsx)("span",{className:"text-gray-600",children:"Listed:"}),(0,p.jsx)("span",{className:"font-medium",children:(()=>{const e=new Date(J.createdAt);return isNaN(e.getTime())?J.createdAt||J.dateListed||"N/A":e.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})()})]}),(0,p.jsxs)("div",{className:"flex justify-between",children:[(0,p.jsx)("span",{className:"text-gray-600",children:"Status:"}),(0,p.jsx)("span",{className:"font-medium text-green-600",children:"Available"})]}),(0,p.jsxs)("div",{className:"flex justify-between",children:[(0,p.jsx)("span",{className:"text-gray-600",children:"Vendor:"}),(0,p.jsx)("span",{className:"font-medium",children:J.ownerName||`${(null===($=J.owner)||void 0===$?void 0:$.firstName)||(null===(P=J.vendor)||void 0===P?void 0:P.firstName)||""} ${(null===(E=J.owner)||void 0===E?void 0:E.lastName)||(null===(C=J.vendor)||void 0===C?void 0:C.lastName)||""}`.trim()||"Vendor"})]}),(null===(q=J.location)||void 0===q?void 0:q.googleMapsUrl)&&(0,p.jsxs)("div",{className:"border-t pt-4 mt-4",children:[(0,p.jsx)("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Location"}),(0,p.jsx)("div",{className:"space-y-2",children:(0,p.jsxs)("a",{href:J.location.googleMapsUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center w-full px-3 py-2 bg-blue-50 text-blue-700 rounded-md hover:bg-blue-100 transition-colors text-sm",children:[(0,p.jsxs)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,p.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,p.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Show on Google map"]})})]})]})]})]})]})]}),z&&(0,p.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,p.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[(0,p.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,p.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Send Inquiry"}),(0,p.jsx)("button",{onClick:()=>W(!1),className:"text-gray-400 hover:text-gray-600",children:(0,p.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,p.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,p.jsx)("div",{className:"mb-4",children:(0,p.jsxs)("p",{className:"text-sm text-gray-600",children:["Send a message to the property vendor about ",(0,p.jsx)("strong",{children:J.title})]})}),(0,p.jsxs)("div",{className:"space-y-4",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Your Message"}),(0,p.jsx)("textarea",{value:X,onChange:e=>H(e.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"I'm interested in this property. Could you please provide more information about..."})]}),(0,p.jsxs)("div",{className:"flex gap-3",children:[(0,p.jsx)("button",{onClick:()=>W(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,p.jsx)("button",{onClick:()=>{X.trim()?(d.Ay.success("Inquiry sent successfully! The vendor will contact you soon."),W(!1),H("")):d.Ay.error("Please enter your message")},className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Send Message"})]})]})]})}),Q&&(0,p.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,p.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[(0,p.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,p.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Schedule Viewing"}),(0,p.jsx)("button",{onClick:()=>Z(!1),className:"text-gray-400 hover:text-gray-600",children:(0,p.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,p.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,p.jsxs)("div",{className:"space-y-4",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preferred Date"}),(0,p.jsx)("input",{type:"date",value:G,onChange:e=>K(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preferred Time"}),(0,p.jsx)("input",{type:"time",value:Y,onChange:e=>ee(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,p.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,p.jsx)("button",{onClick:()=>Z(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,p.jsx)("button",{onClick:async()=>{var e,t,r;if(!G||!Y)return void d.Ay.error("Please select a preferred date and time");if(!B||!B.id||!B.firstName||!B.lastName||!B.email)return void d.Ay.error("User information incomplete. Please refresh and try again.");const s={id:`viewing-${Date.now()}`,propertyId:J.id,propertyTitle:J.title,propertyLocation:J.location,userId:B.id,userName:`${B.firstName} ${B.lastName}`,userEmail:B.email,status:"pending_vendor",requestedAt:(new Date).toISOString(),preferredDate:G,preferredTime:Y,message:"",agentContact:J.agent||{name:"Property Agent",phone:"+234-XXX-XXXX",email:"agent@example.com"},projectId:J.id,projectName:J.title,projectLocation:(null===(e=J.location)||void 0===e?void 0:e.address)||J.location||"",buyerName:`${B.firstName} ${B.lastName}`,buyerEmail:B.email,vendorId:J.vendorId||(null===(t=J.owner)||void 0===t?void 0:t.id)||void 0,vendorEmail:J.vendorEmail||(null===(r=J.owner)||void 0===r?void 0:r.email)||void 0};try{await(0,c.Ix)(s),Z(!1),K(""),ee(""),d.Ay.success("Viewing scheduled! The vendor has been notified."),(0,d.Ay)(`Agent: ${s.agentContact.name} | Phone: ${s.agentContact.phone}`)}catch(i){d.Ay.error("Failed to create request")}},className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:"Confirm"})]})]})]})})]})}},2407:(e,t,r)=>{r.d(t,{A:()=>a});r(5043);var s=r(3216),i=r(5475),n=r(5369),o=r(579);const a=e=>{let{items:t}=e;const r=(0,s.zy)().pathname.split("/").filter(e=>e),a=t||[{label:"Home",path:"/"},...r.map((e,t)=>{const s=`/${r.slice(0,t+1).join("/")}`;return{label:e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),path:s}})];return(0,o.jsx)("nav",{className:"flex items-center space-x-2 text-sm text-gray-600 mb-4","aria-label":"Breadcrumb",children:(0,o.jsx)("ol",{className:"flex items-center space-x-2",children:a.map((e,t)=>{const r=t===a.length-1;return(0,o.jsxs)("li",{className:"flex items-center",children:[0===t&&(0,o.jsx)(n.rQ8,{className:"h-4 w-4 text-gray-400 mr-2","aria-hidden":"true"}),r?(0,o.jsx)("span",{className:"text-gray-900 font-medium","aria-current":"page",children:e.label}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.N_,{to:e.path,className:"hover:text-blue-600 transition-colors","aria-label":`Navigate to ${e.label}`,children:e.label}),(0,o.jsx)(n.X6T,{className:"h-3 w-3 text-gray-400 mx-2","aria-hidden":"true"})]})]},e.path||t)})})})}},5032:(e,t,r)=>{r.d(t,{FH:()=>h,HK:()=>y,Ix:()=>g,o2:()=>x});var s=r(1692);const i="viewingRequests",n="inspectionActivityLog",o={totalRequests:0,pendingResponses:0,confirmed:0,vendorProposals:0,buyerReschedules:0,cancelledByBuyer:0,cancelledByVendor:0,timeline:[]},a=(e,t)=>{if("undefined"!==typeof window)if("storage"!==e)"function"===typeof window.dispatchEvent&&window.dispatchEvent(new CustomEvent(e,{detail:t}));else try{window.dispatchEvent(new StorageEvent("storage",t))}catch{window.dispatchEvent(new CustomEvent("storage",{detail:t}))}},l=()=>{try{return JSON.parse(localStorage.getItem(i)||"[]")}catch{return[]}},d=e=>{localStorage.setItem(i,JSON.stringify(e))},c=()=>{try{return JSON.parse(localStorage.getItem(n)||"[]")}catch{return[]}},m=(e,t)=>e||t?t?e?`${e} ${t}`:t:e:"",u=(e,t)=>{if(!e||!t)return;const r=((e,t)=>({action:e,requestId:t.id,propertyTitle:t.propertyTitle||t.projectTitle||t.projectName||t.title||"Property",buyerId:t.buyerId||t.userId,vendorId:t.vendorId,vendorEmail:t.vendorEmail,status:t.status,timestamp:(new Date).toISOString()}))(e,t),i=c();i.unshift(r),i.length>200&&i.pop(),(e=>{localStorage.setItem(n,JSON.stringify(e))})(i),a("inspectionActivity",r),a("inspectionAnalyticsUpdated",r);const o=((e,t,r)=>{const s=[],i=r.propertyTitle,n=t.buyerName||t.userName||"Buyer",o=t.vendorName||t.vendor||t.owner||"Vendor",a=m(t.preferredDate,t.preferredTime),l=m(t.confirmedDate,t.confirmedTime),d=m(t.proposedDate,t.proposedTime),c=(r,a)=>{(t.vendorId||t.vendorEmail)&&s.push({recipientId:t.vendorId,recipientEmail:t.vendorEmail,roles:["vendor"],type:e,title:r,message:a,priority:"medium",metadata:{requestId:t.id,propertyTitle:i,buyerName:n,vendorName:o}})},u=(r,a)=>{(t.buyerId||t.userId||t.buyerEmail||t.userEmail)&&s.push({recipientId:t.buyerId||t.userId,recipientEmail:t.buyerEmail||t.userEmail,roles:["buyer"],type:e,title:r,message:a,priority:"medium",metadata:{requestId:t.id,propertyTitle:i,buyerName:n,vendorName:o}})};switch(e){case"inspection_requested":c("New inspection request",`${n} requested to view ${i} ${a?`on ${a}`:""}`.trim());break;case"inspection_confirmed":u("Inspection confirmed",`${o} confirmed ${i} ${l?`for ${l}`:""}`.trim());break;case"vendor_proposed_new_time":u("Vendor proposed new time",`${o} suggested ${d||"another slot"} for ${i}`);break;case"buyer_rescheduled":c("Buyer requested new time",`${n} rescheduled ${i} ${a?`to ${a}`:""}`.trim());break;case"inspection_cancelled_by_buyer":c("Inspection cancelled by buyer",`${n} cancelled ${i}`);break;case"inspection_cancelled_by_vendor":u("Inspection cancelled by vendor",`${o} cancelled ${i}`);break;case"inspection_declined":u("Inspection declined",`${o} declined the request for ${i}`)}return s})(e,t,r);o.length&&(a("inspectionNotification",{action:e,payload:r,notifications:o,request:t}),function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!e.length||"undefined"===typeof window)return;const t=e.filter(e=>e.recipientId).map(e=>{var t;return{recipientId:e.recipientId,type:e.type,title:e.title,message:e.message,priority:e.priority||"medium",metadata:{...e.metadata||{},source:(null===(t=e.metadata)||void 0===t?void 0:t.source)||"inspection_client_sync"},data:e.metadata||{}}});t.length&&s.A.createInspectionNotifications(t).then(e=>{null!==e&&void 0!==e&&e.success||console.warn("Failed to persist inspection notifications",e)}).catch(e=>{console.error("Error persisting inspection notifications:",e)})}(o))},p=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=((null===t||void 0===t?void 0:t.status)||r.status||"").toLowerCase();if(!s&&(r.proposedDate||r.proposedTime))return"vendor_proposed_new_time";switch(s){case"accepted":case"confirmed":return"inspection_confirmed";case"proposed_new_time":return"vendor_proposed_new_time";case"buyer_rescheduled":return"buyer_rescheduled";case"cancelled_by_buyer":return"inspection_cancelled_by_buyer";case"cancelled_by_vendor":return"inspection_cancelled_by_vendor";case"declined":return"inspection_declined";default:return e&&e.status!==(null===t||void 0===t?void 0:t.status)?`inspection_status_${(null===t||void 0===t?void 0:t.status)||"updated"}`:null}},v=(e,t,r)=>!(!t&&!r)&&(t&&(null===e||void 0===e?void 0:e.vendorId)===t||r&&(null===e||void 0===e?void 0:e.vendorEmail)===r),h=function(){let{role:e="buyer",userId:t,vendorId:r,vendorEmail:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("undefined"===typeof window)return{...o};if("buyer"===e&&!t)return{...o};if("vendor"===e&&!r&&!s)return{...o};const i=l().filter(i=>{return"buyer"===e?(n=i,!!(o=t)&&((null===n||void 0===n?void 0:n.buyerId)===o||(null===n||void 0===n?void 0:n.userId)===o)):v(i,r||i.vendorId,s);var n,o}),n={totalRequests:i.length,pendingResponses:0,confirmed:0,vendorProposals:0,buyerReschedules:0,cancelledByBuyer:0,cancelledByVendor:0,timeline:[]},a=["pending","pending_vendor","pending_vendor_confirmation"],d=c();i.forEach(e=>{const t=(e.status||"").toLowerCase();a.includes(t)&&(n.pendingResponses+=1),["accepted","confirmed"].includes(t)&&(n.confirmed+=1),"proposed_new_time"===t&&(n.vendorProposals+=1),"buyer_rescheduled"===t&&(n.buyerReschedules+=1),"cancelled_by_buyer"===t&&(n.cancelledByBuyer+=1),["cancelled_by_vendor","declined"].includes(t)&&(n.cancelledByVendor+=1)});const m=Array.from({length:7}).map((i,n)=>{const o=new Date;o.setDate(o.getDate()-(6-n));const a=o.toISOString().slice(0,10),l=d.filter(i=>{return(i=>"buyer"===e?(null===i||void 0===i?void 0:i.buyerId)===t:v(i,r,s))(i)&&((n=i.timestamp)?new Date(n):new Date).toISOString().slice(0,10)===a;var n}).length;return{date:a,count:l}});return n.timeline=m,n},g=async e=>{try{console.log("Using localStorage for creating inspection requests (API unavailable)");const t=l(),r={id:`viewing-${Date.now()}`,...e,createdAt:(new Date).toISOString(),status:"pending"};return t.push(r),d(t),a("viewingsUpdated",{viewingRequest:r,action:"created"}),a("storage",{key:i,newValue:JSON.stringify(t)}),u("inspection_requested",r),r}catch(t){console.error("Error creating inspection request:",t);const r=l(),s={id:`viewing-${Date.now()}`,...e,createdAt:(new Date).toISOString(),status:"pending"};return r.push(s),d(r),a("viewingsUpdated",{viewingRequest:s,action:"created"}),a("storage",{key:i,newValue:JSON.stringify(r)}),u("inspection_requested",s),s}},x=async(e,t)=>{try{console.log("Using localStorage for inspection requests (API unavailable)");const r=l().filter(r=>e&&r.vendorId===e||t&&r.vendorEmail===t);return r.sort((e,t)=>new Date(t.createdAt||0)-new Date(e.createdAt||0)),r}catch(r){console.error("Error listing inspection requests:",r);return l().filter(r=>e&&r.vendorId===e||t&&r.vendorEmail===t).sort((e,t)=>new Date(t.createdAt||0)-new Date(e.createdAt||0))}},y=async(e,t)=>{try{console.log("Using localStorage for updating inspection requests (API unavailable)");const r=l();let s=null;const n=r.map(r=>r.id===e?(s={...r,...t,updatedAt:(new Date).toISOString()},s):r);if(!s)return d(r),!1;d(n),a("viewingsUpdated",{requestId:e,updates:t,action:"updated"}),a("storage",{key:i,newValue:JSON.stringify(n)});const o=p(r.find(t=>t.id===e),s,t);return o&&u(o,s),!0}catch(r){console.error("Error updating inspection request:",r);const s=l();let n=null;const o=s.map(r=>r.id===e?(n={...r,...t,updatedAt:(new Date).toISOString()},n):r);if(!n)return d(s),!1;d(o),a("viewingsUpdated",{requestId:e,updates:t,action:"updated"}),a("storage",{key:i,newValue:JSON.stringify(o)});const c=p(s.find(t=>t.id===e),n,t);return c&&u(c,n),!0}}}}]);
//# sourceMappingURL=843.4003b0f4.chunk.js.map