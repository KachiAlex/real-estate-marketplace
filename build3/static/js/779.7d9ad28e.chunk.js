"use strict";(self.webpackChunkreal_estate_marketplace=self.webpackChunkreal_estate_marketplace||[]).push([[779],{4779:(e,t,s)=>{s.r(t),s.d(t,{default:()=>m});var a=s(5043),r=s(5016),l=s(3216),n=s(5369),i=s(3768),o=s(6213),d=s(1876),c=s(579);const m=()=>{var e,t,s,m,x,u,g,p,h;const{user:b}=(0,r.As)(),y=(0,l.Zp)(),[j,v]=(0,a.useState)(!0),[f,N]=(0,a.useState)(null),[w,A]=(0,a.useState)({totalApplications:0,pendingApplications:0,approvedApplications:0,rejectedApplications:0}),[C,k]=(0,a.useState)([]),[P,R]=(0,a.useState)(!1),[S,D]=(0,a.useState)(null),[L,_]=(0,a.useState)(!1),[T,F]=(0,a.useState)(null),[I,M]=(0,a.useState)(""),[$,q]=(0,a.useState)(""),[Y,z]=(0,a.useState)([""]),[E,B]=(0,a.useState)({approvedAmount:"",interestRate:"",loanTermYears:"",monthlyPayment:""}),[O,H]=(0,a.useState)(!1),[W,X]=(0,a.useState)({name:"",description:"",minLoanAmount:"",maxLoanAmount:"",minDownPaymentPercent:"",maxLoanTerm:"",interestRate:"",interestRateType:"fixed",eligibilityCriteria:{minMonthlyIncome:"",minCreditScore:"",employmentDuration:""}});(0,a.useEffect)(()=>{b&&"mortgage_bank"===b.role?Q():(i.Ay.error("Access denied. Mortgage bank account required."),y("/"))},[b,y]);const Q=async()=>{try{v(!0);const e=localStorage.getItem("token"),t=await o.A.get((0,d.e9)("/mortgage-banks"),{headers:{Authorization:`Bearer ${e}`}});if(t.data.success&&t.data.data.length>0){const e=t.data.data.find(e=>{var t,s;return(null===(t=e.userAccount)||void 0===t?void 0:t._id)===b.id||(null===(s=e.userAccount)||void 0===s?void 0:s.id)===b.id});e?(N(e),await V(e)):i.Ay.error("Bank profile not found")}}catch(e){console.error("Error loading bank data:",e),i.Ay.error("Failed to load bank data")}finally{v(!1)}},V=async e=>{try{const e=localStorage.getItem("token"),t=await o.A.get((0,d.e9)("/mortgages"),{headers:{Authorization:`Bearer ${e}`}});if(t.data.success){const e=t.data.data||[];k(e),A({totalApplications:e.length,pendingApplications:e.filter(e=>"pending"===e.status||"under_review"===e.status||"needs_more_info"===e.status).length,approvedApplications:e.filter(e=>"approved"===e.status).length,rejectedApplications:e.filter(e=>"rejected"===e.status).length})}}catch(t){console.error("Error loading mortgage applications:",t)}},G=()=>{M(""),q(""),z([""]),B({approvedAmount:"",interestRate:"",loanTermYears:"",monthlyPayment:""})};if(j)return(0,c.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,c.jsxs)("div",{className:"text-center",children:[(0,c.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,c.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading dashboard..."})]})});if(!f)return(0,c.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,c.jsxs)("div",{className:"text-center",children:[(0,c.jsx)(n.ymh,{className:"text-6xl text-gray-300 mx-auto mb-4"}),(0,c.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Bank Profile Not Found"}),(0,c.jsx)("p",{className:"text-gray-600 mb-4",children:"Your bank profile could not be loaded."}),(0,c.jsx)("button",{onClick:()=>y("/mortgage-bank/register"),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700",children:"Register Bank"})]})});const U=e=>({pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"}[e]||"bg-gray-100 text-gray-800");return(0,c.jsxs)("div",{className:"min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8",children:[(0,c.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,c.jsx)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:f.name}),(0,c.jsx)("p",{className:"text-gray-600 mt-1",children:f.fullAddress||`${null===(e=f.address)||void 0===e?void 0:e.city}, ${null===(t=f.address)||void 0===t?void 0:t.state}`}),(0,c.jsx)("div",{className:"mt-2",children:(0,c.jsx)("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${U(f.verificationStatus)}`,children:"approved"===f.verificationStatus?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.A7C,{className:"mr-1"})," Approved"]}):"pending"===f.verificationStatus?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.w_X,{className:"mr-1"})," Pending Verification"]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n._Hm,{className:"mr-1"})," Rejected"]})})})]}),(0,c.jsxs)("button",{onClick:()=>R(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,c.jsx)(n.OiG,{className:"mr-2"}),"Add Product"]})]})}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[(0,c.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:"Total Applications"}),(0,c.jsx)("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:w.totalApplications})]}),(0,c.jsx)(n.t69,{className:"text-blue-600 text-2xl"})]})}),(0,c.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:"Pending"}),(0,c.jsx)("p",{className:"text-2xl font-bold text-yellow-600 mt-1",children:w.pendingApplications})]}),(0,c.jsx)(n.w_X,{className:"text-yellow-600 text-2xl"})]})}),(0,c.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:"Approved"}),(0,c.jsx)("p",{className:"text-2xl font-bold text-green-600 mt-1",children:w.approvedApplications})]}),(0,c.jsx)(n.A7C,{className:"text-green-600 text-2xl"})]})}),(0,c.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:"Rejected"}),(0,c.jsx)("p",{className:"text-2xl font-bold text-red-600 mt-1",children:w.rejectedApplications})]}),(0,c.jsx)(n._Hm,{className:"text-red-600 text-2xl"})]})})]}),(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,c.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Mortgage Products"}),f.mortgageProducts&&f.mortgageProducts.length>0?(0,c.jsx)("div",{className:"space-y-4",children:f.mortgageProducts.filter(e=>e.isActive).map((e,t)=>{var s,a;return(0,c.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,c.jsx)("div",{className:"flex items-center justify-between",children:(0,c.jsxs)("div",{children:[(0,c.jsx)("h3",{className:"font-semibold text-gray-900",children:e.name}),e.description&&(0,c.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),(0,c.jsxs)("div",{className:"mt-2 grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{className:"text-gray-600",children:"Loan Range:"}),(0,c.jsxs)("p",{className:"font-medium",children:["\u20a6",null===(s=e.minLoanAmount)||void 0===s?void 0:s.toLocaleString()," - \u20a6",null===(a=e.maxLoanAmount)||void 0===a?void 0:a.toLocaleString()]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{className:"text-gray-600",children:"Down Payment:"}),(0,c.jsxs)("p",{className:"font-medium",children:[e.minDownPaymentPercent,"%"]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{className:"text-gray-600",children:"Term:"}),(0,c.jsxs)("p",{className:"font-medium",children:[e.maxLoanTerm," years"]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{className:"text-gray-600",children:"Interest Rate:"}),(0,c.jsxs)("p",{className:"font-medium",children:[e.interestRate,"% (",e.interestRateType,")"]})]})]})]})})},t)})}):(0,c.jsxs)("div",{className:"text-center py-8",children:[(0,c.jsx)(n.t69,{className:"text-4xl text-gray-300 mx-auto mb-4"}),(0,c.jsx)("p",{className:"text-gray-600",children:"No mortgage products yet. Add your first product to get started."})]})]}),(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,c.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Recent Applications"}),0===C.length?(0,c.jsx)("div",{className:"text-center py-8 text-gray-600",children:(0,c.jsx)("p",{children:"No mortgage applications yet."})}):(0,c.jsx)("div",{className:"space-y-4",children:C.slice(0,5).map(e=>{var t,s,a,r;return(0,c.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 flex items-center justify-between hover:shadow-md transition-shadow cursor-pointer",onClick:()=>{D(e),_(!0)},children:[(0,c.jsxs)("div",{className:"flex-1",children:[(0,c.jsxs)("p",{className:"font-semibold text-gray-900",children:[(null===(t=e.property)||void 0===t?void 0:t.title)||"Property"," - \u20a6",e.requestedAmount.toLocaleString()]}),(0,c.jsxs)("p",{className:"text-sm text-gray-600",children:["Applicant: ",null===(s=e.buyer)||void 0===s?void 0:s.firstName," ",null===(a=e.buyer)||void 0===a?void 0:a.lastName," (",null===(r=e.buyer)||void 0===r?void 0:r.email,")"]}),(0,c.jsxs)("p",{className:"text-xs text-gray-500",children:["Status: ",(0,c.jsx)("span",{className:"font-medium capitalize",children:e.status.replace("_"," ")}),e.documents&&e.documents.length>0&&(0,c.jsxs)("span",{className:"ml-2 text-blue-600",children:["\u2022 ",e.documents.length," document",e.documents.length>1?"s":""]})]})]}),(0,c.jsx)("button",{onClick:t=>{t.stopPropagation(),D(e),_(!0)},className:"ml-4 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm",children:"View Details"})]},e._id)})})]})]}),P&&(0,c.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,c.jsxs)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto p-6",children:[(0,c.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Add Mortgage Product"}),(0,c.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),f)try{const e=localStorage.getItem("token");(await o.A.post((0,d.e9)(`/mortgage-banks/${f._id}/products`),{name:W.name,description:W.description,minLoanAmount:parseFloat(W.minLoanAmount),maxLoanAmount:parseFloat(W.maxLoanAmount),minDownPaymentPercent:parseFloat(W.minDownPaymentPercent),maxLoanTerm:parseFloat(W.maxLoanTerm),interestRate:parseFloat(W.interestRate),interestRateType:W.interestRateType,eligibilityCriteria:{minMonthlyIncome:parseFloat(W.eligibilityCriteria.minMonthlyIncome)||0,minCreditScore:parseFloat(W.eligibilityCriteria.minCreditScore)||0,employmentDuration:parseFloat(W.eligibilityCriteria.employmentDuration)||0}},{headers:{Authorization:`Bearer ${e}`}})).data.success&&(i.Ay.success("Mortgage product added successfully!"),R(!1),X({name:"",description:"",minLoanAmount:"",maxLoanAmount:"",minDownPaymentPercent:"",maxLoanTerm:"",interestRate:"",interestRateType:"fixed",eligibilityCriteria:{minMonthlyIncome:"",minCreditScore:"",employmentDuration:""}}),Q())}catch(a){var t,s;console.error("Error adding product:",a),i.Ay.error((null===(t=a.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||"Failed to add product")}},children:[(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Name *"}),(0,c.jsx)("input",{type:"text",required:!0,value:W.name,onChange:e=>X({...W,name:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Standard 20-Year Fixed"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,c.jsx)("textarea",{value:W.description,onChange:e=>X({...W,description:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:"3"})]}),(0,c.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Min Loan Amount (\u20a6) *"}),(0,c.jsx)("input",{type:"number",required:!0,value:W.minLoanAmount,onChange:e=>X({...W,minLoanAmount:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Loan Amount (\u20a6) *"}),(0,c.jsx)("input",{type:"number",required:!0,value:W.maxLoanAmount,onChange:e=>X({...W,maxLoanAmount:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),(0,c.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Down Payment % *"}),(0,c.jsx)("input",{type:"number",required:!0,min:"0",max:"100",value:W.minDownPaymentPercent,onChange:e=>X({...W,minDownPaymentPercent:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Loan Term (years) *"}),(0,c.jsx)("input",{type:"number",required:!0,min:"1",max:"30",value:W.maxLoanTerm,onChange:e=>X({...W,maxLoanTerm:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),(0,c.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Interest Rate (%) *"}),(0,c.jsx)("input",{type:"number",required:!0,step:"0.1",value:W.interestRate,onChange:e=>X({...W,interestRate:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rate Type *"}),(0,c.jsxs)("select",{value:W.interestRateType,onChange:e=>X({...W,interestRateType:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[(0,c.jsx)("option",{value:"fixed",children:"Fixed"}),(0,c.jsx)("option",{value:"variable",children:"Variable"}),(0,c.jsx)("option",{value:"adjustable",children:"Adjustable"})]})]})]}),(0,c.jsxs)("div",{className:"border-t pt-4",children:[(0,c.jsx)("h3",{className:"font-medium text-gray-900 mb-3",children:"Eligibility Criteria (Optional)"}),(0,c.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Min Monthly Income (\u20a6)"}),(0,c.jsx)("input",{type:"number",value:W.eligibilityCriteria.minMonthlyIncome,onChange:e=>X({...W,eligibilityCriteria:{...W.eligibilityCriteria,minMonthlyIncome:e.target.value}}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Min Credit Score"}),(0,c.jsx)("input",{type:"number",min:"0",max:"1000",value:W.eligibilityCriteria.minCreditScore,onChange:e=>X({...W,eligibilityCriteria:{...W.eligibilityCriteria,minCreditScore:e.target.value}}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employment Duration (months)"}),(0,c.jsx)("input",{type:"number",value:W.eligibilityCriteria.employmentDuration,onChange:e=>X({...W,eligibilityCriteria:{...W.eligibilityCriteria,employmentDuration:e.target.value}}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]})]})]}),(0,c.jsxs)("div",{className:"flex justify-end mt-6 space-x-3",children:[(0,c.jsx)("button",{type:"button",onClick:()=>R(!1),className:"px-6 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",children:"Cancel"}),(0,c.jsx)("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Add Product"})]})]})]})}),L&&S&&(0,c.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,c.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,c.jsxs)("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[(0,c.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Application Details"}),(0,c.jsx)("button",{onClick:()=>{_(!1),D(null),F(null),G()},className:"text-gray-500 hover:text-gray-700",children:(0,c.jsx)(n.QCr,{className:"text-xl"})})]}),(0,c.jsxs)("div",{className:"p-6 space-y-6",children:[(0,c.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,c.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Application Overview"}),(0,c.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-sm text-gray-600",children:"Application ID"}),(0,c.jsx)("p",{className:"font-medium",children:S._id})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-sm text-gray-600",children:"Status"}),(0,c.jsx)("span",{className:`inline-block px-2 py-1 rounded text-sm font-medium ${U(S.status)}`,children:S.status.replace("_"," ").toUpperCase()})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-sm text-gray-600",children:"Property"}),(0,c.jsx)("p",{className:"font-medium",children:(null===(s=S.property)||void 0===s?void 0:s.title)||"N/A"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-sm text-gray-600",children:"Loan Amount"}),(0,c.jsxs)("p",{className:"font-medium",children:["\u20a6",(null===(m=S.requestedAmount)||void 0===m?void 0:m.toLocaleString())||"0"]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-sm text-gray-600",children:"Down Payment"}),(0,c.jsxs)("p",{className:"font-medium",children:["\u20a6",(null===(x=S.downPayment)||void 0===x?void 0:x.toLocaleString())||"0"]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-sm text-gray-600",children:"Interest Rate"}),(0,c.jsxs)("p",{className:"font-medium",children:[S.interestRate||"0","%"]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-sm text-gray-600",children:"Loan Term"}),(0,c.jsxs)("p",{className:"font-medium",children:[S.loanTermYears||"0"," years"]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-sm text-gray-600",children:"Monthly Payment"}),(0,c.jsxs)("p",{className:"font-medium",children:["\u20a6",(null===(u=S.estimatedMonthlyPayment)||void 0===u?void 0:u.toLocaleString())||"0"]})]})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Applicant Information"}),(0,c.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,c.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-sm text-gray-600",children:"Name"}),(0,c.jsxs)("p",{className:"font-medium",children:[(null===(g=S.buyer)||void 0===g?void 0:g.firstName)||""," ",(null===(p=S.buyer)||void 0===p?void 0:p.lastName)||""]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-sm text-gray-600",children:"Email"}),(0,c.jsx)("p",{className:"font-medium",children:(null===(h=S.buyer)||void 0===h?void 0:h.email)||"N/A"})]}),S.employmentDetails&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-sm text-gray-600",children:"Employment Type"}),(0,c.jsx)("p",{className:"font-medium capitalize",children:S.employmentDetails.type||"N/A"})]}),S.employmentDetails.monthlyIncome&&(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-sm text-gray-600",children:"Monthly Income"}),(0,c.jsxs)("p",{className:"font-medium",children:["\u20a6",S.employmentDetails.monthlyIncome.toLocaleString()]})]}),S.employmentDetails.employerName&&(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-sm text-gray-600",children:"Employer"}),(0,c.jsx)("p",{className:"font-medium",children:S.employmentDetails.employerName})]})]})]})})]}),S.documents&&S.documents.length>0&&(0,c.jsxs)("div",{children:[(0,c.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:["Documents (",S.documents.length,")"]}),(0,c.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:S.documents.map((e,t)=>{var s,a;const r=e.url&&(e.url.match(/\.(jpg|jpeg|png|gif|webp)$/i)||(null===(s=e.type)||void 0===s?void 0:s.toLowerCase().includes("image"))),l=e.url&&(e.url.match(/\.pdf$/i)||(null===(a=e.type)||void 0===a?void 0:a.toLowerCase().includes("pdf")));return(0,c.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[(0,c.jsx)("div",{className:"flex items-start justify-between mb-2",children:(0,c.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,c.jsx)("p",{className:"font-medium text-gray-900 truncate",children:e.name||`Document ${t+1}`}),(0,c.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[e.type&&(0,c.jsx)("span",{className:"capitalize",children:e.type.replace("_"," ")}),e.uploadedAt&&(0,c.jsxs)("span",{className:"ml-2",children:["\u2022 ",new Date(e.uploadedAt).toLocaleDateString()]})]})]})}),r&&e.url&&(0,c.jsx)("div",{className:"mb-3",children:(0,c.jsx)("img",{src:e.url,alt:e.name||"Document",className:"w-full h-32 object-cover rounded border border-gray-200 cursor-pointer hover:opacity-90",onClick:()=>F(e)})}),l&&e.url&&(0,c.jsxs)("div",{className:"mb-3 bg-gray-100 rounded p-4 text-center",children:[(0,c.jsx)(n.t69,{className:"text-4xl text-red-500 mx-auto mb-2"}),(0,c.jsx)("p",{className:"text-sm text-gray-600",children:"PDF Document"})]}),(0,c.jsxs)("div",{className:"flex gap-2",children:[(r||l)&&(0,c.jsxs)("button",{onClick:()=>F(e),className:"flex-1 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm flex items-center justify-center gap-2",children:[(0,c.jsx)(n.Ny1,{}),"Preview"]}),(0,c.jsxs)("a",{href:e.url,download:e.name||"document",target:"_blank",rel:"noopener noreferrer",className:"flex-1 px-3 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors text-sm flex items-center justify-center gap-2",children:[(0,c.jsx)(n.WCW,{}),"Download"]})]})]},t)})})]}),(!S.documents||0===S.documents.length)&&(0,c.jsxs)("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[(0,c.jsx)(n.t69,{className:"text-4xl text-gray-300 mx-auto mb-2"}),(0,c.jsx)("p",{className:"text-gray-600",children:"No documents uploaded for this application"})]}),("pending"===S.status||"under_review"===S.status||"needs_more_info"===S.status)&&(0,c.jsxs)("div",{className:"border-t border-gray-200 pt-6",children:[(0,c.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Review Application"}),(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Decision ",(0,c.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,c.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,c.jsxs)("button",{type:"button",onClick:()=>{var e,t,s;(M("approved"),S.requestedAmount&&!E.approvedAmount)&&B({approvedAmount:S.requestedAmount.toString(),interestRate:(null===(e=S.interestRate)||void 0===e?void 0:e.toString())||"",loanTermYears:(null===(t=S.loanTermYears)||void 0===t?void 0:t.toString())||"",monthlyPayment:(null===(s=S.estimatedMonthlyPayment)||void 0===s?void 0:s.toString())||""})},className:"px-4 py-3 rounded-lg border-2 transition-colors "+("approved"===I?"border-green-600 bg-green-50 text-green-700":"border-gray-300 hover:border-green-400 text-gray-700"),children:[(0,c.jsx)(n.A7C,{className:"mx-auto mb-1"}),"Approve"]}),(0,c.jsxs)("button",{type:"button",onClick:()=>M("rejected"),className:"px-4 py-3 rounded-lg border-2 transition-colors "+("rejected"===I?"border-red-600 bg-red-50 text-red-700":"border-gray-300 hover:border-red-400 text-gray-700"),children:[(0,c.jsx)(n._Hm,{className:"mx-auto mb-1"}),"Reject"]}),(0,c.jsxs)("button",{type:"button",onClick:()=>M("needs_more_info"),className:"px-4 py-3 rounded-lg border-2 transition-colors "+("needs_more_info"===I?"border-yellow-600 bg-yellow-50 text-yellow-700":"border-gray-300 hover:border-yellow-400 text-gray-700"),children:[(0,c.jsx)(n.w_X,{className:"mx-auto mb-1"}),"Request Info"]})]})]}),(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Review Notes"}),(0,c.jsx)("textarea",{value:$,onChange:e=>q(e.target.value),rows:4,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your review notes, feedback, or additional comments..."})]}),("approved"===I||"needs_more_info"===I)&&(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Conditions ","approved"===I?"(Optional)":"(Required)"]}),(0,c.jsxs)("div",{className:"space-y-2",children:[Y.map((e,t)=>(0,c.jsxs)("div",{className:"flex gap-2",children:[(0,c.jsx)("input",{type:"text",value:e,onChange:e=>((e,t)=>{const s=[...Y];s[e]=t,z(s)})(t,e.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:`Condition ${t+1} (e.g., Provide property insurance, Complete credit check...)`}),Y.length>1&&(0,c.jsx)("button",{type:"button",onClick:()=>(e=>{z(Y.filter((t,s)=>s!==e))})(t),className:"px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg",children:(0,c.jsx)(n.QCr,{})})]},t)),(0,c.jsx)("button",{type:"button",onClick:()=>{z([...Y,""])},className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"+ Add Another Condition"})]})]}),"approved"===I&&(0,c.jsxs)("div",{className:"mb-4 bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,c.jsx)("h4",{className:"text-sm font-semibold text-green-900 mb-3",children:"Approved Loan Terms"}),(0,c.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Approved Amount ",(0,c.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,c.jsx)("input",{type:"number",value:E.approvedAmount,onChange:e=>B({...E,approvedAmount:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Amount in NGN",required:!0})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Interest Rate (%) ",(0,c.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,c.jsx)("input",{type:"number",step:"0.01",value:E.interestRate,onChange:e=>B({...E,interestRate:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"e.g., 18.5",required:!0})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Loan Term (Years) ",(0,c.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,c.jsx)("input",{type:"number",value:E.loanTermYears,onChange:e=>B({...E,loanTermYears:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"e.g., 25",required:!0})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monthly Payment (Optional)"}),(0,c.jsx)("input",{type:"number",value:E.monthlyPayment,onChange:e=>B({...E,monthlyPayment:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Auto-calculated if empty"})]})]})]}),S.bankReview&&(0,c.jsxs)("div",{className:"mb-4 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,c.jsx)("h4",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Previous Review"}),(0,c.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{className:"font-medium",children:"Decision:"})," ",(0,c.jsx)("span",{className:"capitalize",children:S.bankReview.decision||"N/A"})]}),S.bankReview.notes&&(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{className:"font-medium",children:"Notes:"})," ",(0,c.jsx)("span",{children:S.bankReview.notes})]}),S.bankReview.conditions&&S.bankReview.conditions.length>0&&(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{className:"font-medium",children:"Conditions:"}),(0,c.jsx)("ul",{className:"list-disc list-inside mt-1 ml-2",children:S.bankReview.conditions.map((e,t)=>(0,c.jsx)("li",{children:e},t))})]}),S.bankReview.reviewedAt&&(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{className:"font-medium",children:"Reviewed At:"})," ",(0,c.jsx)("span",{children:new Date(S.bankReview.reviewedAt).toLocaleString()})]})]})]}),(0,c.jsxs)("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[(0,c.jsx)("button",{type:"button",onClick:()=>{G()},className:"px-6 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",disabled:O,children:"Reset"}),(0,c.jsx)("button",{type:"button",onClick:async()=>{if(S&&I)if("approved"!==I||E.approvedAmount&&E.interestRate&&E.loanTermYears){H(!0);try{const e=localStorage.getItem("token");(await o.A.put((0,d.e9)(`/mortgages/${S._id}/review`),{decision:I,notes:$.trim()||void 0,conditions:Y.filter(e=>e.trim()).length>0?Y.filter(e=>e.trim()):void 0,loanTerms:"approved"===I?{approvedAmount:parseFloat(E.approvedAmount),interestRate:parseFloat(E.interestRate),loanTermYears:parseFloat(E.loanTermYears),monthlyPayment:E.monthlyPayment?parseFloat(E.monthlyPayment):void 0}:void 0},{headers:{Authorization:`Bearer ${e}`}})).data.success&&(i.Ay.success(`Application ${I} successfully!`),G(),await V(f),setTimeout(()=>{_(!1),D(null)},1500))}catch(s){var e,t;console.error("Error reviewing application:",s),i.Ay.error((null===(e=s.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to submit review")}finally{H(!1)}}else i.Ay.error("Please fill in all loan terms for approval");else i.Ay.error("Please select a decision")},disabled:O||!I,className:"px-6 py-2 rounded-lg transition-colors flex items-center gap-2 "+("approved"===I?"bg-green-600 hover:bg-green-700 text-white":"rejected"===I?"bg-red-600 hover:bg-red-700 text-white":"needs_more_info"===I?"bg-yellow-600 hover:bg-yellow-700 text-white":"bg-gray-400 text-gray-200 cursor-not-allowed"),children:O?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,c.jsx)("span",{children:"Submitting..."})]}):(0,c.jsxs)(c.Fragment,{children:["approved"===I&&(0,c.jsx)(n.A7C,{}),"rejected"===I&&(0,c.jsx)(n._Hm,{}),"needs_more_info"===I&&(0,c.jsx)(n.w_X,{}),(0,c.jsx)("span",{children:"Submit Review"})]})})]})]})]})]})}),T&&(0,c.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center p-4 z-[60]",children:(0,c.jsxs)("div",{className:"relative max-w-6xl w-full max-h-full",children:[(0,c.jsx)("button",{onClick:()=>F(null),className:"absolute top-4 right-4 p-2 bg-white bg-opacity-90 rounded-full hover:bg-opacity-100 transition-all z-10",children:(0,c.jsx)(n.QCr,{className:"text-gray-700 text-xl"})}),T.url&&(0,c.jsx)(c.Fragment,{children:T.url.match(/\.(jpg|jpeg|png|gif|webp)$/i)?(0,c.jsx)("img",{src:T.url,alt:T.name||"Preview",className:"max-w-full max-h-[90vh] object-contain mx-auto rounded-lg"}):T.url.match(/\.pdf$/i)?(0,c.jsx)("iframe",{src:T.url,className:"w-full h-[90vh] border-0 rounded-lg bg-white",title:T.name||"PDF Preview"}):(0,c.jsxs)("div",{className:"bg-white rounded-lg p-8 max-w-md mx-auto",children:[(0,c.jsx)(n.t69,{className:"text-gray-400 text-6xl mx-auto mb-4"}),(0,c.jsx)("h3",{className:"text-lg font-medium text-gray-900 text-center mb-2",children:T.name||"Document"}),(0,c.jsx)("p",{className:"text-sm text-gray-500 text-center mb-4",children:"Preview not available for this file type"}),(0,c.jsxs)("a",{href:T.url,download:T.name,target:"_blank",rel:"noopener noreferrer",className:"block w-full text-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[(0,c.jsx)(n.WCW,{className:"inline mr-2"}),"Download File"]})]})}),T.name&&(0,c.jsx)("div",{className:"absolute bottom-4 left-4 right-4 bg-black bg-opacity-50 text-white p-3 rounded-lg text-center",children:(0,c.jsx)("p",{className:"text-sm font-medium",children:T.name})})]})})]})}}}]);
//# sourceMappingURL=779.7d9ad28e.chunk.js.map