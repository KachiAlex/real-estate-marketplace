"use strict";(self.webpackChunkreal_estate_marketplace=self.webpackChunkreal_estate_marketplace||[]).push([[515],{2407(e,t,s){s.d(t,{A:()=>l});s(5043);var r=s(5475),a=s(3216),i=s(5369),n=s(579);const l=e=>{let{items:t}=e;const s=(0,a.zy)().pathname.split("/").filter(e=>e),l=t||[{label:"Home",path:"/"},...s.map((e,t)=>{const r="/".concat(s.slice(0,t+1).join("/"));return{label:e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),path:r}})];return(0,n.jsx)("nav",{className:"flex items-center space-x-2 text-sm text-gray-600 mb-4","aria-label":"Breadcrumb",children:(0,n.jsx)("ol",{className:"flex items-center space-x-2",children:l.map((e,t)=>{const s=t===l.length-1;return(0,n.jsxs)("li",{className:"flex items-center",children:[0===t&&(0,n.jsx)(i.rQ8,{className:"h-4 w-4 text-gray-400 mr-2","aria-hidden":"true"}),s?(0,n.jsx)("span",{className:"text-gray-900 font-medium","aria-current":"page",children:e.label}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.N_,{to:e.path,className:"hover:text-blue-600 transition-colors","aria-label":"Navigate to ".concat(e.label),children:e.label}),(0,n.jsx)(i.X6T,{className:"h-3 w-3 text-gray-400 mx-2","aria-hidden":"true"})]})]},e.path||t)})})})}},8329(e,t,s){s.d(t,{A:()=>a});s(5043);var r=s(579);const a=e=>{let{count:t=1}=e;const s=Array.from({length:t},(e,t)=>(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-md overflow-hidden animate-pulse",children:[(0,r.jsx)("div",{className:"w-full h-48 bg-gray-300"}),(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("div",{className:"h-8 w-32 bg-gray-300 rounded mb-3"}),(0,r.jsx)("div",{className:"h-6 w-full bg-gray-300 rounded mb-2"}),(0,r.jsx)("div",{className:"h-6 w-3/4 bg-gray-300 rounded mb-4"}),(0,r.jsx)("div",{className:"h-4 w-2/3 bg-gray-300 rounded mb-4"}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 mb-4",children:[(0,r.jsx)("div",{className:"h-4 w-16 bg-gray-300 rounded"}),(0,r.jsx)("div",{className:"h-4 w-16 bg-gray-300 rounded"}),(0,r.jsx)("div",{className:"h-4 w-16 bg-gray-300 rounded"})]}),(0,r.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,r.jsx)("div",{className:"h-4 w-full bg-gray-300 rounded"}),(0,r.jsx)("div",{className:"h-4 w-5/6 bg-gray-300 rounded"})]}),(0,r.jsx)("div",{className:"h-10 w-full bg-gray-300 rounded"})]})]},t));return(0,r.jsx)(r.Fragment,{children:s})}},5515(e,t,s){s.r(t),s.d(t,{default:()=>S});var r=s(9379),a=s(5043),i=s(3216),n=s(5016),l=s(4345),o=s(6471),d=s(5369),c=s(1876),m=s(6809),u=s(579);const x=e=>{let{isOpen:t,onClose:s,amount:i=5e4,propertyTitle:n,onPaymentSuccess:l,onPaymentError:o}=e;const[c,m]=(0,a.useState)("details"),[x,p]=(0,a.useState)(!1),[g,h]=(0,a.useState)(!1),[y,b]=(0,a.useState)("card"),[v,f]=(0,a.useState)({email:"",cardNumber:"",expiry:"",cvv:"",cardName:"",accountName:"",bankName:"",transferReference:""});(0,a.useEffect)(()=>{t&&(m("details"),p(!1),h(!1),f({email:"",cardNumber:"",expiry:"",cvv:"",cardName:"",accountName:"",bankName:"",transferReference:""}),b("card"))},[t]);const j=e=>(e.replace(/\s/g,"").match(/.{1,4}/g)||[]).join(" "),N=e=>{const t=e.replace(/\D/g,"");return t.length>=2?t.slice(0,2)+"/"+t.slice(2,4):t},w=e=>{const{name:t,value:s}=e.target;f("cardNumber"===t?e=>(0,r.A)((0,r.A)({},e),{},{[t]:j(s)}):"expiry"===t?e=>(0,r.A)((0,r.A)({},e),{},{[t]:N(s)}):e=>(0,r.A)((0,r.A)({},e),{},{[t]:s}))},A=()=>{(g||window.confirm("Are you sure you want to cancel this payment?"))&&s()};return t?(0,u.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,u.jsxs)("div",{className:"flex min-h-screen items-center justify-center p-4",children:[(0,u.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:A}),(0,u.jsxs)("div",{className:"relative bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[(0,u.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white p-6 rounded-t-lg",children:(0,u.jsxs)("div",{className:"flex justify-between items-start",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("h3",{className:"text-xl font-bold",children:"Property Verification Payment"}),(0,u.jsx)("p",{className:"text-blue-100 text-sm mt-1",children:n||"Property Verification"})]}),(0,u.jsx)("button",{onClick:A,className:"text-white hover:text-blue-200 transition-colors",children:(0,u.jsx)(d.QCr,{size:20})})]})}),(0,u.jsxs)("div",{className:"p-6",children:["details"===c&&(0,u.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),v.email){if("card"===y){if(!v.cardNumber||!v.expiry||!v.cvv)return void alert("Please fill in all card details")}else if("transfer"===y&&(!v.accountName||!v.bankName||!v.transferReference))return void alert("Please fill in all transfer details");p(!0),m("processing"),setTimeout(()=>{p(!1),m("success"),h(!0);const e="card"===y?"CARD_"+Date.now():"TRANSFER_"+Date.now();l&&l({reference:e,amount:i,method:y,status:"successful",timestamp:(new Date).toISOString()})},"card"===y?2e3:1500)}else alert("Please fill in your email address")},className:"space-y-4",children:[(0,u.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg text-center",children:[(0,u.jsx)("p",{className:"text-sm text-gray-600",children:"Payment Amount"}),(0,u.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["\u20a6",i.toLocaleString()]}),(0,u.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Property Verification Fee"})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Method"}),(0,u.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,u.jsxs)("button",{type:"button",onClick:()=>b("card"),className:"p-3 border rounded-lg text-sm font-medium transition-colors ".concat("card"===y?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-300 bg-white text-gray-700 hover:border-gray-400"),children:[(0,u.jsx)(d.x1c,{className:"inline mr-2"}),"Card Payment"]}),(0,u.jsxs)("button",{type:"button",onClick:()=>b("transfer"),className:"p-3 border rounded-lg text-sm font-medium transition-colors ".concat("transfer"===y?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-300 bg-white text-gray-700 hover:border-gray-400"),children:[(0,u.jsx)("span",{className:"inline mr-2",children:"\ud83c\udfe6"}),"Bank Transfer"]})]})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),(0,u.jsx)("input",{type:"email",name:"email",value:v.email,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"your@email.com",required:!0})]}),"card"===y&&(0,u.jsxs)("div",{className:"space-y-3",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Card Number"}),(0,u.jsx)("input",{type:"text",name:"cardNumber",value:v.cardNumber,onChange:w,maxLength:19,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"1234 5678 9012 3456",required:!0})]}),(0,u.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expiry Date"}),(0,u.jsx)("input",{type:"text",name:"expiry",value:v.expiry,onChange:w,maxLength:5,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"MM/YY",required:!0})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CVV"}),(0,u.jsx)("input",{type:"text",name:"cvv",value:v.cvv,onChange:w,maxLength:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"123",required:!0})]})]})]}),"transfer"===y&&(0,u.jsxs)("div",{className:"space-y-3",children:[(0,u.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,u.jsx)("h4",{className:"font-semibold text-blue-900 mb-2",children:"Bank Transfer Details"}),(0,u.jsxs)("div",{className:"text-sm text-blue-800 space-y-1",children:[(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:"Bank:"})," Test Bank PLC"]}),(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:"Account Name:"})," PropertyArk Verification"]}),(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:"Account Number:"})," 1234567890"]}),(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:"Amount:"})," \u20a6",i.toLocaleString()]})]})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Your Account Name"}),(0,u.jsx)("input",{type:"text",name:"accountName",value:v.accountName,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"John Doe",required:!0})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Name"}),(0,u.jsx)("input",{type:"text",name:"bankName",value:v.bankName,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Your Bank Name",required:!0})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Transfer Reference/Transaction ID"}),(0,u.jsx)("input",{type:"text",name:"transferReference",value:v.transferReference,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Transaction ID from your bank",required:!0})]})]}),(0,u.jsxs)("div",{className:"flex items-center text-sm text-gray-600 bg-blue-50 p-3 rounded-lg",children:[(0,u.jsx)(d.JhU,{className:"text-blue-600 mr-2"}),(0,u.jsx)("span",{children:"Your payment information is secure and encrypted"})]}),(0,u.jsxs)("button",{type:"submit",className:"w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center",children:[(0,u.jsx)(d.x1c,{className:"mr-2"}),"Pay \u20a6",i.toLocaleString()]})]}),"processing"===c&&(0,u.jsxs)("div",{className:"text-center py-8",children:[(0,u.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-100 rounded-full mb-4",children:(0,u.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),(0,u.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Processing Payment"}),(0,u.jsx)("p",{className:"text-gray-600",children:"Please wait while we process your payment..."})]}),"success"===c&&(0,u.jsxs)("div",{className:"text-center py-8",children:[(0,u.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mb-4",children:(0,u.jsx)(d.A7C,{className:"text-green-600 text-2xl"})}),(0,u.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Payment Successful!"}),(0,u.jsx)("p",{className:"text-gray-600 mb-4",children:"Your property verification payment has been processed successfully."}),(0,u.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg text-sm",children:[(0,u.jsxs)("p",{className:"text-gray-600",children:["Payment Reference: ",(0,u.jsxs)("span",{className:"font-mono font-semibold",children:["PAY_",Date.now()]})]}),(0,u.jsxs)("p",{className:"text-gray-600",children:["Amount: ",(0,u.jsxs)("span",{className:"font-semibold",children:["\u20a6",i.toLocaleString()]})]})]}),(0,u.jsx)("button",{onClick:A,className:"mt-6 w-full bg-green-600 text-white py-3 rounded-lg font-medium hover:bg-green-700 transition-colors",children:"Continue"})]})]})]})]})}):null},p=e=>{var t;let{property:s,onClose:i,onSuccess:l}=e;const{user:o}=(0,n.As)(),[p,g]=(0,a.useState)(!1),[h,y]=(0,a.useState)(""),[b,v]=(0,a.useState)(""),[f,j]=(0,a.useState)(!1),[N,w]=(0,a.useState)(!1),[A,k]=(0,a.useState)(null),[C,S]=(0,a.useState)(!1),[I,P]=(0,a.useState)(null),[_,D]=(0,a.useState)(!0),[q,V]=(0,a.useState)({propertyName:"",propertyUrl:"",propertyLocation:"",message:"",preferredBadgeColor:"#10B981"});(0,a.useEffect)(()=>{if(!s)return;const e=(()=>{const e=s.location;if(!e)return"";if("string"===typeof e)return e;return[e.address,e.city,e.state].filter(Boolean).join(", ")})(),t=()=>{if(null!==s&&void 0!==s&&s.shareUrl||null!==s&&void 0!==s&&s.listingUrl)return s.shareUrl||s.listingUrl;const e="https://real-estate-marketplace-37544.web.app",t=(null===s||void 0===s?void 0:s.id)||(null===s||void 0===s?void 0:s._id),r=(null===s||void 0===s?void 0:s.title)||(null===s||void 0===s?void 0:s.name)||"property";if(t){const s=r.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"");return"".concat(e,"/property/").concat(t,"/").concat(s)}return"".concat(e,"/properties")};V(a=>(0,r.A)((0,r.A)({},a),{},{propertyName:s.title||s.name||a.propertyName,propertyUrl:t(),propertyLocation:e||a.propertyLocation}))},[s]),(0,a.useEffect)(()=>{(async()=>{try{D(!0);const e=await fetch((0,c.e9)("/verification/config")),t=await e.json();if(!e.ok||!t.success)throw new Error(t.message||"Unable to load verification configuration");P(t.data),V(e=>{var s;return(0,r.A)((0,r.A)({},e),{},{preferredBadgeColor:(null===(s=t.data)||void 0===s?void 0:s.verificationBadgeColor)||e.preferredBadgeColor})})}catch(e){console.warn("PropertyVerification: failed to load config",e),P({verificationFee:5e4,currency:"NGN",supportedDocuments:["title_deed","survey_plan","building_approval","tax_clearance"],processingTime:"3-5 business days"})}finally{D(!1)}})()},[]);const E=(0,a.useMemo)(()=>(null===I||void 0===I?void 0:I.verificationFee)||5e4,[null===I||void 0===I?void 0:I.verificationFee]),R=e=>{const{name:t,value:s}=e.target;V(e=>(0,r.A)((0,r.A)({},e),{},{[t]:s}))},T=q.preferredBadgeColor||"#10B981";return _?(0,u.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,u.jsx)("div",{className:"flex min-h-screen items-center justify-center p-4",children:(0,u.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6 text-center",children:[(0,u.jsx)(d.hW,{className:"animate-spin text-blue-600 text-4xl mx-auto mb-4"}),(0,u.jsx)("h3",{className:"text-lg font-semibold",children:"Loading Verification"}),(0,u.jsx)("p",{className:"text-gray-600",children:"Please wait..."})]})})}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,u.jsxs)("div",{className:"flex min-h-screen items-center justify-center p-4",children:[(0,u.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:i}),(0,u.jsxs)("div",{className:"relative bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,u.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white p-6 rounded-t-lg",children:(0,u.jsxs)("div",{className:"flex justify-between items-start",children:[(0,u.jsxs)("div",{children:[(0,u.jsxs)("h3",{className:"text-xl font-bold flex items-center",children:[(0,u.jsx)(d.SMR,{className:"mr-2"}),"Property Verification"]}),(0,u.jsx)("p",{className:"text-blue-100 text-sm mt-1",children:"Get your property verified with the PropertyArk trust badge"})]}),(0,u.jsx)("button",{onClick:i,className:"text-white hover:text-blue-200 transition-colors",children:(0,u.jsx)(d.QCr,{size:20})})]})}),(0,u.jsx)("div",{className:"p-6",children:b?(0,u.jsxs)("div",{className:"text-center py-8",children:[(0,u.jsx)(d.A7C,{className:"text-green-600 text-5xl mx-auto mb-4"}),(0,u.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Success!"}),(0,u.jsx)("p",{className:"text-gray-600 mb-6",children:b}),N&&!C&&(0,u.jsxs)("div",{className:"space-y-4",children:[(0,u.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,u.jsx)("h4",{className:"font-medium text-blue-900 mb-2",children:"Review Your Details"}),(0,u.jsxs)("div",{className:"text-left space-y-2 text-sm text-blue-800",children:[(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:"Property:"})," ",q.propertyName]}),(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:"Location:"})," ",q.propertyLocation]}),(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:"Payment Reference:"})," ",null===A||void 0===A?void 0:A.reference]}),(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:"Amount:"})," \u20a6",null===A||void 0===A||null===(t=A.amount)||void 0===t?void 0:t.toLocaleString()]})]})]}),(0,u.jsxs)("div",{className:"flex space-x-3 justify-center",children:[(0,u.jsxs)("button",{onClick:async()=>{if(A){S(!0),y("");try{const t=localStorage.getItem("token")||localStorage.getItem("firebaseToken"),a=JSON.parse(localStorage.getItem("currentUser")||"{}");console.log("DEBUG: Verification submission",{hasToken:!!t,tokenLength:null===t||void 0===t?void 0:t.length,userEmail:null===a||void 0===a?void 0:a.email,userId:null===a||void 0===a?void 0:a.uid});const n={propertyId:null===s||void 0===s?void 0:s.id,propertyName:q.propertyName||(null===s||void 0===s?void 0:s.title),propertyUrl:q.propertyUrl||(null===s||void 0===s?void 0:s.propertyUrl),propertyLocation:q.propertyLocation||(null===s||void 0===s?void 0:s.location),message:q.message,preferredBadgeColor:q.preferredBadgeColor,paymentReference:A.reference,paymentAmount:A.amount,paymentStatus:"completed"},o=await(0,m.Ud)((0,c.e9)("/verification/applications"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!o.ok){const e=await o.json().catch(()=>({}));throw new Error(e.message||"Failed to submit verification application")}{const t=await o.json();if(console.log("PropertyVerification: Application submitted successfully",t),null!==s&&void 0!==s&&s.id){var e;const r=JSON.parse(localStorage.getItem("propertyVerificationStatus")||"{}");r[s.id]={status:"requested",requestedAt:(new Date).toISOString(),applicationId:null===(e=t.data)||void 0===e?void 0:e.applicationId},localStorage.setItem("propertyVerificationStatus",JSON.stringify(r))}l&&l((0,r.A)((0,r.A)({},t),{},{propertyId:null===s||void 0===s?void 0:s.id,status:"requested"})),v("\u2705 Verification request submitted successfully! Your property is now under review."),setTimeout(()=>{i()},2e3)}}catch(h){console.error("PropertyVerification: Error submitting application",h),y(h.message||"Failed to submit verification application. Please try again.")}finally{S(!1)}}else y("No payment data found. Please complete payment first.")},className:"px-6 py-3 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center",children:[(0,u.jsx)(d.A7C,{className:"mr-2"}),"Submit Verification Request"]}),(0,u.jsx)("button",{onClick:()=>j(!1),className:"px-6 py-3 bg-gray-600 text-white rounded-lg font-medium hover:bg-gray-700 transition-colors",children:"Cancel"})]})]}),C&&(0,u.jsxs)("div",{className:"flex items-center justify-center",children:[(0,u.jsx)(d.hW,{className:"animate-spin text-blue-600 text-2xl mr-3"}),(0,u.jsx)("span",{className:"text-gray-600",children:"Submitting verification request..."})]})]}):(0,u.jsxs)("form",{onSubmit:e=>{e.preventDefault(),q.propertyName&&q.propertyUrl&&q.propertyLocation?(j(!0),y("")):y("Please fill in all required fields")},className:"space-y-6",children:[h&&(0,u.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center",children:[(0,u.jsx)(d.BS8,{className:"text-red-600 mr-3"}),(0,u.jsx)("span",{className:"text-red-800",children:h})]}),(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Property Name *"}),(0,u.jsx)("input",{type:"text",name:"propertyName",value:q.propertyName,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Property URL *"}),(0,u.jsx)("input",{type:"url",name:"propertyUrl",value:q.propertyUrl,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-gray-50",placeholder:"https://...",readOnly:!0}),(0,u.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"\u2705 Auto-generated from property details"})]})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Property Location *"}),(0,u.jsx)("input",{type:"text",name:"propertyLocation",value:q.propertyLocation,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"City, State",required:!0})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Additional Message"}),(0,u.jsx)("textarea",{name:"message",value:q.message,onChange:R,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Any additional information about the property..."})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Verification Badge Color"}),(0,u.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,u.jsx)("div",{className:"w-8 h-8 rounded-full border-2 border-gray-300",style:{backgroundColor:T}}),(0,u.jsx)("span",{className:"text-sm text-gray-600",children:"Preview of your verification badge"})]})]}),(0,u.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,u.jsxs)("div",{className:"flex justify-between items-center",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("h4",{className:"font-semibold text-gray-900",children:"Verification Fee"}),(0,u.jsx)("p",{className:"text-sm text-gray-600",children:"One-time payment for property verification"})]}),(0,u.jsxs)("div",{className:"text-right",children:[(0,u.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["\u20a6",E.toLocaleString()]}),(0,u.jsxs)("p",{className:"text-xs text-gray-500",children:["Processing time: ",(null===I||void 0===I?void 0:I.processingTime)||"3-5 business days"]})]})]})}),(0,u.jsx)("button",{type:"submit",disabled:p,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:p?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(d.hW,{className:"animate-spin mr-2"}),"Processing..."]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(d.x1c,{className:"mr-2"}),"Pay \u20a6",E.toLocaleString()," for Verification"]})})]})})]})]})}),(0,u.jsx)(x,{isOpen:f,onClose:()=>j(!1),amount:E,propertyTitle:q.propertyName,onPaymentSuccess:async e=>{console.log("PropertyVerification: Payment successful",e),w(!0),v("\u2705 Payment completed successfully! Please review your details and submit the verification request."),k(e)},onPaymentError:e=>{console.error("PropertyVerification: Payment failed",e),y("Payment failed. Please try again.")}})]})};const g=e=>{if(!e)return null;try{return JSON.parse(localStorage.getItem("propertyVerificationStatus")||"{}")[e]||null}catch(t){return console.error("Error getting verification status:",t),null}},h=e=>{const t=g(e);return"requested"===(null===t||void 0===t?void 0:t.status)},y=e=>{const t=g(e);return"approved"===(null===t||void 0===t?void 0:t.status)};var b=s(5032),v=s(2339);const f=()=>{const{user:e}=(0,n.As)(),[t,s]=(0,a.useState)([]),[r,i]=(0,a.useState)(null),[l,o]=(0,a.useState)(!0),[c,m]=(0,a.useState)(!1),[x,p]=(0,a.useState)(null),[g,h]=(0,a.useState)("accept"),[y,f]=(0,a.useState)(""),[j,N]=(0,a.useState)(""),[w,A]=(0,a.useState)("");(0,a.useEffect)(()=>{k()},[e]),(0,a.useEffect)(()=>{if((null===e||void 0===e||!e.id)&&(null===e||void 0===e||!e.email))return void i(null);i((0,b.FH)({role:"vendor",vendorId:null===e||void 0===e?void 0:e.id,vendorEmail:null===e||void 0===e?void 0:e.email}));const t=t=>{const s=t.detail||t;null!==s&&void 0!==s&&s.vendorId&&s.vendorId!==(null===e||void 0===e?void 0:e.id)||i((0,b.FH)({role:"vendor",vendorId:null===e||void 0===e?void 0:e.id,vendorEmail:null===e||void 0===e?void 0:e.email}))};return window.addEventListener("inspectionAnalyticsUpdated",t),()=>window.removeEventListener("inspectionAnalyticsUpdated",t)},[null===e||void 0===e?void 0:e.id,null===e||void 0===e?void 0:e.email]);const k=async()=>{try{o(!0);const t=await(0,b.o2)(null===e||void 0===e?void 0:e.id,null===e||void 0===e?void 0:e.email);s(t),(null!==e&&void 0!==e&&e.id||null!==e&&void 0!==e&&e.email)&&i((0,b.FH)({role:"vendor",vendorId:null===e||void 0===e?void 0:e.id,vendorEmail:null===e||void 0===e?void 0:e.email}))}catch(t){console.error("Error loading inspection requests:",t),v.Ay.error("Failed to load inspection requests")}finally{o(!1)}},C=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"accept";p(e),m(!0),f(e.preferredDate),N(e.preferredTime),A(""),h(t)},S=e=>{const t={pending_vendor:{color:"bg-yellow-100 text-yellow-800",text:"Pending Response"},accepted:{color:"bg-green-100 text-green-800",text:"Accepted"},proposed_new_time:{color:"bg-blue-100 text-blue-800",text:"New Time Proposed"},declined:{color:"bg-red-100 text-red-800",text:"Declined"},buyer_rescheduled:{color:"bg-purple-100 text-purple-800",text:"Buyer Rescheduled"},cancelled_by_buyer:{color:"bg-gray-200 text-gray-700",text:"Cancelled by Buyer"},cancelled_by_vendor:{color:"bg-gray-200 text-gray-700",text:"Cancelled by You"}},s=t[e]||t.pending_vendor;return(0,u.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(s.color),children:s.text})},I=(e,t)=>{if(!e||!t)return"Not specified";try{const s=new Date("".concat(e,"T").concat(t));return s.toLocaleDateString()+" at "+s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch(s){return"".concat(e," at ").concat(t)}};return l?(0,u.jsxs)("div",{className:"flex items-center justify-center p-8",children:[(0,u.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,u.jsx)("span",{className:"ml-2",children:"Loading inspection requests..."})]}):(0,u.jsxs)("div",{className:"space-y-6",children:[(0,u.jsxs)("div",{className:"flex items-center justify-between",children:[(0,u.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Property Viewing Requests"}),(0,u.jsx)("button",{onClick:k,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Refresh"})]}),r&&(0,u.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,u.jsxs)("div",{className:"bg-blue-50 border border-blue-100 rounded-xl p-4",children:[(0,u.jsx)("p",{className:"text-sm text-blue-600",children:"Pending Responses"}),(0,u.jsx)("p",{className:"text-3xl font-semibold text-blue-900",children:r.pendingResponses})]}),(0,u.jsxs)("div",{className:"bg-green-50 border border-green-100 rounded-xl p-4",children:[(0,u.jsx)("p",{className:"text-sm text-green-600",children:"Confirmed"}),(0,u.jsx)("p",{className:"text-3xl font-semibold text-green-900",children:r.confirmed})]}),(0,u.jsxs)("div",{className:"bg-purple-50 border border-purple-100 rounded-xl p-4",children:[(0,u.jsx)("p",{className:"text-sm text-purple-600",children:"Buyer Reschedules"}),(0,u.jsx)("p",{className:"text-3xl font-semibold text-purple-900",children:r.buyerReschedules})]}),(0,u.jsxs)("div",{className:"bg-red-50 border border-red-100 rounded-xl p-4",children:[(0,u.jsx)("p",{className:"text-sm text-red-600",children:"Buyer Cancellations"}),(0,u.jsx)("p",{className:"text-3xl font-semibold text-red-900",children:r.cancelledByBuyer})]})]}),0===t.length?(0,u.jsxs)("div",{className:"text-center py-12",children:[(0,u.jsx)(d.itz,{className:"mx-auto text-4xl text-gray-400 mb-4"}),(0,u.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No viewing requests yet"}),(0,u.jsx)("p",{className:"text-gray-500",children:"When buyers request to view your properties, they will appear here."})]}):(0,u.jsx)("div",{className:"grid gap-6",children:t.map(e=>(0,u.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6 hover:shadow-md transition-shadow",children:[(0,u.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,u.jsxs)("div",{className:"flex-1",children:[(0,u.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:e.propertyTitle||e.projectName}),(0,u.jsxs)("div",{className:"flex items-center text-sm text-gray-600 mb-2",children:[(0,u.jsx)(d.vq8,{className:"mr-2"}),e.propertyLocation||e.projectLocation]}),(0,u.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,u.jsx)(d.x$1,{className:"mr-2"}),e.buyerName||e.userName]})]}),(0,u.jsx)("div",{className:"ml-4",children:S(e.status)})]}),(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,u.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,u.jsx)(d.itz,{className:"mr-2"}),(0,u.jsxs)("span",{children:["Requested: ",I(e.preferredDate,e.preferredTime)]})]}),e.confirmedDate&&e.confirmedTime&&(0,u.jsxs)("div",{className:"flex items-center text-sm text-green-600",children:[(0,u.jsx)(d.A7C,{className:"mr-2"}),(0,u.jsxs)("span",{children:["Confirmed: ",I(e.confirmedDate,e.confirmedTime)]})]}),e.proposedDate&&e.proposedTime&&"proposed_new_time"===e.status&&(0,u.jsxs)("div",{className:"flex items-center text-sm text-blue-600",children:[(0,u.jsx)(d.bfZ,{className:"mr-2"}),(0,u.jsxs)("span",{children:["Proposed: ",I(e.proposedDate,e.proposedTime)]})]})]}),e.message&&(0,u.jsx)("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:(0,u.jsxs)("p",{className:"text-sm text-gray-700",children:[(0,u.jsx)("strong",{children:"Buyer's message:"})," ",e.message]})}),e.vendorMessage&&(0,u.jsx)("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:(0,u.jsxs)("p",{className:"text-sm text-gray-700",children:[(0,u.jsx)("strong",{children:"Your response:"})," ",e.vendorMessage]})}),e.buyerMessage&&(0,u.jsx)("div",{className:"mb-4 p-3 bg-purple-50 rounded-lg",children:(0,u.jsxs)("p",{className:"text-sm text-gray-700",children:[(0,u.jsx)("strong",{children:"Buyer update:"})," ",e.buyerMessage]})}),(0,u.jsxs)("div",{className:"flex items-center justify-between",children:[(0,u.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[(0,u.jsxs)("span",{className:"flex items-center",children:[(0,u.jsx)(d.Cab,{className:"mr-1"}),e.buyerPhone||"Not provided"]}),(0,u.jsxs)("span",{className:"flex items-center",children:[(0,u.jsx)(d.maD,{className:"mr-1"}),e.buyerEmail||e.userEmail]})]}),"pending_vendor"===e.status&&(0,u.jsx)("button",{onClick:()=>C(e),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Respond"}),"buyer_rescheduled"===e.status&&(0,u.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,u.jsx)("button",{onClick:()=>(async e=>{await(0,b.HK)(e.id,{status:"accepted",confirmedDate:e.preferredDate,confirmedTime:e.preferredTime,vendorMessage:"Buyer reschedule accepted"})?(v.Ay.success("Rescheduled inspection confirmed"),k()):v.Ay.error("Failed to confirm reschedule")})(e),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Accept New Time"}),(0,u.jsx)("button",{onClick:()=>C(e,"propose"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Propose Another Time"})]}),"accepted"===e.status&&(0,u.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,u.jsx)("button",{onClick:()=>C(e,"propose"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Reschedule"}),(0,u.jsx)("button",{onClick:()=>(async e=>{if(!window.confirm("Cancel this inspection? The buyer will be notified."))return;await(0,b.HK)(e.id,{status:"cancelled_by_vendor",vendorMessage:"Vendor cancelled the appointment",cancelledAt:(new Date).toISOString()})?(v.Ay.success("Inspection cancelled"),k()):v.Ay.error("Failed to cancel inspection")})(e),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Cancel"})]}),"cancelled_by_buyer"===e.status&&(0,u.jsx)("span",{className:"text-sm text-gray-500",children:"Buyer cancelled this appointment"}),"cancelled_by_vendor"===e.status&&(0,u.jsx)("span",{className:"text-sm text-gray-500",children:"You cancelled this appointment"})]})]},e.id))}),c&&x&&(0,u.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,u.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[(0,u.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Respond to Viewing Request"}),(0,u.jsxs)("div",{className:"space-y-4",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Response Type"}),(0,u.jsxs)("div",{className:"space-y-2",children:[(0,u.jsxs)("label",{className:"flex items-center",children:[(0,u.jsx)("input",{type:"radio",value:"accept",checked:"accept"===g,onChange:e=>h(e.target.value),className:"mr-2"}),"Accept as requested"]}),(0,u.jsxs)("label",{className:"flex items-center",children:[(0,u.jsx)("input",{type:"radio",value:"propose",checked:"propose"===g,onChange:e=>h(e.target.value),className:"mr-2"}),"Propose different time"]}),(0,u.jsxs)("label",{className:"flex items-center",children:[(0,u.jsx)("input",{type:"radio",value:"decline",checked:"decline"===g,onChange:e=>h(e.target.value),className:"mr-2"}),"Decline request"]})]})]}),"propose"===g&&(0,u.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Proposed Date"}),(0,u.jsx)("input",{type:"date",value:y,onChange:e=>f(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Proposed Time"}),(0,u.jsx)("input",{type:"time",value:j,onChange:e=>N(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Message (Optional)"}),(0,u.jsx)("textarea",{value:w,onChange:e=>A(e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Add a personal message..."})]})]}),(0,u.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,u.jsx)("button",{onClick:()=>m(!1),className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),(0,u.jsx)("button",{onClick:async()=>{if(x)try{let e={};if("accept"===g)e={status:"accepted",confirmedDate:x.preferredDate,confirmedTime:x.preferredTime,vendorMessage:w||"Viewing confirmed. Looking forward to showing you the property!"};else if("propose"===g){if(!y||!j)return void v.Ay.error("Please select a proposed date and time");e={status:"proposed_new_time",proposedDate:y,proposedTime:j,vendorMessage:w||"I would like to propose a different time. Please let me know if this works for you."}}else"decline"===g&&(e={status:"declined",vendorMessage:w||"Unfortunately, I am not available at the requested time."});await(0,b.HK)(x.id,e)?(v.Ay.success("Request ".concat("accept"===g?"accepted":"propose"===g?"updated with new time":"declined")),m(!1),p(null),k()):v.Ay.error("Failed to update request")}catch(e){console.error("Error updating request:",e),v.Ay.error("Failed to update request")}},className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Submit Response"})]})]})})]})},j=()=>{const{notifications:e,unreadCount:t,loading:s,markAsRead:r,markAllAsRead:l,archiveNotification:m,deleteNotification:x,refreshNotifications:p}=(0,o.E$)(),{user:g}=(0,n.As)(),h=(0,i.Zp)(),[y,b]=(0,a.useState)(!1),[f,j]=(0,a.useState)(null),N=(0,a.useRef)(null),[w,A]=(0,a.useState)(!1),[k,C]=(0,a.useState)(null),[S,I]=(0,a.useState)(0),[P,_]=(0,a.useState)("");(0,a.useEffect)(()=>{const e=e=>{N.current&&!N.current.contains(e.target)&&b(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);const D=e=>{var t,s;const r=(e=>{var t,s,r,a;const i=(null===e||void 0===e||null===(t=e.data)||void 0===t||null===(s=t.recipientRoles)||void 0===s?void 0:s[0])||(null===e||void 0===e||null===(r=e.data)||void 0===r?void 0:r.role);return"vendor"===i?"/vendor/inspections":"buyer"===i?"/buyer/inspections":"vendor"===(null===g||void 0===g?void 0:g.role)||null!==g&&void 0!==g&&null!==(a=g.roles)&&void 0!==a&&a.includes("vendor")?"/vendor/inspections":"/buyer/inspections"})(e),a=new URLSearchParams;null!==e&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&t.requestId&&a.set("inspectionId",e.data.requestId),null!==e&&void 0!==e&&null!==(s=e.data)&&void 0!==s&&s.propertyTitle&&a.set("property",e.data.propertyTitle);const i=a.toString()?"".concat(r,"?").concat(a.toString()):r;b(!1),h(i)},q=(e,t)=>{const s="text-lg ".concat("urgent"===t?"text-red-500":"high"===t?"text-orange-500":"medium"===t?"text-blue-500":"text-gray-500");switch(e){case"property_verified":case"property_approval":case"escrow_created":case"escrow_payment_received":case"payment_received":case"escrow_completed":case"user_activated":return(0,u.jsx)(d.A7C,{className:s});case"property_rejected":case"user_suspended":return(0,u.jsx)(d._Hm,{className:s});case"property_inquiry":default:return(0,u.jsx)(d.__w,{className:s});case"escrow_disputed":case"escrow_timeout":return(0,u.jsx)(d.BS8,{className:s})}},V=e=>{switch(e){case"urgent":return"border-l-red-500 bg-red-50";case"high":return"border-l-orange-500 bg-orange-50";case"medium":return"border-l-blue-500 bg-blue-50";default:return"border-l-gray-500 bg-gray-50"}},E=e=>{const t=new Date(e),s=new Date,r=Math.floor((s-t)/1e3);return r<60?"Just now":r<3600?"".concat(Math.floor(r/60),"m ago"):r<86400?"".concat(Math.floor(r/3600),"h ago"):r<2592e3?"".concat(Math.floor(r/86400),"d ago"):t.toLocaleDateString()};return(0,u.jsxs)("div",{className:"relative",ref:N,children:[(0,u.jsxs)("button",{onClick:()=>{h("/alerts")},className:"relative p-2 text-gray-700 hover:text-brand-orange transition-colors",children:[(0,u.jsx)(d.jNV,{className:"text-xl"}),t>0&&(0,u.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:t>99?"99+":t})]}),y&&(0,u.jsxs)("div",{className:"absolute right-0 mt-2 w-96 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:[(0,u.jsxs)("div",{className:"p-4 border-b border-gray-200",children:[(0,u.jsxs)("div",{className:"flex items-center justify-between",children:[(0,u.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["Notifications",t>0&&(0,u.jsxs)("span",{className:"ml-2 bg-red-100 text-red-800 text-sm px-2 py-1 rounded-full",children:[t," unread"]})]}),(0,u.jsx)("button",{onClick:()=>b(!1),className:"text-gray-400 hover:text-gray-600",children:(0,u.jsx)(d.QCr,{})})]}),t>0&&(0,u.jsxs)("button",{onClick:async()=>{j("all");try{const e=await l();e.success?v.Ay.success("All notifications marked as read"):v.Ay.error(e.message||"Failed to mark all as read")}catch(e){v.Ay.error("Error marking all notifications as read")}finally{j(null)}},disabled:"all"===f,className:"mt-2 text-sm text-blue-600 hover:text-blue-800 disabled:opacity-50",children:["all"===f?(0,u.jsx)(d.hW,{className:"animate-spin inline mr-1"}):(0,u.jsx)(d.CMH,{className:"inline mr-1"}),"Mark all as read"]})]}),(0,u.jsx)("div",{className:"max-h-96 overflow-y-auto",children:s?(0,u.jsxs)("div",{className:"p-8 text-center",children:[(0,u.jsx)(d.hW,{className:"animate-spin text-2xl text-gray-400 mx-auto mb-2"}),(0,u.jsx)("p",{className:"text-gray-500",children:"Loading notifications..."})]}):0===e.length?(0,u.jsxs)("div",{className:"p-8 text-center",children:[(0,u.jsx)(d.jNV,{className:"text-4xl text-gray-300 mx-auto mb-2"}),(0,u.jsx)("p",{className:"text-gray-500",children:"No notifications yet"})]}):(0,u.jsx)("div",{className:"divide-y divide-gray-100",children:e.slice(0,10).map(e=>{var t,s;return(0,u.jsx)("div",{className:"p-4 border-l-4 ".concat(V(e.priority)," ").concat("unread"===e.status?"bg-blue-50":"bg-white"),children:(0,u.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,u.jsx)("div",{className:"flex-shrink-0 mt-1",children:q(e.type,e.priority)}),(0,u.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,u.jsxs)("div",{className:"flex items-start justify-between",children:[(0,u.jsxs)("div",{className:"flex-1",children:[(0,u.jsx)("p",{className:"text-sm font-medium ".concat("unread"===e.status?"text-gray-900":"text-gray-700"),children:e.title}),(0,u.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.message}),(0,u.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:E(e.createdAt)})]}),"unread"===e.status&&(0,u.jsx)("div",{className:"flex-shrink-0 ml-2",children:(0,u.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})})]}),(0,u.jsxs)("div",{className:"flex items-center flex-wrap gap-2 mt-3",children:[(null===(t=e.type)||void 0===t?void 0:t.startsWith("inspection_"))&&(0,u.jsxs)("button",{onClick:()=>D(e),className:"text-xs text-indigo-600 hover:text-indigo-800 flex items-center",children:[(0,u.jsx)(d.__w,{className:"mr-1"}),"View inspection"]}),("property_inquiry"===e.type||"payment_received"===e.type)&&(0,u.jsxs)("button",{onClick:()=>(async e=>{try{const{data:t}=e,s=(null===t||void 0===t?void 0:t.buyerId)||g.id,r=null===t||void 0===t?void 0:t.vendorId,a=null===t||void 0===t?void 0:t.propertyId;if(!r||!a)return void v.Ay.error("Unable to start chat: missing vendor or property");const i={buyerId:s,vendorId:r,propertyId:a,starterId:g.id,initialMessage:"Hi, I'm interested in this property."},n=await fetch((0,c.e9)("/chats/start"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}),l=await n.json();n.ok?(b(!1),h("/messages",{state:{chatId:l.chatId}}),v.Ay.success("Chat started!")):v.Ay.error(l.error||"Failed to start chat")}catch(t){console.error("Error starting chat:",t),v.Ay.error("Error starting chat")}})(e),className:"text-xs text-green-600 hover:text-green-800 flex items-center",children:[(0,u.jsx)(d.uN,{className:"mr-1"}),"Send Message"]}),"payment_received"===e.type&&(0,u.jsxs)("button",{onClick:()=>(e=>{const{data:t}=e,s=(null===t||void 0===t?void 0:t.vendorId)||(null===t||void 0===t?void 0:t.buyerId),r=null!==t&&void 0!==t&&t.vendorId?"vendor":"buyer";C({rateeId:s,roleOfRatee:r,transactionId:null===t||void 0===t?void 0:t.transactionId,propertyId:null===t||void 0===t?void 0:t.propertyId}),A(!0),b(!1)})(e),className:"text-xs text-yellow-600 hover:text-yellow-800 flex items-center",children:[(0,u.jsx)(d.gt3,{className:"mr-1"}),"Rate ",null!==(s=e.data)&&void 0!==s&&s.vendorId?"Vendor":"Buyer"]}),"unread"===e.status&&(0,u.jsxs)("button",{onClick:()=>(async e=>{j(e);try{const t=await r(e);t.success?v.Ay.success("Notification marked as read"):v.Ay.error(t.message||"Failed to mark as read")}catch(t){v.Ay.error("Error marking notification as read")}finally{j(null)}})(e._id),disabled:f===e._id,className:"text-xs text-blue-600 hover:text-blue-800 disabled:opacity-50 flex items-center",children:[f===e._id?(0,u.jsx)(d.hW,{className:"animate-spin mr-1"}):(0,u.jsx)(d.CMH,{className:"mr-1"}),"Mark read"]}),(0,u.jsxs)("button",{onClick:()=>(async e=>{j(e);try{const t=await m(e);t.success?v.Ay.success("Notification archived"):v.Ay.error(t.message||"Failed to archive")}catch(t){v.Ay.error("Error archiving notification")}finally{j(null)}})(e._id),disabled:f===e._id,className:"text-xs text-gray-600 hover:text-gray-800 disabled:opacity-50 flex items-center",children:[f===e._id?(0,u.jsx)(d.hW,{className:"animate-spin mr-1"}):(0,u.jsx)(d.Wlj,{className:"mr-1"}),"Archive"]}),(0,u.jsxs)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this notification?")){j(e);try{const t=await x(e);t.success?v.Ay.success("Notification deleted"):v.Ay.error(t.message||"Failed to delete")}catch(t){v.Ay.error("Error deleting notification")}finally{j(null)}}})(e._id),disabled:f===e._id,className:"text-xs text-red-600 hover:text-red-800 disabled:opacity-50 flex items-center",children:[f===e._id?(0,u.jsx)(d.hW,{className:"animate-spin mr-1"}):(0,u.jsx)(d.qbC,{className:"mr-1"}),"Delete"]})]})]})]})},e._id)})})}),e.length>10&&(0,u.jsx)("div",{className:"p-4 border-t border-gray-200",children:(0,u.jsx)("button",{onClick:p,className:"w-full text-sm text-blue-600 hover:text-blue-800",children:"View all notifications"})})]}),w&&(0,u.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",children:(0,u.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6 shadow-xl",children:[(0,u.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Rate ","vendor"===(null===k||void 0===k?void 0:k.roleOfRatee)?"Vendor":"Buyer"]}),(0,u.jsxs)("div",{className:"space-y-4",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rating"}),(0,u.jsx)("div",{className:"flex space-x-1",children:[1,2,3,4,5].map(e=>(0,u.jsx)("button",{onClick:()=>I(e),className:"text-3xl transition-colors ".concat(e<=S?"text-yellow-400":"text-gray-300"),children:(0,u.jsx)(d.gt3,{})},e))})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Comment (Optional)"}),(0,u.jsx)("textarea",{value:P,onChange:e=>_(e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Share your experience..."})]}),(0,u.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,u.jsx)("button",{onClick:()=>{A(!1),I(0),_(""),C(null)},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",children:"Cancel"}),(0,u.jsx)("button",{onClick:async()=>{if(k&&0!==S)try{const e=await fetch((0,c.e9)("/ratings"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({raterId:g.id,rateeId:k.rateeId,transactionId:k.transactionId,propertyId:k.propertyId,roleOfRatee:k.roleOfRatee,stars:S,comment:P})}),t=await e.json();e.ok?(v.Ay.success("Rating submitted successfully!"),A(!1),I(0),_(""),C(null)):v.Ay.error(t.error||"Failed to submit rating")}catch(e){console.error("Error submitting rating:",e),v.Ay.error("Error submitting rating")}else v.Ay.error("Please select a rating")},disabled:0===S,className:"px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Submit Rating"})]})]})]})})]})};var N=s(8329),w=(s(2407),s(6058)),A=s(7304);A.t1.register(A.PP,A.kc,A.FN,A.No,A.hE,A.m_,A.s$);const k=e=>{let{properties:t=[]}=e;const s={labels:t.map((e,t)=>e.title||"Property ".concat(t+1)),datasets:[{label:"Views",data:t.map(e=>e.views||0),borderColor:"#2563EB",backgroundColor:"#2563EB20",borderWidth:2,tension:.3,pointRadius:4,pointBackgroundColor:"#2563EB"}]};return t.length?(0,u.jsx)("div",{className:"h-64",children:(0,u.jsx)(w.N1,{data:s,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:e=>"Views: ".concat(e.parsed.y)}}},scales:{y:{beginAtZero:!0,ticks:{precision:0}}}}})}):(0,u.jsx)("div",{className:"h-64 flex items-center justify-center text-sm text-gray-500",children:"No property data available yet."})};A.t1.register(A.PP,A.kc,A.E8,A.hE,A.m_,A.s$);const C=e=>{let{properties:t=[]}=e;const s={labels:t.map((e,t)=>e.title||"Property ".concat(t+1)),datasets:[{label:"Conversion Rate (%)",data:t.map(e=>{const t=e.views||0,s=e.inquiries||0;return t?(s/t*100).toFixed(1):0}),backgroundColor:"#10B98180",borderColor:"#10B981",borderWidth:1}]};return t.length?(0,u.jsx)("div",{className:"h-64",children:(0,u.jsx)(w.yP,{data:s,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:e=>"Conversion: ".concat(e.parsed.y,"%")}}},scales:{y:{beginAtZero:!0,max:100,ticks:{callback:e=>"".concat(e,"%")}}}}})}):(0,u.jsx)("div",{className:"h-64 flex items-center justify-center text-sm text-gray-500",children:"No property data available yet."})},S=()=>{var e,t,s,x,b,w,A,S;const{user:I}=(0,n.As)(),{deleteProperty:P}=(0,l.NC)();(0,o.E$)();const _=(0,i.zy)(),D=(0,i.Zp)(),[q,V]=(0,a.useState)(()=>"/vendor/properties"===_.pathname?"properties":"overview");(0,a.useEffect)(()=>{"/vendor/properties"===_.pathname?V("properties"):"/vendor/dashboard"===_.pathname&&V("overview")},[_.pathname]);const E="agent"===(null===I||void 0===I||null===(e=I.vendorData)||void 0===e?void 0:e.vendorCategory),[R,T]=(null===I||void 0===I||null===(t=I.vendorData)||void 0===t||t.vendorCategory,(0,a.useState)([])),[L,B]=(0,a.useState)(!0),[O,U]=(0,a.useState)({totalProperties:0,activeListings:0,pendingListings:0,soldProperties:0,totalViews:0,totalInquiries:0,totalRevenue:0,averagePrice:0,conversionRate:0,monthlyViews:0,monthlyInquiries:0}),[F,M]=(0,a.useState)([]),[J,Y]=(0,a.useState)([]),[W,z]=(0,a.useState)(!1),[H,G]=(0,a.useState)(""),[Q,$]=(0,a.useState)(""),[K,Z]=(0,a.useState)(null),[X,ee]=(0,a.useState)(!1),[te,se]=(0,a.useState)(null),[re,ae]=(0,a.useState)([]),[ie,ne]=(0,a.useState)(!1);(0,a.useEffect)(()=>{_.pathname.startsWith("/vendor/add-property")?V("add"):_.pathname.startsWith("/vendor/properties")?V("properties"):_.pathname.startsWith("/vendor/dashboard")},[_.pathname]);const le=(0,a.useCallback)(async()=>{if(!I)return T([]),void B(!1);B(!0);try{const t=(null===I||void 0===I?void 0:I.id)||(null===I||void 0===I?void 0:I.uid),s=null===I||void 0===I?void 0:I.email;if(console.log("VendorDashboard: Fetching properties for user:",{userId:t,userEmail:s}),!t&&!s)return console.log("VendorDashboard: No user ID or email found"),T([]),void B(!1);let a=[];try{const e=JSON.parse(localStorage.getItem("mockProperties")||"[]").filter(e=>{const r=e.ownerId===t||e.ownerId===(null===I||void 0===I?void 0:I.id),a=e.ownerEmail===s;return r||a});e.length>0&&(console.log("VendorDashboard: Found",e.length,"properties in localStorage"),a=e.map(e=>(0,r.A)((0,r.A)({},e),{},{source:"localStorage",createdAt:e.createdAt?new Date(e.createdAt):new Date})))}catch(e){console.warn("VendorDashboard: Error reading localStorage:",e)}try{const e=await(0,m.Ud)((0,c.e9)("/properties"),{headers:{"Content-Type":"application/json"}});if(e.ok){const t=await e.json(),s=Array.isArray(t.data)?t.data:Array.isArray(t)?t:[];console.log("VendorDashboard: Found",s.length,"properties from backend"),s.forEach(e=>{const t=a.findIndex(t=>t.id===e.id);t>=0?a[t]=(0,r.A)((0,r.A)((0,r.A)({},a[t]),e),{},{source:"api",createdAt:e.createdAt?new Date(e.createdAt):new Date}):a.push((0,r.A)((0,r.A)({},e),{},{source:"api",createdAt:e.createdAt?new Date(e.createdAt):new Date}))})}}catch(e){console.warn("VendorDashboard: Error fetching from backend API:",e)}a.sort((e,t)=>{const s=e.createdAt instanceof Date?e.createdAt:new Date(e.createdAt||0);return(t.createdAt instanceof Date?t.createdAt:new Date(t.createdAt||0))-s}),console.log("VendorDashboard: Total properties found:",a.length);const i=a.map(e=>{var t,s,a,i,n,l,o;const d=e.details||{},c=e.images||[],m=(null===(t=c.find(e=>e.isPrimary))||void 0===t?void 0:t.url)||("string"===typeof c[0]?c[0]:null===(s=c[0])||void 0===s?void 0:s.url)||"https://images.unsplash.com/photo-1600607687939-ce8a6c25118c?w=400&h=300&fit=crop";let u="pending";return"approved"===e.approvalStatus||"approved"===e.verificationStatus?u="active":"rejected"===e.approvalStatus||"rejected"===e.verificationStatus?u="rejected":"pending"!==e.approvalStatus&&"pending"!==e.verificationStatus||(u="pending"),(0,r.A)((0,r.A)({},e),{},{image:m,bedrooms:e.bedrooms||d.bedrooms||0,bathrooms:e.bathrooms||d.bathrooms||0,area:e.area||d.sqft||0,location:"object"===typeof e.location?"".concat(e.location.address||"",", ").concat(e.location.city||"",", ").concat(e.location.state||"").replace(/^, |, $/g,""):e.location||"Location not specified",status:u,views:e.views||0,inquiries:e.inquiriesCount||0,favorites:e.favoritesCount||0,dateListed:e.createdAt instanceof Date?e.createdAt.toISOString().split("T")[0]:"string"===typeof e.createdAt?e.createdAt.split("T")[0]:"Unknown",lastUpdated:(null===(a=e.updatedAt)||void 0===a||null===(i=a.toDate)||void 0===i||null===(n=i.call(a))||void 0===n||null===(l=n.toISOString)||void 0===l||null===(o=l.call(n))||void 0===o?void 0:o.split("T")[0])||("string"===typeof e.updatedAt?e.updatedAt.split("T")[0]:null)})});console.log("VendorDashboard: Total properties loaded:",i.length),T(i)}catch(t){console.error("VendorDashboard: Error fetching properties:",t),v.Ay.error("Failed to load properties")}finally{B(!1)}},[I]),oe=(0,a.useCallback)(async()=>{if(I)try{ne(!0);const e=await(0,m.Ud)((0,c.e9)("/verification/applications/mine"),{headers:{"Content-Type":"application/json"}}),t=await e.json();e.ok&&t.success?ae(Array.isArray(t.data)?t.data:[]):console.warn("VendorDashboard: Failed to load verification requests",null===t||void 0===t?void 0:t.message)}catch(e){console.error("VendorDashboard: Error fetching verification requests",e)}finally{ne(!1)}else ae([])},[I]);(0,a.useEffect)(()=>{le()},[I,le]),(0,a.useEffect)(()=>{I?oe():ae([])},[I,oe]),(0,a.useEffect)(()=>{(async()=>{if(I)try{const e=await(0,m.Ud)((0,c.e9)("/dashboard/vendor"),{headers:{"Content-Type":"application/json"}}),t=await e.json();if(!e.ok||!t.success)return void console.warn("VendorDashboard: Failed to load backend analytics summary");const s=t.data||{};U(e=>{var t,a,i,n,l,o,d,c;return(0,r.A)((0,r.A)({},e),{},{totalProperties:null!==(t=s.totalProperties)&&void 0!==t?t:e.totalProperties,activeListings:null!==(a=s.activeListings)&&void 0!==a?a:e.activeListings,pendingListings:null!==(i=s.pendingListings)&&void 0!==i?i:e.pendingListings,soldProperties:null!==(n=s.soldProperties)&&void 0!==n?n:e.soldProperties,totalViews:null!==(l=s.totalViews)&&void 0!==l?l:e.totalViews,totalInquiries:null!==(o=s.totalInquiries)&&void 0!==o?o:e.totalInquiries,totalRevenue:null!==(d=s.totalRevenue)&&void 0!==d?d:e.totalRevenue,conversionRate:null!==(c=s.conversionRate)&&void 0!==c?c:e.conversionRate})})}catch(e){console.warn("VendorDashboard: Error fetching backend analytics summary",e)}})()},[I]),(0,a.useEffect)(()=>{M([{id:1,propertyId:1,propertyTitle:"Luxury Apartment in Victoria Island",buyerName:"John Adebayo",buyerEmail:"john@email.com",buyerPhone:"+234 801 234 5678",message:"I'm interested in viewing this property. When would be a good time?",status:"new",date:"2024-01-20",priority:"high"},{id:2,propertyId:2,propertyTitle:"Modern Family House in Lekki",buyerName:"Sarah Johnson",buyerEmail:"sarah@email.com",buyerPhone:"+234 802 345 6789",message:"Could you provide more details about the neighborhood and amenities?",status:"contacted",date:"2024-01-19",priority:"medium"}]);try{const e=JSON.parse(localStorage.getItem("viewingRequests")||"[]");Y(e)}catch(e){Y([])}},[]);const de=e=>{switch(e){case"active":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"sold":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},ce=e=>{switch(e){case"high":return"bg-red-100 text-red-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},me=(0,a.useMemo)(()=>{const e={};return re.forEach(t=>{var s,r,a,i,n,l;const o=null!==(s=null!==(r=null!==(a=t.propertyId)&&void 0!==a?a:null===(i=t.property)||void 0===i?void 0:i.id)&&void 0!==r?r:null===(n=t.property)||void 0===n?void 0:n.propertyId)&&void 0!==s?s:null===(l=t.property)||void 0===l?void 0:l.propertyRef;void 0!==o&&null!==o&&(e[o.toString()]=t.status||"pending")}),e},[re]);(0,a.useCallback)(e=>{if(!e)return"not_requested";if(e.isVerified)return"approved";const t=[e.id,e.propertyId,e.numericId,e.referenceCode].filter(e=>void 0!==e&&null!==e).map(e=>e.toString());for(const s of t)if(me[s])return me[s];return e.verificationStatus||"not_requested"},[me]),(0,a.useCallback)(e=>{switch(e){case"approved":return{label:"\u2713 Verified",badgeClass:"bg-green-100 text-green-800"};case"pending":return{label:"Verification requested",badgeClass:"bg-yellow-100 text-yellow-800"};case"rejected":return{label:"Verification rejected",badgeClass:"bg-red-100 text-red-800"};default:return{label:"Not verified",badgeClass:"bg-gray-100 text-gray-800"}}},[]),(0,a.useCallback)(e=>"approved"===e?{show:!1}:"pending"===e?{show:!0,label:"Verification requested",disabled:!0}:"rejected"===e?{show:!0,label:"Resubmit verification",disabled:!1}:{show:!0,label:"Get Verified",disabled:!1},[]);return(0,u.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,u.jsxs)("div",{className:"w-full max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,u.jsxs)("div",{className:"mb-6 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,u.jsxs)("div",{className:"flex items-center gap-4",children:[(0,u.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-brand-blue to-blue-600 rounded-full flex items-center justify-center",children:null!==I&&void 0!==I&&I.photoURL||null!==I&&void 0!==I&&I.avatar?(0,u.jsx)("img",{src:I.photoURL||I.avatar,alt:"User avatar",className:"w-12 h-12 rounded-full object-cover"}):(0,u.jsx)("span",{className:"text-lg font-medium text-white",children:null!==I&&void 0!==I&&I.displayName?I.displayName.split(" ").map(e=>e[0]).join("").toUpperCase():null!==I&&void 0!==I&&I.firstName&&null!==I&&void 0!==I&&I.lastName?"".concat(I.firstName[0]).concat(I.lastName[0]).toUpperCase():null!==I&&void 0!==I&&I.email?I.email[0].toUpperCase():"V"})}),(0,u.jsxs)("div",{children:[(0,u.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:(null===I||void 0===I?void 0:I.displayName)||"".concat((null===I||void 0===I?void 0:I.firstName)||""," ").concat((null===I||void 0===I?void 0:I.lastName)||"").trim()||"Vendor Account"}),(0,u.jsx)("p",{className:"text-sm text-gray-600",children:E?"Real Estate Agent":"Property Owner"})]})]}),(0,u.jsx)("div",{className:"relative md:self-auto self-start",children:(0,u.jsx)(j,{})})]}),(0,u.jsx)("div",{className:"mb-8",style:{marginTop:"0px"},children:(0,u.jsxs)("div",{className:"welcome-section",children:[(0,u.jsxs)("h1",{className:"text-2xl font-bold mb-2",children:["Welcome back, ",(null===I||void 0===I?void 0:I.firstName)||"Vendor","!"]}),(0,u.jsx)("p",{className:"text-blue-100 mb-4",children:E?"Help clients find their dream properties in ".concat((null===I||void 0===I||null===(s=I.vendorData)||void 0===s?void 0:s.agentLocation)||"your area",". Manage your listings, track inquiries, and grow your real estate business."):"Manage your properties, track inquiries, schedule viewings, and grow your real estate portfolio. List, edit, and monitor all your property listings in one place."}),(null===I||void 0===I?void 0:I.vendorCode)&&(0,u.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4 mb-4 border border-white/20",children:[(0,u.jsxs)("div",{className:"flex items-center justify-between",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("p",{className:"text-blue-200 text-sm",children:"Your Vendor ID (share with prospects)"}),(0,u.jsx)("p",{className:"text-2xl font-mono font-bold text-white tracking-wider",children:I.vendorCode})]}),(0,u.jsxs)("button",{onClick:()=>{navigator.clipboard.writeText(I.vendorCode),v.Ay.success("Vendor ID copied to clipboard!")},className:"bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-lg transition-colors flex items-center gap-2",children:[(0,u.jsx)(d.CMH,{className:"text-sm"}),"Copy"]})]}),(0,u.jsx)("p",{className:"text-blue-200 text-xs mt-2",children:"Buyers can search for your properties using this ID in the Properties tab."})]}),(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,u.jsx)("div",{className:"stats-card cursor-pointer hover:bg-blue-700 transition-colors",onClick:()=>D("/vendor/properties"),title:"View your properties",children:(0,u.jsxs)("div",{className:"flex items-center justify-between",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{className:"text-2xl font-bold text-white",children:O.activeListings||0}),(0,u.jsx)("div",{className:"text-blue-200 text-sm",children:E?"Managed Properties":"Active Listings"})]}),(0,u.jsx)(d.rQ8,{className:"text-blue-300 text-xl"})]})}),(0,u.jsx)("div",{className:"stats-card cursor-pointer hover:bg-blue-700 transition-colors",onClick:()=>{V("analytics"),window.scrollTo({top:0,behavior:"smooth"})},title:"View analytics",children:(0,u.jsxs)("div",{className:"flex items-center justify-between",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{className:"text-2xl font-bold text-white",children:(null===(x=O.totalViews)||void 0===x?void 0:x.toLocaleString())||0}),(0,u.jsx)("div",{className:"text-blue-200 text-sm",children:"Total Views"})]}),(0,u.jsx)(d.Ny1,{className:"text-blue-300 text-xl"})]})}),(0,u.jsx)("div",{className:"stats-card cursor-pointer hover:bg-blue-700 transition-colors",onClick:()=>{V("inquiries"),window.scrollTo({top:0,behavior:"smooth"})},title:"View inquiries",children:(0,u.jsxs)("div",{className:"flex items-center justify-between",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{className:"text-2xl font-bold text-white",children:O.totalInquiries||0}),(0,u.jsx)("div",{className:"text-blue-200 text-sm",children:"Inquiries"})]}),(0,u.jsx)(d.maD,{className:"text-blue-300 text-xl"})]})}),(0,u.jsx)("div",{className:"stats-card cursor-pointer hover:bg-blue-700 transition-colors",onClick:()=>{V("analytics"),window.scrollTo({top:0,behavior:"smooth"})},title:"View analytics",children:(0,u.jsxs)("div",{className:"flex items-center justify-between",children:[(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{className:"text-2xl font-bold text-white",children:[O.conversionRate||0,"%"]}),(0,u.jsx)("div",{className:"text-blue-200 text-sm",children:"Conversion Rate"})]}),(0,u.jsx)(d.YYR,{className:"text-blue-300 text-xl"})]})})]})]})}),(0,u.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 mb-6",children:[(0,u.jsx)("div",{className:"border-b border-gray-200",children:(0,u.jsx)("nav",{className:"flex overflow-x-auto no-scrollbar px-4 sm:px-6","aria-label":"Vendor dashboard sections",children:(0,u.jsx)("div",{className:"flex min-w-max divide-x divide-transparent",children:[{id:"overview",label:"Overview",icon:d.YYR},{id:"properties",label:"My Properties",icon:d.rQ8},{id:"inquiries",label:"Inquiries",icon:d.maD},{id:"viewings",label:"Viewing Requests",icon:d.itz},{id:"analytics",label:"Analytics",icon:d.YYR}].map(e=>(0,u.jsxs)("button",{onClick:()=>{V(e.id)},className:"flex items-center space-x-2 py-4 px-3 border-b-2 font-medium text-sm transition-colors ".concat(q===e.id?"border-brand-blue text-brand-blue":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,u.jsx)(e.icon,{className:"h-4 w-4"}),(0,u.jsx)("span",{children:e.label})]},e.id))})})}),(0,u.jsxs)("div",{className:"p-6",children:["overview"===q&&(0,u.jsxs)("div",{className:"space-y-6",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Activity"}),(0,u.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,u.jsxs)("div",{className:"space-y-3",children:[(0,u.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,u.jsx)("div",{className:"p-2 bg-green-100 rounded-full",children:(0,u.jsx)(d.Ny1,{className:"h-4 w-4 text-green-600"})}),(0,u.jsxs)("div",{className:"flex-1",children:[(0,u.jsx)("p",{className:"text-sm text-gray-900",children:'New view on "Luxury Apartment in Victoria Island"'}),(0,u.jsx)("p",{className:"text-xs text-gray-500",children:"2 minutes ago"})]})]}),(0,u.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,u.jsx)("div",{className:"p-2 bg-blue-100 rounded-full",children:(0,u.jsx)(d.maD,{className:"h-4 w-4 text-blue-600"})}),(0,u.jsxs)("div",{className:"flex-1",children:[(0,u.jsx)("p",{className:"text-sm text-gray-900",children:"New inquiry from John Adebayo"}),(0,u.jsx)("p",{className:"text-xs text-gray-500",children:"15 minutes ago"})]})]}),(0,u.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,u.jsx)("div",{className:"p-2 bg-orange-100 rounded-full",children:(0,u.jsx)(d.Mbv,{className:"h-4 w-4 text-orange-600"})}),(0,u.jsxs)("div",{className:"flex-1",children:[(0,u.jsx)("p",{className:"text-sm text-gray-900",children:"Property added to favorites"}),(0,u.jsx)("p",{className:"text-xs text-gray-500",children:"1 hour ago"})]})]})]})})]}),E&&(0,u.jsxs)("div",{className:"mb-6",children:[(0,u.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Agent Profile"}),(0,u.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Business Information"}),(0,u.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,u.jsxs)("p",{children:[(0,u.jsx)("span",{className:"font-medium",children:"Company:"})," ",null===I||void 0===I||null===(b=I.vendorData)||void 0===b?void 0:b.businessName]}),(0,u.jsxs)("p",{children:[(0,u.jsx)("span",{className:"font-medium",children:"Location:"})," ",null===I||void 0===I||null===(w=I.vendorData)||void 0===w?void 0:w.agentLocation]}),(0,u.jsxs)("p",{children:[(0,u.jsx)("span",{className:"font-medium",children:"Experience:"})," ",null===I||void 0===I||null===(A=I.vendorData)||void 0===A?void 0:A.experience]})]})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Contact Information"}),(0,u.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,u.jsxs)("p",{children:[(0,u.jsx)("span",{className:"font-medium",children:"Phone:"})," ",null===I||void 0===I?void 0:I.phone]}),(0,u.jsxs)("p",{children:[(0,u.jsx)("span",{className:"font-medium",children:"Email:"})," ",null===I||void 0===I?void 0:I.email]})]})]})]}),(0,u.jsx)("div",{className:"mt-4 pt-4 border-t border-blue-200",children:(0,u.jsxs)("p",{className:"text-sm text-blue-700",children:["\ud83d\udca1 ",(0,u.jsx)("strong",{children:"Tip:"})," Keep your profile updated to attract more clients in ",null===I||void 0===I||null===(S=I.vendorData)||void 0===S?void 0:S.agentLocation,"."]})})]})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,u.jsx)("button",{onClick:()=>{V("add"),D("/vendor/add-property")},className:"flex items-center space-x-3 p-4 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",title:"Add new property",children:(0,u.jsxs)("div",{className:"p-2 bg-blue-100 rounded-full",children:[(0,u.jsx)("p",{className:"font-medium text-gray-900",children:"Update Listings"}),(0,u.jsx)("p",{className:"text-sm text-gray-500",children:"Edit property details"})]})}),(0,u.jsxs)("button",{className:"flex items-center space-x-3 p-4 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",title:"View performance analytics",children:[(0,u.jsx)("div",{className:"p-2 bg-purple-100 rounded-full",children:(0,u.jsx)(d.YYR,{className:"h-5 w-5 text-purple-600"})}),(0,u.jsxs)("div",{className:"text-left",children:[(0,u.jsx)("p",{className:"font-medium text-gray-900",children:"View Analytics"}),(0,u.jsx)("p",{className:"text-sm text-gray-500",children:"Check performance"})]})]})]})]})]}),"properties"===q&&(0,u.jsxs)("div",{className:"space-y-6",children:[(0,u.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,u.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"My Properties"}),(0,u.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,u.jsx)("button",{onClick:le,className:"btn-secondary flex items-center space-x-2",disabled:L,children:L?(0,u.jsx)(d.hW,{className:"h-4 w-4 animate-spin"}):(0,u.jsx)("span",{children:"Refresh"})}),(0,u.jsxs)("button",{onClick:()=>D("/vendor/add-property"),className:"btn-primary flex items-center space-x-2",children:[(0,u.jsx)(d.OiG,{className:"h-4 w-4"}),(0,u.jsx)("span",{children:"Add Property"})]})]})]}),L&&(0,u.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:(0,u.jsx)(N.A,{count:6})}),!L&&0===R.length&&(0,u.jsxs)("div",{className:"text-center py-12 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:[(0,u.jsx)(d.rQ8,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,u.jsx)("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"No properties yet"}),(0,u.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Get started by adding your first property listing."}),(0,u.jsxs)("button",{onClick:()=>D("/vendor/add-property"),className:"mt-4 btn-primary inline-flex items-center space-x-2",children:[(0,u.jsx)(d.OiG,{className:"h-4 w-4"}),(0,u.jsx)("span",{children:"Add Your First Property"})]})]}),!L&&R.length>0&&(0,u.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:R.map(e=>{var t,s,r;const a=g(e.id),i=(n=e.id,y(n)?"Verified":h(n)?"Verification Requested":"Get Verified");var n;const l=(e=>y(e)?"bg-green-600 text-white cursor-not-allowed":h(e)?"bg-yellow-600 text-white cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700")(e.id),o=y(e.id)||h(e.id);return(0,u.jsxs)("div",{className:"property-card",children:[(0,u.jsxs)("div",{className:"relative",children:[(0,u.jsx)("img",{src:e.image,alt:e.title,className:"w-full h-48 object-cover rounded-t-lg"}),(0,u.jsxs)("div",{className:"absolute top-3 left-3 flex flex-col space-y-1",children:[(0,u.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(de(e.status)),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)}),"localStorage"===e.source&&!e.savedToFirestore&&(0,u.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-800",title:"This property is stored locally and may be lost if you clear browser data",children:"\u26a0\ufe0f Local Only"})]}),(0,u.jsxs)("div",{className:"absolute top-3 right-3 flex space-x-2",children:[(0,u.jsx)("button",{className:"p-2 bg-white bg-opacity-90 rounded-full hover:bg-opacity-100 transition-all",title:"Edit property","aria-label":"Edit property",onClick:()=>D("/vendor/add-property",{state:{propertyToEdit:e}}),children:(0,u.jsx)(d.uO9,{className:"h-4 w-4 text-gray-600"})}),(0,u.jsx)("button",{className:"p-2 bg-white bg-opacity-90 rounded-full hover:bg-opacity-100 transition-all",title:"Delete property","aria-label":"Delete property",onClick:()=>(async e=>{if(!I)return v.Ay.error("Please login to manage your properties"),void D("/");window.confirm("Are you sure you want to delete this property? This action cannot be undone.")&&(T(t=>t.filter(t=>t.id!==e)),await P(e),await le())})(e.id),children:(0,u.jsx)(d.qbC,{className:"h-4 w-4 text-red-600"})})]})]}),(0,u.jsxs)("div",{className:"p-4",children:[(0,u.jsxs)("div",{className:"text-2xl font-bold text-gray-900 mb-1",children:["\u20a6",(e.price||0).toLocaleString()]}),(0,u.jsx)("h3",{className:"font-semibold text-gray-900 mb-1",children:e.title}),(0,u.jsxs)("p",{className:"text-gray-600 text-sm mb-3 flex items-center",children:[(0,u.jsx)(d.vq8,{className:"h-3 w-3 mr-1"}),(()=>{if("string"===typeof e.location)return e.location;if(e.location&&"object"===typeof e.location){if(e.location.address)return e.location.address;const t=e.location.city||"",s=e.location.state||"";return"".concat(t).concat(t&&s?", ":"").concat(s).trim()}return"Location not specified"})()]}),(0,u.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-600 mb-4",children:[(0,u.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,u.jsx)(d.TiC,{className:"h-3 w-3"}),(0,u.jsx)("span",{children:e.bedrooms||(null===(t=e.details)||void 0===t?void 0:t.bedrooms)||0})]}),(0,u.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,u.jsx)(d.F6e,{className:"h-3 w-3"}),(0,u.jsx)("span",{children:e.bathrooms||(null===(s=e.details)||void 0===s?void 0:s.bathrooms)||0})]}),(0,u.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,u.jsx)(d.VlX,{className:"h-3 w-3"}),(0,u.jsxs)("span",{children:[e.area||(null===(r=e.details)||void 0===r?void 0:r.sqft)||0,"m\xb2"]})]})]}),(0,u.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center text-sm",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{className:"font-semibold text-gray-900",children:e.views}),(0,u.jsx)("div",{className:"text-gray-500",children:"Views"})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{className:"font-semibold text-gray-900",children:e.inquiries}),(0,u.jsx)("div",{className:"text-gray-500",children:"Inquiries"})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{className:"font-semibold text-gray-900",children:e.favorites}),(0,u.jsx)("div",{className:"text-gray-500",children:"Favorites"})]})]}),(0,u.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[(0,u.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-3",children:[(0,u.jsxs)("span",{children:["Listed: ",new Date(e.dateListed).toLocaleDateString()]}),(0,u.jsxs)("span",{children:["Updated: ",new Date(e.lastUpdated).toLocaleDateString()]})]}),(0,u.jsxs)("div",{className:"flex items-center justify-between",children:[(0,u.jsx)("div",{className:"flex items-center space-x-2",children:a&&(0,u.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("approved"===a.status?"bg-green-100 text-green-800":"requested"===a.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:"approved"===a.status?"\u2713 Verified":"requested"===a.status?"\u23f3 Verification Requested":"Not Verified"})}),(0,u.jsx)("button",{onClick:()=>(e=>{y(e.id)?(0,v.Ay)("This property is already verified!",{icon:"\u2705"}):h(e.id)?(0,v.Ay)("Verification already requested for this property.",{icon:"\u2139\ufe0f"}):(se(e),ee(!0))})(e),disabled:o,className:"px-3 py-1 text-xs rounded-md transition-colors ".concat(l),children:i})]})]})]})]},e.id)})})]}),"inquiries"===q&&(0,u.jsxs)("div",{className:"space-y-6",children:[(0,u.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[(0,u.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Property Inquiries & Viewings"}),(0,u.jsx)("div",{className:"flex flex-wrap gap-2",children:(0,u.jsxs)("select",{className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 w-full sm:w-auto",children:[(0,u.jsx)("option",{children:"All Inquiries"}),(0,u.jsx)("option",{children:"New"}),(0,u.jsx)("option",{children:"Contacted"}),(0,u.jsx)("option",{children:"Follow-up"})]})})]}),(0,u.jsx)("div",{className:"space-y-4",children:F.map(e=>(0,u.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:(0,u.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between",children:[(0,u.jsxs)("div",{className:"flex-1",children:[(0,u.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,u.jsx)("h4",{className:"font-semibold text-gray-900",children:e.buyerName}),(0,u.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(ce(e.priority)),children:e.priority}),(0,u.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("new"===e.status?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:e.status})]}),(0,u.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["Property: ",e.propertyTitle]}),(0,u.jsx)("p",{className:"text-gray-700 mb-3",children:e.message}),(0,u.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[(0,u.jsxs)("span",{className:"flex items-center",children:[(0,u.jsx)(d.maD,{className:"h-3 w-3 mr-1"}),e.buyerEmail]}),(0,u.jsxs)("span",{className:"flex items-center",children:[(0,u.jsx)(d.Cab,{className:"h-3 w-3 mr-1"}),e.buyerPhone]}),(0,u.jsxs)("span",{className:"flex items-center",children:[(0,u.jsx)(d.itz,{className:"h-3 w-3 mr-1"}),new Date(e.date).toLocaleDateString()]})]})]}),(0,u.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 sm:ml-4",children:[(0,u.jsx)("button",{className:"px-3 py-2 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 transition-colors text-center",children:"Reply"}),(0,u.jsx)("button",{className:"px-3 py-2 bg-gray-100 text-gray-700 rounded text-sm hover:bg-gray-200 transition-colors text-center",children:"Mark as Contacted"})]})]})},e.id))}),(0,u.jsxs)("div",{className:"pt-4",children:[(0,u.jsx)("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Viewing Requests"}),0===J.length?(0,u.jsx)("p",{className:"text-sm text-gray-500",children:"No viewing requests yet."}):(0,u.jsx)("div",{className:"space-y-3",children:J.map(e=>(0,u.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:(0,u.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between",children:[(0,u.jsxs)("div",{className:"flex-1",children:[(0,u.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,u.jsx)("span",{className:"text-sm font-semibold text-gray-900",children:e.userName||"Buyer"}),(0,u.jsx)("span",{className:"px-2 py-0.5 rounded-full text-xs ".concat("confirmed"===e.status?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"),children:e.status||"pending"})]}),(0,u.jsxs)("p",{className:"text-sm text-gray-700",children:["Property: ",e.propertyTitle]}),(0,u.jsxs)("p",{className:"text-xs text-gray-500",children:["Requested: ",new Date(e.requestedAt).toLocaleString()]}),(0,u.jsxs)("div",{className:"mt-2 text-sm text-gray-700",children:[(0,u.jsxs)("p",{children:["Preferred: ",e.preferredDate||"\u2014"," ",e.preferredTime||""]}),e.vendorProposalDate&&(0,u.jsxs)("p",{className:"text-blue-700",children:["Your proposal: ",e.vendorProposalDate," ",e.vendorProposalTime||""]})]})]}),(0,u.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 sm:ml-4",children:[(0,u.jsx)("button",{onClick:()=>{Z(e.id),G(""),$(""),z(!0)},className:"px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 transition-colors",children:"Propose Alternative"}),(0,u.jsx)("button",{onClick:()=>{const t=J.map(t=>t.id===e.id?(0,r.A)((0,r.A)({},t),{},{status:"confirmed"}):t);Y(t),localStorage.setItem("viewingRequests",JSON.stringify(t))},className:"px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700 transition-colors",children:"Confirm"})]})]})},e.id))})]})]}),"viewings"===q&&(0,u.jsx)(f,{}),"analytics"===q&&(0,u.jsxs)("div",{className:"space-y-6",children:[(0,u.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Property Performance Analytics"}),(0,u.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,u.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,u.jsx)("h4",{className:"font-semibold text-gray-900 mb-4",children:"Views by Property"}),(0,u.jsx)(k,{properties:R})]}),(0,u.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,u.jsx)("h4",{className:"font-semibold text-gray-900 mb-4",children:"Inquiry Conversion by Property"}),(0,u.jsx)(C,{properties:R})]})]}),(0,u.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,u.jsx)("h4",{className:"font-semibold text-gray-900 mb-4",children:"Property Performance Summary"}),(0,u.jsx)("div",{className:"overflow-x-auto",children:(0,u.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,u.jsx)("thead",{className:"bg-gray-50",children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Property"}),(0,u.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Views"}),(0,u.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Inquiries"}),(0,u.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Favorites"}),(0,u.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Conversion"})]})}),(0,u.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:R.map(e=>(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,u.jsxs)("div",{className:"flex items-center",children:[(0,u.jsx)("img",{className:"h-10 w-10 rounded-lg object-cover",src:e.image,alt:e.title}),(0,u.jsxs)("div",{className:"ml-4",children:[(0,u.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,u.jsx)("div",{className:"text-sm text-gray-500",children:e.location})]})]})}),(0,u.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.views}),(0,u.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.inquiries}),(0,u.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.favorites}),(0,u.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[(e.inquiries/e.views*100).toFixed(1),"%"]})]},e.id))})]})})]})]})]})]}),W&&(0,u.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,u.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[(0,u.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,u.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Propose Alternative Date"}),(0,u.jsx)("button",{onClick:()=>z(!1),className:"text-gray-400 hover:text-gray-600",children:(0,u.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,u.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,u.jsxs)("div",{className:"space-y-4",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),(0,u.jsx)("input",{type:"date",value:H,onChange:e=>G(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time"}),(0,u.jsx)("input",{type:"time",value:Q,onChange:e=>$(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,u.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,u.jsx)("button",{onClick:()=>z(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,u.jsx)("button",{onClick:()=>{if(!H||!Q||!K)return;const e=J.map(e=>e.id===K?(0,r.A)((0,r.A)({},e),{},{vendorProposalDate:H,vendorProposalTime:Q,status:"proposed"}):e);Y(e),localStorage.setItem("viewingRequests",JSON.stringify(e)),z(!1)},className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Send Proposal"})]})]})]})}),X&&te&&(0,u.jsx)(p,{property:te,onClose:()=>{ee(!1),setTimeout(()=>{window.location.reload()},1e3)},onSuccess:()=>{ee(!1),v.Ay.success("Verification request submitted successfully!",{icon:"\u2705"}),setTimeout(()=>{window.location.reload()},1e3)}})]})})}},5032(e,t,s){s.d(t,{FH:()=>h,HK:()=>v,Ix:()=>y,o2:()=>b});var r=s(9379),a=s(1692);const i="viewingRequests",n="inspectionActivityLog",l={totalRequests:0,pendingResponses:0,confirmed:0,vendorProposals:0,buyerReschedules:0,cancelledByBuyer:0,cancelledByVendor:0,timeline:[]},o=(e,t)=>{if("undefined"!==typeof window)if("storage"!==e)"function"===typeof window.dispatchEvent&&window.dispatchEvent(new CustomEvent(e,{detail:t}));else try{window.dispatchEvent(new StorageEvent("storage",t))}catch(s){window.dispatchEvent(new CustomEvent("storage",{detail:t}))}},d=()=>{try{return JSON.parse(localStorage.getItem(i)||"[]")}catch(e){return[]}},c=e=>{localStorage.setItem(i,JSON.stringify(e))},m=()=>{try{return JSON.parse(localStorage.getItem(n)||"[]")}catch(e){return[]}},u=(e,t)=>e||t?t?e?"".concat(e," ").concat(t):t:e:"",x=(e,t)=>{if(!e||!t)return;const s=((e,t)=>({action:e,requestId:t.id,propertyTitle:t.propertyTitle||t.projectTitle||t.projectName||t.title||"Property",buyerId:t.buyerId||t.userId,vendorId:t.vendorId,vendorEmail:t.vendorEmail,status:t.status,timestamp:(new Date).toISOString()}))(e,t),i=m();i.unshift(s),i.length>200&&i.pop(),(e=>{localStorage.setItem(n,JSON.stringify(e))})(i),o("inspectionActivity",s),o("inspectionAnalyticsUpdated",s);const l=((e,t,s)=>{const r=[],a=s.propertyTitle,i=t.buyerName||t.userName||"Buyer",n=t.vendorName||t.vendor||t.owner||"Vendor",l=u(t.preferredDate,t.preferredTime),o=u(t.confirmedDate,t.confirmedTime),d=u(t.proposedDate,t.proposedTime),c=(s,l)=>{(t.vendorId||t.vendorEmail)&&r.push({recipientId:t.vendorId,recipientEmail:t.vendorEmail,roles:["vendor"],type:e,title:s,message:l,priority:"medium",metadata:{requestId:t.id,propertyTitle:a,buyerName:i,vendorName:n}})},m=(s,l)=>{(t.buyerId||t.userId||t.buyerEmail||t.userEmail)&&r.push({recipientId:t.buyerId||t.userId,recipientEmail:t.buyerEmail||t.userEmail,roles:["buyer"],type:e,title:s,message:l,priority:"medium",metadata:{requestId:t.id,propertyTitle:a,buyerName:i,vendorName:n}})};switch(e){case"inspection_requested":c("New inspection request","".concat(i," requested to view ").concat(a," ").concat(l?"on ".concat(l):"").trim());break;case"inspection_confirmed":m("Inspection confirmed","".concat(n," confirmed ").concat(a," ").concat(o?"for ".concat(o):"").trim());break;case"vendor_proposed_new_time":m("Vendor proposed new time","".concat(n," suggested ").concat(d||"another slot"," for ").concat(a));break;case"buyer_rescheduled":c("Buyer requested new time","".concat(i," rescheduled ").concat(a," ").concat(l?"to ".concat(l):"").trim());break;case"inspection_cancelled_by_buyer":c("Inspection cancelled by buyer","".concat(i," cancelled ").concat(a));break;case"inspection_cancelled_by_vendor":m("Inspection cancelled by vendor","".concat(n," cancelled ").concat(a));break;case"inspection_declined":m("Inspection declined","".concat(n," declined the request for ").concat(a))}return r})(e,t,s);l.length&&(o("inspectionNotification",{action:e,payload:s,notifications:l,request:t}),function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!e.length||"undefined"===typeof window)return;const t=e.filter(e=>e.recipientId).map(e=>{var t;return{recipientId:e.recipientId,type:e.type,title:e.title,message:e.message,priority:e.priority||"medium",metadata:(0,r.A)((0,r.A)({},e.metadata||{}),{},{source:(null===(t=e.metadata)||void 0===t?void 0:t.source)||"inspection_client_sync"}),data:e.metadata||{}}});t.length&&a.A.createInspectionNotifications(t).then(e=>{null!==e&&void 0!==e&&e.success||console.warn("Failed to persist inspection notifications",e)}).catch(e=>{console.error("Error persisting inspection notifications:",e)})}(l))},p=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=((null===t||void 0===t?void 0:t.status)||s.status||"").toLowerCase();if(!r&&(s.proposedDate||s.proposedTime))return"vendor_proposed_new_time";switch(r){case"accepted":case"confirmed":return"inspection_confirmed";case"proposed_new_time":return"vendor_proposed_new_time";case"buyer_rescheduled":return"buyer_rescheduled";case"cancelled_by_buyer":return"inspection_cancelled_by_buyer";case"cancelled_by_vendor":return"inspection_cancelled_by_vendor";case"declined":return"inspection_declined";default:return e&&e.status!==(null===t||void 0===t?void 0:t.status)?"inspection_status_".concat((null===t||void 0===t?void 0:t.status)||"updated"):null}},g=(e,t,s)=>!(!t&&!s)&&(t&&(null===e||void 0===e?void 0:e.vendorId)===t||s&&(null===e||void 0===e?void 0:e.vendorEmail)===s),h=function(){let{role:e="buyer",userId:t,vendorId:s,vendorEmail:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("undefined"===typeof window)return(0,r.A)({},l);if("buyer"===e&&!t)return(0,r.A)({},l);if("vendor"===e&&!s&&!a)return(0,r.A)({},l);const i=d().filter(r=>{return"buyer"===e?(i=r,!!(n=t)&&((null===i||void 0===i?void 0:i.buyerId)===n||(null===i||void 0===i?void 0:i.userId)===n)):g(r,s||r.vendorId,a);var i,n}),n={totalRequests:i.length,pendingResponses:0,confirmed:0,vendorProposals:0,buyerReschedules:0,cancelledByBuyer:0,cancelledByVendor:0,timeline:[]},o=["pending","pending_vendor","pending_vendor_confirmation"],c=m();i.forEach(e=>{const t=(e.status||"").toLowerCase();o.includes(t)&&(n.pendingResponses+=1),["accepted","confirmed"].includes(t)&&(n.confirmed+=1),"proposed_new_time"===t&&(n.vendorProposals+=1),"buyer_rescheduled"===t&&(n.buyerReschedules+=1),"cancelled_by_buyer"===t&&(n.cancelledByBuyer+=1),["cancelled_by_vendor","declined"].includes(t)&&(n.cancelledByVendor+=1)});const u=Array.from({length:7}).map((r,i)=>{const n=new Date;n.setDate(n.getDate()-(6-i));const l=n.toISOString().slice(0,10),o=c.filter(r=>{return(r=>"buyer"===e?(null===r||void 0===r?void 0:r.buyerId)===t:g(r,s,a))(r)&&((i=r.timestamp)?new Date(i):new Date).toISOString().slice(0,10)===l;var i}).length;return{date:l,count:o}});return n.timeline=u,n},y=async e=>{try{console.log("Using localStorage for creating inspection requests (API unavailable)");const t=d(),s=(0,r.A)((0,r.A)({id:"viewing-".concat(Date.now())},e),{},{createdAt:(new Date).toISOString(),status:"pending"});return t.push(s),c(t),o("viewingsUpdated",{viewingRequest:s,action:"created"}),o("storage",{key:i,newValue:JSON.stringify(t)}),x("inspection_requested",s),s}catch(t){console.error("Error creating inspection request:",t);const s=d(),a=(0,r.A)((0,r.A)({id:"viewing-".concat(Date.now())},e),{},{createdAt:(new Date).toISOString(),status:"pending"});return s.push(a),c(s),o("viewingsUpdated",{viewingRequest:a,action:"created"}),o("storage",{key:i,newValue:JSON.stringify(s)}),x("inspection_requested",a),a}},b=async(e,t)=>{try{console.log("Using localStorage for inspection requests (API unavailable)");const s=d().filter(s=>e&&s.vendorId===e||t&&s.vendorEmail===t);return s.sort((e,t)=>new Date(t.createdAt||0)-new Date(e.createdAt||0)),s}catch(s){console.error("Error listing inspection requests:",s);return d().filter(s=>e&&s.vendorId===e||t&&s.vendorEmail===t).sort((e,t)=>new Date(t.createdAt||0)-new Date(e.createdAt||0))}},v=async(e,t)=>{try{console.log("Using localStorage for updating inspection requests (API unavailable)");const s=d();let a=null;const n=s.map(s=>s.id===e?(a=(0,r.A)((0,r.A)((0,r.A)({},s),t),{},{updatedAt:(new Date).toISOString()}),a):s);if(!a)return c(s),!1;c(n),o("viewingsUpdated",{requestId:e,updates:t,action:"updated"}),o("storage",{key:i,newValue:JSON.stringify(n)});const l=p(s.find(t=>t.id===e),a,t);return l&&x(l,a),!0}catch(s){console.error("Error updating inspection request:",s);const a=d();let n=null;const l=a.map(s=>s.id===e?(n=(0,r.A)((0,r.A)((0,r.A)({},s),t),{},{updatedAt:(new Date).toISOString()}),n):s);if(!n)return c(a),!1;c(l),o("viewingsUpdated",{requestId:e,updates:t,action:"updated"}),o("storage",{key:i,newValue:JSON.stringify(l)});const m=p(a.find(t=>t.id===e),n,t);return m&&x(m,n),!0}}},6809(e,t,s){s.d(t,{Ud:()=>l,hasAuthToken:()=>n});var r=s(9379);const a=async()=>(()=>{try{return localStorage.getItem("accessToken")||localStorage.getItem("token")}catch(e){return console.warn("getAuthToken: Could not read token from storage:",e),null}})(),i=async()=>{const e=await a(),t={"Content-Type":"application/json"};return e&&(t.Authorization="Bearer ".concat(e)),t},n=async()=>{const e=await a();return Boolean(e)},l=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=await i(),a=(0,r.A)((0,r.A)({},t),{},{headers:(0,r.A)((0,r.A)({},s),t.headers||{})});return fetch(e,a)}}}]);
//# sourceMappingURL=515.014953e3.chunk.js.map