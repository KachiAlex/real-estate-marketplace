"use strict";(self.webpackChunkreal_estate_marketplace=self.webpackChunkreal_estate_marketplace||[]).push([[779],{4779(e,t,s){s.r(t),s.d(t,{default:()=>x});var a=s(9379),r=s(5043),l=s(5016),n=s(3216),i=s(5369),o=s(2339),d=s(9722),c=s(1876),m=s(579);const x=()=>{var e,t,s,x,u,g,p,h,b;const{user:y}=(0,l.As)(),j=(0,n.Zp)(),[v,f]=(0,r.useState)(!0),[N,w]=(0,r.useState)(null),[A,C]=(0,r.useState)({totalApplications:0,pendingApplications:0,approvedApplications:0,rejectedApplications:0}),[k,P]=(0,r.useState)([]),[R,S]=(0,r.useState)(!1),[D,L]=(0,r.useState)(null),[_,T]=(0,r.useState)(!1),[F,I]=(0,r.useState)(null),[M,q]=(0,r.useState)(""),[Y,z]=(0,r.useState)(""),[E,B]=(0,r.useState)([""]),[O,H]=(0,r.useState)({approvedAmount:"",interestRate:"",loanTermYears:"",monthlyPayment:""}),[W,X]=(0,r.useState)(!1),[$,Q]=(0,r.useState)({name:"",description:"",minLoanAmount:"",maxLoanAmount:"",minDownPaymentPercent:"",maxLoanTerm:"",interestRate:"",interestRateType:"fixed",eligibilityCriteria:{minMonthlyIncome:"",minCreditScore:"",employmentDuration:""}});(0,r.useEffect)(()=>{y&&"mortgage_bank"===y.role?V():(o.Ay.error("Access denied. Mortgage bank account required."),j("/"))},[y,j]);const V=async()=>{try{f(!0);const e=localStorage.getItem("token"),t=await d.A.get((0,c.e9)("/mortgage-banks"),{headers:{Authorization:"Bearer ".concat(e)}});if(t.data.success&&t.data.data.length>0){const e=t.data.data.find(e=>{var t,s;return(null===(t=e.userAccount)||void 0===t?void 0:t._id)===y.id||(null===(s=e.userAccount)||void 0===s?void 0:s.id)===y.id});e?(w(e),await G(e)):o.Ay.error("Bank profile not found")}}catch(e){console.error("Error loading bank data:",e),o.Ay.error("Failed to load bank data")}finally{f(!1)}},G=async e=>{try{const e=localStorage.getItem("token"),t=await d.A.get((0,c.e9)("/mortgages"),{headers:{Authorization:"Bearer ".concat(e)}});if(t.data.success){const e=t.data.data||[];P(e),C({totalApplications:e.length,pendingApplications:e.filter(e=>"pending"===e.status||"under_review"===e.status||"needs_more_info"===e.status).length,approvedApplications:e.filter(e=>"approved"===e.status).length,rejectedApplications:e.filter(e=>"rejected"===e.status).length})}}catch(t){console.error("Error loading mortgage applications:",t)}},U=()=>{q(""),z(""),B([""]),H({approvedAmount:"",interestRate:"",loanTermYears:"",monthlyPayment:""})};if(v)return(0,m.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,m.jsxs)("div",{className:"text-center",children:[(0,m.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,m.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading dashboard..."})]})});if(!N)return(0,m.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,m.jsxs)("div",{className:"text-center",children:[(0,m.jsx)(i.ymh,{className:"text-6xl text-gray-300 mx-auto mb-4"}),(0,m.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Bank Profile Not Found"}),(0,m.jsx)("p",{className:"text-gray-600 mb-4",children:"Your bank profile could not be loaded."}),(0,m.jsx)("button",{onClick:()=>j("/mortgage-bank/register"),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700",children:"Register Bank"})]})});const Z=e=>({pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"}[e]||"bg-gray-100 text-gray-800");return(0,m.jsxs)("div",{className:"min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8",children:[(0,m.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,m.jsx)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:N.name}),(0,m.jsx)("p",{className:"text-gray-600 mt-1",children:N.fullAddress||"".concat(null===(e=N.address)||void 0===e?void 0:e.city,", ").concat(null===(t=N.address)||void 0===t?void 0:t.state)}),(0,m.jsx)("div",{className:"mt-2",children:(0,m.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ".concat(Z(N.verificationStatus)),children:"approved"===N.verificationStatus?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(i.A7C,{className:"mr-1"})," Approved"]}):"pending"===N.verificationStatus?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(i.w_X,{className:"mr-1"})," Pending Verification"]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(i._Hm,{className:"mr-1"})," Rejected"]})})})]}),(0,m.jsxs)("button",{onClick:()=>S(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,m.jsx)(i.OiG,{className:"mr-2"}),"Add Product"]})]})}),(0,m.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[(0,m.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:"Total Applications"}),(0,m.jsx)("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:A.totalApplications})]}),(0,m.jsx)(i.t69,{className:"text-blue-600 text-2xl"})]})}),(0,m.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:"Pending"}),(0,m.jsx)("p",{className:"text-2xl font-bold text-yellow-600 mt-1",children:A.pendingApplications})]}),(0,m.jsx)(i.w_X,{className:"text-yellow-600 text-2xl"})]})}),(0,m.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:"Approved"}),(0,m.jsx)("p",{className:"text-2xl font-bold text-green-600 mt-1",children:A.approvedApplications})]}),(0,m.jsx)(i.A7C,{className:"text-green-600 text-2xl"})]})}),(0,m.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:"Rejected"}),(0,m.jsx)("p",{className:"text-2xl font-bold text-red-600 mt-1",children:A.rejectedApplications})]}),(0,m.jsx)(i._Hm,{className:"text-red-600 text-2xl"})]})})]}),(0,m.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,m.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Mortgage Products"}),N.mortgageProducts&&N.mortgageProducts.length>0?(0,m.jsx)("div",{className:"space-y-4",children:N.mortgageProducts.filter(e=>e.isActive).map((e,t)=>{var s,a;return(0,m.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,m.jsx)("div",{className:"flex items-center justify-between",children:(0,m.jsxs)("div",{children:[(0,m.jsx)("h3",{className:"font-semibold text-gray-900",children:e.name}),e.description&&(0,m.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),(0,m.jsxs)("div",{className:"mt-2 grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{className:"text-gray-600",children:"Loan Range:"}),(0,m.jsxs)("p",{className:"font-medium",children:["\u20a6",null===(s=e.minLoanAmount)||void 0===s?void 0:s.toLocaleString()," - \u20a6",null===(a=e.maxLoanAmount)||void 0===a?void 0:a.toLocaleString()]})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{className:"text-gray-600",children:"Down Payment:"}),(0,m.jsxs)("p",{className:"font-medium",children:[e.minDownPaymentPercent,"%"]})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{className:"text-gray-600",children:"Term:"}),(0,m.jsxs)("p",{className:"font-medium",children:[e.maxLoanTerm," years"]})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{className:"text-gray-600",children:"Interest Rate:"}),(0,m.jsxs)("p",{className:"font-medium",children:[e.interestRate,"% (",e.interestRateType,")"]})]})]})]})})},t)})}):(0,m.jsxs)("div",{className:"text-center py-8",children:[(0,m.jsx)(i.t69,{className:"text-4xl text-gray-300 mx-auto mb-4"}),(0,m.jsx)("p",{className:"text-gray-600",children:"No mortgage products yet. Add your first product to get started."})]})]}),(0,m.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,m.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Recent Applications"}),0===k.length?(0,m.jsx)("div",{className:"text-center py-8 text-gray-600",children:(0,m.jsx)("p",{children:"No mortgage applications yet."})}):(0,m.jsx)("div",{className:"space-y-4",children:k.slice(0,5).map(e=>{var t,s,a,r;return(0,m.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 flex items-center justify-between hover:shadow-md transition-shadow cursor-pointer",onClick:()=>{L(e),T(!0)},children:[(0,m.jsxs)("div",{className:"flex-1",children:[(0,m.jsxs)("p",{className:"font-semibold text-gray-900",children:[(null===(t=e.property)||void 0===t?void 0:t.title)||"Property"," - \u20a6",e.requestedAmount.toLocaleString()]}),(0,m.jsxs)("p",{className:"text-sm text-gray-600",children:["Applicant: ",null===(s=e.buyer)||void 0===s?void 0:s.firstName," ",null===(a=e.buyer)||void 0===a?void 0:a.lastName," (",null===(r=e.buyer)||void 0===r?void 0:r.email,")"]}),(0,m.jsxs)("p",{className:"text-xs text-gray-500",children:["Status: ",(0,m.jsx)("span",{className:"font-medium capitalize",children:e.status.replace("_"," ")}),e.documents&&e.documents.length>0&&(0,m.jsxs)("span",{className:"ml-2 text-blue-600",children:["\u2022 ",e.documents.length," document",e.documents.length>1?"s":""]})]})]}),(0,m.jsx)("button",{onClick:t=>{t.stopPropagation(),L(e),T(!0)},className:"ml-4 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm",children:"View Details"})]},e._id)})})]})]}),R&&(0,m.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,m.jsxs)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto p-6",children:[(0,m.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Add Mortgage Product"}),(0,m.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),N)try{const e=localStorage.getItem("token");(await d.A.post((0,c.e9)("/mortgage-banks/".concat(N._id,"/products")),{name:$.name,description:$.description,minLoanAmount:parseFloat($.minLoanAmount),maxLoanAmount:parseFloat($.maxLoanAmount),minDownPaymentPercent:parseFloat($.minDownPaymentPercent),maxLoanTerm:parseFloat($.maxLoanTerm),interestRate:parseFloat($.interestRate),interestRateType:$.interestRateType,eligibilityCriteria:{minMonthlyIncome:parseFloat($.eligibilityCriteria.minMonthlyIncome)||0,minCreditScore:parseFloat($.eligibilityCriteria.minCreditScore)||0,employmentDuration:parseFloat($.eligibilityCriteria.employmentDuration)||0}},{headers:{Authorization:"Bearer ".concat(e)}})).data.success&&(o.Ay.success("Mortgage product added successfully!"),S(!1),Q({name:"",description:"",minLoanAmount:"",maxLoanAmount:"",minDownPaymentPercent:"",maxLoanTerm:"",interestRate:"",interestRateType:"fixed",eligibilityCriteria:{minMonthlyIncome:"",minCreditScore:"",employmentDuration:""}}),V())}catch(a){var t,s;console.error("Error adding product:",a),o.Ay.error((null===(t=a.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||"Failed to add product")}},children:[(0,m.jsxs)("div",{className:"space-y-4",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Name *"}),(0,m.jsx)("input",{type:"text",required:!0,value:$.name,onChange:e=>Q((0,a.A)((0,a.A)({},$),{},{name:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Standard 20-Year Fixed"})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,m.jsx)("textarea",{value:$.description,onChange:e=>Q((0,a.A)((0,a.A)({},$),{},{description:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:"3"})]}),(0,m.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Min Loan Amount (\u20a6) *"}),(0,m.jsx)("input",{type:"number",required:!0,value:$.minLoanAmount,onChange:e=>Q((0,a.A)((0,a.A)({},$),{},{minLoanAmount:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Loan Amount (\u20a6) *"}),(0,m.jsx)("input",{type:"number",required:!0,value:$.maxLoanAmount,onChange:e=>Q((0,a.A)((0,a.A)({},$),{},{maxLoanAmount:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),(0,m.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Down Payment % *"}),(0,m.jsx)("input",{type:"number",required:!0,min:"0",max:"100",value:$.minDownPaymentPercent,onChange:e=>Q((0,a.A)((0,a.A)({},$),{},{minDownPaymentPercent:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Loan Term (years) *"}),(0,m.jsx)("input",{type:"number",required:!0,min:"1",max:"30",value:$.maxLoanTerm,onChange:e=>Q((0,a.A)((0,a.A)({},$),{},{maxLoanTerm:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),(0,m.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Interest Rate (%) *"}),(0,m.jsx)("input",{type:"number",required:!0,step:"0.1",value:$.interestRate,onChange:e=>Q((0,a.A)((0,a.A)({},$),{},{interestRate:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rate Type *"}),(0,m.jsxs)("select",{value:$.interestRateType,onChange:e=>Q((0,a.A)((0,a.A)({},$),{},{interestRateType:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[(0,m.jsx)("option",{value:"fixed",children:"Fixed"}),(0,m.jsx)("option",{value:"variable",children:"Variable"}),(0,m.jsx)("option",{value:"adjustable",children:"Adjustable"})]})]})]}),(0,m.jsxs)("div",{className:"border-t pt-4",children:[(0,m.jsx)("h3",{className:"font-medium text-gray-900 mb-3",children:"Eligibility Criteria (Optional)"}),(0,m.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Min Monthly Income (\u20a6)"}),(0,m.jsx)("input",{type:"number",value:$.eligibilityCriteria.minMonthlyIncome,onChange:e=>Q((0,a.A)((0,a.A)({},$),{},{eligibilityCriteria:(0,a.A)((0,a.A)({},$.eligibilityCriteria),{},{minMonthlyIncome:e.target.value})})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Min Credit Score"}),(0,m.jsx)("input",{type:"number",min:"0",max:"1000",value:$.eligibilityCriteria.minCreditScore,onChange:e=>Q((0,a.A)((0,a.A)({},$),{},{eligibilityCriteria:(0,a.A)((0,a.A)({},$.eligibilityCriteria),{},{minCreditScore:e.target.value})})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employment Duration (months)"}),(0,m.jsx)("input",{type:"number",value:$.eligibilityCriteria.employmentDuration,onChange:e=>Q((0,a.A)((0,a.A)({},$),{},{eligibilityCriteria:(0,a.A)((0,a.A)({},$.eligibilityCriteria),{},{employmentDuration:e.target.value})})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]})]})]}),(0,m.jsxs)("div",{className:"flex justify-end mt-6 space-x-3",children:[(0,m.jsx)("button",{type:"button",onClick:()=>S(!1),className:"px-6 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",children:"Cancel"}),(0,m.jsx)("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Add Product"})]})]})]})}),_&&D&&(0,m.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,m.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,m.jsxs)("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[(0,m.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Application Details"}),(0,m.jsx)("button",{onClick:()=>{T(!1),L(null),I(null),U()},className:"text-gray-500 hover:text-gray-700",children:(0,m.jsx)(i.QCr,{className:"text-xl"})})]}),(0,m.jsxs)("div",{className:"p-6 space-y-6",children:[(0,m.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,m.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Application Overview"}),(0,m.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"text-sm text-gray-600",children:"Application ID"}),(0,m.jsx)("p",{className:"font-medium",children:D._id})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"text-sm text-gray-600",children:"Status"}),(0,m.jsx)("span",{className:"inline-block px-2 py-1 rounded text-sm font-medium ".concat(Z(D.status)),children:D.status.replace("_"," ").toUpperCase()})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"text-sm text-gray-600",children:"Property"}),(0,m.jsx)("p",{className:"font-medium",children:(null===(s=D.property)||void 0===s?void 0:s.title)||"N/A"})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"text-sm text-gray-600",children:"Loan Amount"}),(0,m.jsxs)("p",{className:"font-medium",children:["\u20a6",(null===(x=D.requestedAmount)||void 0===x?void 0:x.toLocaleString())||"0"]})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"text-sm text-gray-600",children:"Down Payment"}),(0,m.jsxs)("p",{className:"font-medium",children:["\u20a6",(null===(u=D.downPayment)||void 0===u?void 0:u.toLocaleString())||"0"]})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"text-sm text-gray-600",children:"Interest Rate"}),(0,m.jsxs)("p",{className:"font-medium",children:[D.interestRate||"0","%"]})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"text-sm text-gray-600",children:"Loan Term"}),(0,m.jsxs)("p",{className:"font-medium",children:[D.loanTermYears||"0"," years"]})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"text-sm text-gray-600",children:"Monthly Payment"}),(0,m.jsxs)("p",{className:"font-medium",children:["\u20a6",(null===(g=D.estimatedMonthlyPayment)||void 0===g?void 0:g.toLocaleString())||"0"]})]})]})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Applicant Information"}),(0,m.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,m.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"text-sm text-gray-600",children:"Name"}),(0,m.jsxs)("p",{className:"font-medium",children:[(null===(p=D.buyer)||void 0===p?void 0:p.firstName)||""," ",(null===(h=D.buyer)||void 0===h?void 0:h.lastName)||""]})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"text-sm text-gray-600",children:"Email"}),(0,m.jsx)("p",{className:"font-medium",children:(null===(b=D.buyer)||void 0===b?void 0:b.email)||"N/A"})]}),D.employmentDetails&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"text-sm text-gray-600",children:"Employment Type"}),(0,m.jsx)("p",{className:"font-medium capitalize",children:D.employmentDetails.type||"N/A"})]}),D.employmentDetails.monthlyIncome&&(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"text-sm text-gray-600",children:"Monthly Income"}),(0,m.jsxs)("p",{className:"font-medium",children:["\u20a6",D.employmentDetails.monthlyIncome.toLocaleString()]})]}),D.employmentDetails.employerName&&(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"text-sm text-gray-600",children:"Employer"}),(0,m.jsx)("p",{className:"font-medium",children:D.employmentDetails.employerName})]})]})]})})]}),D.documents&&D.documents.length>0&&(0,m.jsxs)("div",{children:[(0,m.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:["Documents (",D.documents.length,")"]}),(0,m.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:D.documents.map((e,t)=>{var s,a;const r=e.url&&(e.url.match(/\.(jpg|jpeg|png|gif|webp)$/i)||(null===(s=e.type)||void 0===s?void 0:s.toLowerCase().includes("image"))),l=e.url&&(e.url.match(/\.pdf$/i)||(null===(a=e.type)||void 0===a?void 0:a.toLowerCase().includes("pdf")));return(0,m.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[(0,m.jsx)("div",{className:"flex items-start justify-between mb-2",children:(0,m.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,m.jsx)("p",{className:"font-medium text-gray-900 truncate",children:e.name||"Document ".concat(t+1)}),(0,m.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[e.type&&(0,m.jsx)("span",{className:"capitalize",children:e.type.replace("_"," ")}),e.uploadedAt&&(0,m.jsxs)("span",{className:"ml-2",children:["\u2022 ",new Date(e.uploadedAt).toLocaleDateString()]})]})]})}),r&&e.url&&(0,m.jsx)("div",{className:"mb-3",children:(0,m.jsx)("img",{src:e.url,alt:e.name||"Document",className:"w-full h-32 object-cover rounded border border-gray-200 cursor-pointer hover:opacity-90",onClick:()=>I(e)})}),l&&e.url&&(0,m.jsxs)("div",{className:"mb-3 bg-gray-100 rounded p-4 text-center",children:[(0,m.jsx)(i.t69,{className:"text-4xl text-red-500 mx-auto mb-2"}),(0,m.jsx)("p",{className:"text-sm text-gray-600",children:"PDF Document"})]}),(0,m.jsxs)("div",{className:"flex gap-2",children:[(r||l)&&(0,m.jsxs)("button",{onClick:()=>I(e),className:"flex-1 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm flex items-center justify-center gap-2",children:[(0,m.jsx)(i.Ny1,{}),"Preview"]}),(0,m.jsxs)("a",{href:e.url,download:e.name||"document",target:"_blank",rel:"noopener noreferrer",className:"flex-1 px-3 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors text-sm flex items-center justify-center gap-2",children:[(0,m.jsx)(i.WCW,{}),"Download"]})]})]},t)})})]}),(!D.documents||0===D.documents.length)&&(0,m.jsxs)("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[(0,m.jsx)(i.t69,{className:"text-4xl text-gray-300 mx-auto mb-2"}),(0,m.jsx)("p",{className:"text-gray-600",children:"No documents uploaded for this application"})]}),("pending"===D.status||"under_review"===D.status||"needs_more_info"===D.status)&&(0,m.jsxs)("div",{className:"border-t border-gray-200 pt-6",children:[(0,m.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Review Application"}),(0,m.jsxs)("div",{className:"mb-4",children:[(0,m.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Decision ",(0,m.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,m.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,m.jsxs)("button",{type:"button",onClick:()=>{var e,t,s;(q("approved"),D.requestedAmount&&!O.approvedAmount)&&H({approvedAmount:D.requestedAmount.toString(),interestRate:(null===(e=D.interestRate)||void 0===e?void 0:e.toString())||"",loanTermYears:(null===(t=D.loanTermYears)||void 0===t?void 0:t.toString())||"",monthlyPayment:(null===(s=D.estimatedMonthlyPayment)||void 0===s?void 0:s.toString())||""})},className:"px-4 py-3 rounded-lg border-2 transition-colors ".concat("approved"===M?"border-green-600 bg-green-50 text-green-700":"border-gray-300 hover:border-green-400 text-gray-700"),children:[(0,m.jsx)(i.A7C,{className:"mx-auto mb-1"}),"Approve"]}),(0,m.jsxs)("button",{type:"button",onClick:()=>q("rejected"),className:"px-4 py-3 rounded-lg border-2 transition-colors ".concat("rejected"===M?"border-red-600 bg-red-50 text-red-700":"border-gray-300 hover:border-red-400 text-gray-700"),children:[(0,m.jsx)(i._Hm,{className:"mx-auto mb-1"}),"Reject"]}),(0,m.jsxs)("button",{type:"button",onClick:()=>q("needs_more_info"),className:"px-4 py-3 rounded-lg border-2 transition-colors ".concat("needs_more_info"===M?"border-yellow-600 bg-yellow-50 text-yellow-700":"border-gray-300 hover:border-yellow-400 text-gray-700"),children:[(0,m.jsx)(i.w_X,{className:"mx-auto mb-1"}),"Request Info"]})]})]}),(0,m.jsxs)("div",{className:"mb-4",children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Review Notes"}),(0,m.jsx)("textarea",{value:Y,onChange:e=>z(e.target.value),rows:4,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your review notes, feedback, or additional comments..."})]}),("approved"===M||"needs_more_info"===M)&&(0,m.jsxs)("div",{className:"mb-4",children:[(0,m.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Conditions ","approved"===M?"(Optional)":"(Required)"]}),(0,m.jsxs)("div",{className:"space-y-2",children:[E.map((e,t)=>(0,m.jsxs)("div",{className:"flex gap-2",children:[(0,m.jsx)("input",{type:"text",value:e,onChange:e=>((e,t)=>{const s=[...E];s[e]=t,B(s)})(t,e.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Condition ".concat(t+1," (e.g., Provide property insurance, Complete credit check...)")}),E.length>1&&(0,m.jsx)("button",{type:"button",onClick:()=>(e=>{B(E.filter((t,s)=>s!==e))})(t),className:"px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg",children:(0,m.jsx)(i.QCr,{})})]},t)),(0,m.jsx)("button",{type:"button",onClick:()=>{B([...E,""])},className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"+ Add Another Condition"})]})]}),"approved"===M&&(0,m.jsxs)("div",{className:"mb-4 bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,m.jsx)("h4",{className:"text-sm font-semibold text-green-900 mb-3",children:"Approved Loan Terms"}),(0,m.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Approved Amount ",(0,m.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,m.jsx)("input",{type:"number",value:O.approvedAmount,onChange:e=>H((0,a.A)((0,a.A)({},O),{},{approvedAmount:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Amount in NGN",required:!0})]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Interest Rate (%) ",(0,m.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,m.jsx)("input",{type:"number",step:"0.01",value:O.interestRate,onChange:e=>H((0,a.A)((0,a.A)({},O),{},{interestRate:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"e.g., 18.5",required:!0})]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Loan Term (Years) ",(0,m.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,m.jsx)("input",{type:"number",value:O.loanTermYears,onChange:e=>H((0,a.A)((0,a.A)({},O),{},{loanTermYears:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"e.g., 25",required:!0})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monthly Payment (Optional)"}),(0,m.jsx)("input",{type:"number",value:O.monthlyPayment,onChange:e=>H((0,a.A)((0,a.A)({},O),{},{monthlyPayment:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Auto-calculated if empty"})]})]})]}),D.bankReview&&(0,m.jsxs)("div",{className:"mb-4 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,m.jsx)("h4",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Previous Review"}),(0,m.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{className:"font-medium",children:"Decision:"})," ",(0,m.jsx)("span",{className:"capitalize",children:D.bankReview.decision||"N/A"})]}),D.bankReview.notes&&(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{className:"font-medium",children:"Notes:"})," ",(0,m.jsx)("span",{children:D.bankReview.notes})]}),D.bankReview.conditions&&D.bankReview.conditions.length>0&&(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{className:"font-medium",children:"Conditions:"}),(0,m.jsx)("ul",{className:"list-disc list-inside mt-1 ml-2",children:D.bankReview.conditions.map((e,t)=>(0,m.jsx)("li",{children:e},t))})]}),D.bankReview.reviewedAt&&(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{className:"font-medium",children:"Reviewed At:"})," ",(0,m.jsx)("span",{children:new Date(D.bankReview.reviewedAt).toLocaleString()})]})]})]}),(0,m.jsxs)("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[(0,m.jsx)("button",{type:"button",onClick:()=>{U()},className:"px-6 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",disabled:W,children:"Reset"}),(0,m.jsx)("button",{type:"button",onClick:async()=>{if(D&&M)if("approved"!==M||O.approvedAmount&&O.interestRate&&O.loanTermYears){X(!0);try{const e=localStorage.getItem("token");(await d.A.put((0,c.e9)("/mortgages/".concat(D._id,"/review")),{decision:M,notes:Y.trim()||void 0,conditions:E.filter(e=>e.trim()).length>0?E.filter(e=>e.trim()):void 0,loanTerms:"approved"===M?{approvedAmount:parseFloat(O.approvedAmount),interestRate:parseFloat(O.interestRate),loanTermYears:parseFloat(O.loanTermYears),monthlyPayment:O.monthlyPayment?parseFloat(O.monthlyPayment):void 0}:void 0},{headers:{Authorization:"Bearer ".concat(e)}})).data.success&&(o.Ay.success("Application ".concat(M," successfully!")),U(),await G(N),setTimeout(()=>{T(!1),L(null)},1500))}catch(s){var e,t;console.error("Error reviewing application:",s),o.Ay.error((null===(e=s.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to submit review")}finally{X(!1)}}else o.Ay.error("Please fill in all loan terms for approval");else o.Ay.error("Please select a decision")},disabled:W||!M,className:"px-6 py-2 rounded-lg transition-colors flex items-center gap-2 ".concat("approved"===M?"bg-green-600 hover:bg-green-700 text-white":"rejected"===M?"bg-red-600 hover:bg-red-700 text-white":"needs_more_info"===M?"bg-yellow-600 hover:bg-yellow-700 text-white":"bg-gray-400 text-gray-200 cursor-not-allowed"),children:W?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,m.jsx)("span",{children:"Submitting..."})]}):(0,m.jsxs)(m.Fragment,{children:["approved"===M&&(0,m.jsx)(i.A7C,{}),"rejected"===M&&(0,m.jsx)(i._Hm,{}),"needs_more_info"===M&&(0,m.jsx)(i.w_X,{}),(0,m.jsx)("span",{children:"Submit Review"})]})})]})]})]})]})}),F&&(0,m.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center p-4 z-[60]",children:(0,m.jsxs)("div",{className:"relative max-w-6xl w-full max-h-full",children:[(0,m.jsx)("button",{onClick:()=>I(null),className:"absolute top-4 right-4 p-2 bg-white bg-opacity-90 rounded-full hover:bg-opacity-100 transition-all z-10",children:(0,m.jsx)(i.QCr,{className:"text-gray-700 text-xl"})}),F.url&&(0,m.jsx)(m.Fragment,{children:F.url.match(/\.(jpg|jpeg|png|gif|webp)$/i)?(0,m.jsx)("img",{src:F.url,alt:F.name||"Preview",className:"max-w-full max-h-[90vh] object-contain mx-auto rounded-lg"}):F.url.match(/\.pdf$/i)?(0,m.jsx)("iframe",{src:F.url,className:"w-full h-[90vh] border-0 rounded-lg bg-white",title:F.name||"PDF Preview"}):(0,m.jsxs)("div",{className:"bg-white rounded-lg p-8 max-w-md mx-auto",children:[(0,m.jsx)(i.t69,{className:"text-gray-400 text-6xl mx-auto mb-4"}),(0,m.jsx)("h3",{className:"text-lg font-medium text-gray-900 text-center mb-2",children:F.name||"Document"}),(0,m.jsx)("p",{className:"text-sm text-gray-500 text-center mb-4",children:"Preview not available for this file type"}),(0,m.jsxs)("a",{href:F.url,download:F.name,target:"_blank",rel:"noopener noreferrer",className:"block w-full text-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[(0,m.jsx)(i.WCW,{className:"inline mr-2"}),"Download File"]})]})}),F.name&&(0,m.jsx)("div",{className:"absolute bottom-4 left-4 right-4 bg-black bg-opacity-50 text-white p-3 rounded-lg text-center",children:(0,m.jsx)("p",{className:"text-sm font-medium",children:F.name})})]})})]})}}}]);
//# sourceMappingURL=779.a254535b.chunk.js.map