{"version":3,"file":"static/js/745.4d7a9bc7.chunk.js","mappings":"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","sources":["pages/VendorInspectionRequests.js","services/inspectionService.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\nimport { useAuth } from '../contexts/AuthContext';\nimport { listInspectionRequestsByVendor, updateInspectionRequest } from '../services/inspectionService';\nimport toast from 'react-hot-toast';\n\nconst VendorInspectionRequests = () => {\n  const { user } = useAuth();\n  const [requests, setRequests] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [showProposeModal, setShowProposeModal] = useState(false);\n  const [requestToRespond, setRequestToRespond] = useState(null);\n  const [proposalDate, setProposalDate] = useState('');\n  const [proposalTime, setProposalTime] = useState('');\n  const prevStatusRef = useRef({});\n\n  const ensureNotificationPermission = async () => {\n    try {\n      if (!('Notification' in window)) return;\n      if (Notification.permission === 'default') {\n        await Notification.requestPermission();\n      }\n    } catch (e) {}\n  };\n\n  const showWebNotification = (title, options = {}) => {\n    try {\n      if (!('Notification' in window)) return;\n      if (Notification.permission === 'granted') new Notification(title, options);\n    } catch (e) {}\n  };\n\n  const toDateTime = (dateStr, timeStr) => {\n    try { return new Date(`${dateStr}T${timeStr}:00`); } catch { return null; }\n  };\n\n  const buildCalendar = (r) => {\n    const title = `Property Inspection - ${r.projectName}`;\n    const start = r.confirmedDate && r.confirmedTime ? toDateTime(r.confirmedDate, r.confirmedTime) : toDateTime(r.preferredDate, r.preferredTime);\n    const end = start ? new Date(start.getTime() + 60 * 60 * 1000) : null; // 1 hour duration\n    const details = `Inspection with ${r.buyerName || 'buyer'} at ${r.projectLocation || ''}`;\n    const location = r.projectLocation || '';\n    return { title, start, end, details, location };\n  };\n\n  const formatDateICS = (d) => {\n    const pad = (n) => String(n).padStart(2, '0');\n    return `${d.getUTCFullYear()}${pad(d.getUTCMonth()+1)}${pad(d.getUTCDate())}T${pad(d.getUTCHours())}${pad(d.getUTCMinutes())}00Z`;\n  };\n\n  const downloadICS = (r) => {\n    const { title, start, end, details, location } = buildCalendar(r);\n    if (!start || !end) { toast.error('Invalid date/time'); return; }\n    const ics = [\n      'BEGIN:VCALENDAR','VERSION:2.0','PRODID:-//PropertyArk//Inspection//EN','BEGIN:VEVENT',\n      `UID:${r.id}@propertyark`,`DTSTAMP:${formatDateICS(new Date())}`,\n      `DTSTART:${formatDateICS(start)}`,`DTEND:${formatDateICS(end)}`,\n      `SUMMARY:${title}`,`DESCRIPTION:${details}`,`LOCATION:${location}`,'END:VEVENT','END:VCALENDAR'\n    ].join('\\r\\n');\n    const blob = new Blob([ics], { type: 'text/calendar;charset=utf-8' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url; a.download = `inspection-${r.id}.ics`; document.body.appendChild(a); a.click(); document.body.removeChild(a); URL.revokeObjectURL(url);\n  };\n\n  const openGoogleCalendar = (r) => {\n    const { title, start, end, details, location } = buildCalendar(r);\n    if (!start || !end) { toast.error('Invalid date/time'); return; }\n    const fmt = (d) => `${d.getUTCFullYear()}${String(d.getUTCMonth()+1).padStart(2,'0')}${String(d.getUTCDate()).padStart(2,'0')}T${String(d.getUTCHours()).padStart(2,'0')}${String(d.getUTCMinutes()).padStart(2,'0')}00Z`;\n    const text = encodeURIComponent(title);\n    const dates = `${fmt(start)}/${fmt(end)}`;\n    const detailsEnc = encodeURIComponent(details);\n    const locationEnc = encodeURIComponent(location);\n    const url = `https://www.google.com/calendar/render?action=TEMPLATE&text=${text}&dates=${dates}&details=${detailsEnc}&location=${locationEnc}`;\n    window.open(url, '_blank');\n  };\n\n  const load = async () => {\n    try {\n      setLoading(true);\n      const data = await listInspectionRequestsByVendor(user?.id, user?.email);\n      setRequests(data);\n    } catch (e) {\n      console.error(e);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    load();\n    if (!user?.id && !user?.email) return;\n    \n    // Poll for updates every 5 seconds as fallback to real-time\n    const pollInterval = setInterval(() => {\n      load();\n    }, 5000);\n    \n    // Initial data load with change detection for notifications\n    (async () => {\n      try {\n        const data = await listInspectionRequestsByVendor(user?.id, user?.email);\n        setRequests(data);\n        \n        // Check for status changes and show notifications\n        ensureNotificationPermission();\n        const prev = prevStatusRef.current || {};\n        for (const r of data) {\n          const previous = prev[r.id];\n          if (previous && previous !== r.status) {\n            if (r.status === 'accepted') {\n              toast.success(`Inspection accepted for ${r.projectName}`);\n              if (r.confirmedDate && r.confirmedTime) {\n                showWebNotification('Inspection accepted', { body: `${r.projectName} on ${r.confirmedDate} ${r.confirmedTime}` });\n              }\n            } else if (r.status === 'proposed_new_time') {\n              toast('Proposed a new time to buyer', { icon: '✓' });\n            } else if (r.status === 'declined') {\n              toast.error(`Inspection declined for ${r.projectName}`);\n            }\n          }\n        }\n        prevStatusRef.current = Object.fromEntries(data.map(x => [x.id, x.status]));\n      } catch (e) {\n        console.error('Error loading inspection requests:', e);\n      }\n    })();\n    \n    return () => clearInterval(pollInterval);\n    // eslint-disable-next-line react-hooks/exhaustive-deps     \n  }, [user?.id, user?.email]);\n\n  const accept = async (req) => {\n    const ok = await updateInspectionRequest(req.id, {\n      status: 'accepted',\n      confirmedDate: req.preferredDate,\n      confirmedTime: req.preferredTime\n    });\n    if (ok) {\n      toast.success('Accepted');\n      load();\n    } else {\n      toast.error('Failed to accept');\n    }\n  };\n\n  const decline = async (req) => {\n    const ok = await updateInspectionRequest(req.id, { status: 'declined' });\n    if (ok) {\n      toast.success('Declined');\n      load();\n    } else {\n      toast.error('Failed to decline');\n    }\n  };\n\n  const openPropose = (req) => {\n    setRequestToRespond(req);\n    setProposalDate('');\n    setProposalTime('');\n    setShowProposeModal(true);\n  };\n\n  const sendProposal = async () => {\n    if (!proposalDate || !proposalTime || !requestToRespond) {\n      toast.error('Provide date and time');\n      return;\n    }\n    const ok = await updateInspectionRequest(requestToRespond.id, {\n      status: 'proposed_new_time',\n      proposedDate: proposalDate,\n      proposedTime: proposalTime\n    });\n    if (ok) {\n      toast.success('Proposed new time');\n      setShowProposeModal(false);\n      setRequestToRespond(null);\n      load();\n    } else {\n      toast.error('Failed to propose');\n    }\n  };\n\n  return (\n    <div className=\"p-6\">\n      <div className=\"mb-6\">\n        <h1 className=\"text-2xl font-bold text-gray-900\">Inspection Requests</h1>\n        <p className=\"text-gray-600\">All viewing requests for your listed properties</p>\n      </div>\n\n      <div className=\"bg-white rounded-lg shadow\">\n        <div className=\"p-4 border-b border-gray-200 flex items-center justify-between\">\n          <div className=\"text-sm text-gray-600\">{loading ? 'Loading...' : `${requests.length} request(s)`}</div>\n          <button onClick={load} className=\"btn-outline text-sm\">Refresh</button>\n        </div>\n        <div className=\"divide-y\">\n          {!loading && requests.length === 0 && (\n            <div className=\"p-6 text-sm text-gray-600\">No inspection requests yet.</div>\n          )}\n          {requests.map((r) => (\n            <div key={r.id} className=\"p-4 flex items-center text-sm\">\n              <div className=\"w-1/5\">\n                <div className=\"font-medium text-gray-900\">{r.projectName}</div>\n                <div className=\"text-gray-600\">{r.projectLocation}</div>\n              </div>\n              <div className=\"w-1/5\">\n                <div className=\"font-medium text-gray-900\">{r.buyerName || 'Unknown'}</div>\n                <div className=\"text-gray-600\">{r.buyerEmail || ''}</div>\n              </div>\n              <div className=\"w-1/5\">\n                <div>{r.preferredDate} {r.preferredTime}</div>\n                {r.proposedDate && r.proposedTime && (\n                  <div className=\"text-xs text-gray-600\">Proposed: {r.proposedDate} {r.proposedTime}</div>\n                )}\n              </div>\n              <div className=\"w-1/5\">\n                <span className={`px-2 py-1 rounded-full text-xs ${\n                  r.status === 'pending_vendor' ? 'bg-yellow-100 text-yellow-800' :\n                  r.status === 'accepted' ? 'bg-green-100 text-green-800' :\n                  r.status === 'proposed_new_time' ? 'bg-blue-100 text-blue-800' :\n                  'bg-red-100 text-red-800'\n                }`}>\n                  {r.status?.replaceAll('_',' ') || 'pending'}\n                </span>\n              </div>\n              <div className=\"w-1/5 flex flex-wrap gap-2\">\n                {r.status !== 'accepted' && (\n                  <button onClick={() => accept(r)} className=\"px-3 py-1 bg-green-600 text-white rounded\">Accept</button>\n                )}\n                <button onClick={() => openPropose(r)} className=\"px-3 py-1 bg-blue-600 text-white rounded\">Propose</button>\n                {r.status !== 'declined' && (\n                  <button onClick={() => decline(r)} className=\"px-3 py-1 bg-red-600 text-white rounded\">Decline</button>\n                )}\n                {r.status === 'accepted' && (\n                  <>\n                    <button onClick={() => openGoogleCalendar(r)} className=\"px-3 py-1 bg-gray-800 text-white rounded\">Google Calendar</button>\n                    <button onClick={() => downloadICS(r)} className=\"px-3 py-1 border rounded\">Download .ics</button>\n                  </>\n                )}\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n\n      {showProposeModal && requestToRespond && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\n          <div className=\"bg-white rounded-lg max-w-md w-full p-6\">\n            <div className=\"flex items-start justify-between mb-4\">\n              <h3 className=\"text-lg font-bold text-gray-900\">Propose New Time</h3>\n              <button onClick={() => setShowProposeModal(false)} className=\"text-gray-500 hover:text-gray-700\">×</button>\n            </div>\n            <div className=\"bg-gray-50 border border-gray-200 rounded-lg p-4 mb-4 text-sm\">\n              <p className=\"font-semibold\">{requestToRespond.projectName}</p>\n              <p className=\"text-gray-600\">Buyer: {requestToRespond.buyerName || 'Unknown'}</p>\n              <p className=\"text-gray-600\">Preferred: {requestToRespond.preferredDate} {requestToRespond.preferredTime}</p>\n            </div>\n            <div className=\"grid grid-cols-1 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">New date</label>\n                <input type=\"date\" value={proposalDate} onChange={(e) => setProposalDate(e.target.value)} className=\"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500\" />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">New time</label>\n                <input type=\"time\" value={proposalTime} onChange={(e) => setProposalTime(e.target.value)} className=\"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500\" />\n              </div>\n            </div>\n            <div className=\"flex justify-between mt-6\">\n              <button onClick={() => setShowProposeModal(false)} className=\"px-5 py-2 border rounded-lg\">Cancel</button>\n              <button onClick={sendProposal} disabled={!proposalDate || !proposalTime} className=\"px-5 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50\">Send Proposal</button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default VendorInspectionRequests;\n\n\n\n\n\n","import notificationService from './notificationService';\r\n\r\nconst COLLECTION = 'inspectionRequests';\r\nconst VIEWING_REQUESTS_KEY = 'viewingRequests';\r\nconst INSPECTION_ACTIVITY_KEY = 'inspectionActivityLog';\r\nconst ANALYTICS_EVENT = 'inspectionAnalyticsUpdated';\r\nconst ACTIVITY_EVENT = 'inspectionActivity';\r\n\r\nconst defaultAnalytics = {\r\n  totalRequests: 0,\r\n  pendingResponses: 0,\r\n  confirmed: 0,\r\n  vendorProposals: 0,\r\n  buyerReschedules: 0,\r\n  cancelledByBuyer: 0,\r\n  cancelledByVendor: 0,\r\n  timeline: []\r\n};\r\n\r\nconst safeWindowDispatch = (eventName, detail) => {\r\n  if (typeof window === 'undefined') return;\r\n  if (eventName === 'storage') {\r\n    try {\r\n      window.dispatchEvent(new StorageEvent('storage', detail));\r\n    } catch {\r\n      window.dispatchEvent(new CustomEvent('storage', { detail }));\r\n    }\r\n    return;\r\n  }\r\n  if (typeof window.dispatchEvent === 'function') {\r\n    window.dispatchEvent(new CustomEvent(eventName, { detail }));\r\n  }\r\n};\r\n\r\nconst getStoredRequests = () => {\r\n  try {\r\n    return JSON.parse(localStorage.getItem(VIEWING_REQUESTS_KEY) || '[]');\r\n  } catch {\r\n    return [];\r\n  }\r\n};\r\n\r\nconst saveStoredRequests = (requests) => {\r\n  localStorage.setItem(VIEWING_REQUESTS_KEY, JSON.stringify(requests));\r\n};\r\n\r\nconst getActivityLog = () => {\r\n  try {\r\n    return JSON.parse(localStorage.getItem(INSPECTION_ACTIVITY_KEY) || '[]');\r\n  } catch {\r\n    return [];\r\n  }\r\n};\r\n\r\nconst saveActivityLog = (log) => {\r\n  localStorage.setItem(INSPECTION_ACTIVITY_KEY, JSON.stringify(log));\r\n};\r\n\r\nconst buildActivityPayload = (action, request) => ({\r\n  action,\r\n  requestId: request.id,\r\n  propertyTitle: request.propertyTitle || request.projectTitle || request.projectName || request.title || 'Property',\r\n  buyerId: request.buyerId || request.userId,\r\n  vendorId: request.vendorId,\r\n  vendorEmail: request.vendorEmail,\r\n  status: request.status,\r\n  timestamp: new Date().toISOString()\r\n});\r\n\r\nconst formatDateTimeLabel = (date, time) => {\r\n  if (!date && !time) return '';\r\n  if (!time) return date;\r\n  if (!date) return time;\r\n  return `${date} ${time}`;\r\n};\r\n\r\nconst buildInspectionNotificationEntries = (action, request, payload) => {\r\n  const entries = [];\r\n  const propertyTitle = payload.propertyTitle;\r\n  const buyerName = request.buyerName || request.userName || 'Buyer';\r\n  const vendorName = request.vendorName || request.vendor || request.owner || 'Vendor';\r\n  const preferredLabel = formatDateTimeLabel(request.preferredDate, request.preferredTime);\r\n  const confirmedLabel = formatDateTimeLabel(request.confirmedDate, request.confirmedTime);\r\n  const proposedLabel = formatDateTimeLabel(request.proposedDate, request.proposedTime);\r\n\r\n  const pushForVendor = (title, message) => {\r\n    if (request.vendorId || request.vendorEmail) {\r\n      entries.push({\r\n        recipientId: request.vendorId,\r\n        recipientEmail: request.vendorEmail,\r\n        roles: ['vendor'],\r\n        type: action,\r\n        title,\r\n        message,\r\n        priority: 'medium',\r\n        metadata: { requestId: request.id, propertyTitle, buyerName, vendorName }\r\n      });\r\n    }\r\n  };\r\n\r\n  const pushForBuyer = (title, message) => {\r\n    if (request.buyerId || request.userId || request.buyerEmail || request.userEmail) {\r\n      entries.push({\r\n        recipientId: request.buyerId || request.userId,\r\n        recipientEmail: request.buyerEmail || request.userEmail,\r\n        roles: ['buyer'],\r\n        type: action,\r\n        title,\r\n        message,\r\n        priority: 'medium',\r\n        metadata: { requestId: request.id, propertyTitle, buyerName, vendorName }\r\n      });\r\n    }\r\n  };\r\n\r\n  switch (action) {\r\n    case 'inspection_requested':\r\n      pushForVendor('New inspection request', `${buyerName} requested to view ${propertyTitle} ${preferredLabel ? `on ${preferredLabel}` : ''}`.trim());\r\n      break;\r\n    case 'inspection_confirmed':\r\n      pushForBuyer('Inspection confirmed', `${vendorName} confirmed ${propertyTitle} ${confirmedLabel ? `for ${confirmedLabel}` : ''}`.trim());\r\n      break;\r\n    case 'vendor_proposed_new_time':\r\n      pushForBuyer('Vendor proposed new time', `${vendorName} suggested ${proposedLabel || 'another slot'} for ${propertyTitle}`);\r\n      break;\r\n    case 'buyer_rescheduled':\r\n      pushForVendor('Buyer requested new time', `${buyerName} rescheduled ${propertyTitle} ${preferredLabel ? `to ${preferredLabel}` : ''}`.trim());\r\n      break;\r\n    case 'inspection_cancelled_by_buyer':\r\n      pushForVendor('Inspection cancelled by buyer', `${buyerName} cancelled ${propertyTitle}`);\r\n      break;\r\n    case 'inspection_cancelled_by_vendor':\r\n      pushForBuyer('Inspection cancelled by vendor', `${vendorName} cancelled ${propertyTitle}`);\r\n      break;\r\n    case 'inspection_declined':\r\n      pushForBuyer('Inspection declined', `${vendorName} declined the request for ${propertyTitle}`);\r\n      break;\r\n    default:\r\n      break;\r\n  }\r\n\r\n  return entries;\r\n};\r\n\r\nconst persistInspectionNotifications = (entries = []) => {\r\n  if (!entries.length || typeof window === 'undefined') return;\r\n  const payloads = entries\r\n    .filter((entry) => entry.recipientId)\r\n    .map((entry) => ({\r\n      recipientId: entry.recipientId,\r\n      type: entry.type,\r\n      title: entry.title,\r\n      message: entry.message,\r\n      priority: entry.priority || 'medium',\r\n      metadata: {\r\n        ...(entry.metadata || {}),\r\n        source: entry.metadata?.source || 'inspection_client_sync'\r\n      },\r\n      data: entry.metadata || {}\r\n    }));\r\n\r\n  if (!payloads.length) return;\r\n\r\n  notificationService.createInspectionNotifications(payloads)\r\n    .then((result) => {\r\n      if (!result?.success) {\r\n        console.warn('Failed to persist inspection notifications', result);\r\n      }\r\n    })\r\n    .catch((error) => {\r\n      console.error('Error persisting inspection notifications:', error);\r\n    });\r\n};\r\n\r\nconst logInspectionActivity = (action, request) => {\r\n  if (!action || !request) return;\r\n  const payload = buildActivityPayload(action, request);\r\n  const log = getActivityLog();\r\n  log.unshift(payload);\r\n  if (log.length > 200) {\r\n    log.pop();\r\n  }\r\n  saveActivityLog(log);\r\n  safeWindowDispatch(ACTIVITY_EVENT, payload);\r\n  safeWindowDispatch(ANALYTICS_EVENT, payload);\r\n  const notifications = buildInspectionNotificationEntries(action, request, payload);\r\n  if (notifications.length) {\r\n    safeWindowDispatch('inspectionNotification', { action, payload, notifications, request });\r\n    persistInspectionNotifications(notifications);\r\n  }\r\n};\r\n\r\nconst deriveActionFromStatus = (previous, next, updates = {}) => {\r\n  const status = (next?.status || updates.status || '').toLowerCase();\r\n  if (!status && (updates.proposedDate || updates.proposedTime)) {\r\n    return 'vendor_proposed_new_time';\r\n  }\r\n  switch (status) {\r\n    case 'accepted':\r\n    case 'confirmed':\r\n      return 'inspection_confirmed';\r\n    case 'proposed_new_time':\r\n      return 'vendor_proposed_new_time';\r\n    case 'buyer_rescheduled':\r\n      return 'buyer_rescheduled';\r\n    case 'cancelled_by_buyer':\r\n      return 'inspection_cancelled_by_buyer';\r\n    case 'cancelled_by_vendor':\r\n      return 'inspection_cancelled_by_vendor';\r\n    case 'declined':\r\n      return 'inspection_declined';\r\n    default:\r\n      if (previous && previous.status !== next?.status) {\r\n        return `inspection_status_${next?.status || 'updated'}`;\r\n      }\r\n      return null;\r\n  }\r\n};\r\n\r\nconst getDateKey = (isoDate) => {\r\n  const date = isoDate ? new Date(isoDate) : new Date();\r\n  return date.toISOString().slice(0, 10);\r\n};\r\n\r\nconst matchesBuyer = (request, buyerId) => {\r\n  if (!buyerId) return false;\r\n  return request?.buyerId === buyerId || request?.userId === buyerId;\r\n};\r\n\r\nconst matchesVendor = (request, vendorId, vendorEmail) => {\r\n  if (!vendorId && !vendorEmail) return false;\r\n  return (vendorId && request?.vendorId === vendorId) || (vendorEmail && request?.vendorEmail === vendorEmail);\r\n};\r\n\r\nexport const getInspectionAnalytics = ({ role = 'buyer', userId, vendorId, vendorEmail } = {}) => {\r\n  if (typeof window === 'undefined') return { ...defaultAnalytics };\r\n  if (role === 'buyer' && !userId) return { ...defaultAnalytics };\r\n  if (role === 'vendor' && !vendorId && !vendorEmail) return { ...defaultAnalytics };\r\n\r\n  const requests = getStoredRequests();\r\n  const relevant = requests.filter((req) =>\r\n    role === 'buyer' ? matchesBuyer(req, userId) : matchesVendor(req, vendorId || req.vendorId, vendorEmail)\r\n  );\r\n\r\n  const analytics = {\r\n    totalRequests: relevant.length,\r\n    pendingResponses: 0,\r\n    confirmed: 0,\r\n    vendorProposals: 0,\r\n    buyerReschedules: 0,\r\n    cancelledByBuyer: 0,\r\n    cancelledByVendor: 0,\r\n    timeline: []\r\n  };\r\n\r\n  const pendingStatuses = ['pending', 'pending_vendor', 'pending_vendor_confirmation'];\r\n  const log = getActivityLog();\r\n  const activityFilter = (entry) =>\r\n    role === 'buyer' ? entry?.buyerId === userId : matchesVendor(entry, vendorId, vendorEmail);\r\n\r\n  relevant.forEach((req) => {\r\n    const status = (req.status || '').toLowerCase();\r\n    if (pendingStatuses.includes(status)) {\r\n      analytics.pendingResponses += 1;\r\n    }\r\n    if (['accepted', 'confirmed'].includes(status)) {\r\n      analytics.confirmed += 1;\r\n    }\r\n    if (status === 'proposed_new_time') {\r\n      analytics.vendorProposals += 1;\r\n    }\r\n    if (status === 'buyer_rescheduled') {\r\n      analytics.buyerReschedules += 1;\r\n    }\r\n    if (status === 'cancelled_by_buyer') {\r\n      analytics.cancelledByBuyer += 1;\r\n    }\r\n    if (['cancelled_by_vendor', 'declined'].includes(status)) {\r\n      analytics.cancelledByVendor += 1;\r\n    }\r\n  });\r\n\r\n  const lastSevenDays = Array.from({ length: 7 }).map((_, idx) => {\r\n    const date = new Date();\r\n    date.setDate(date.getDate() - (6 - idx));\r\n    const dateKey = date.toISOString().slice(0, 10);\r\n    const dailyCount = log.filter((entry) => activityFilter(entry) && getDateKey(entry.timestamp) === dateKey).length;\r\n    return { date: dateKey, count: dailyCount };\r\n  });\r\n\r\n  analytics.timeline = lastSevenDays;\r\n  return analytics;\r\n};\r\n\r\nexport const createInspectionRequest = async (requestData) => {\r\n  try {\r\n    // Skip API call for now since it's returning 404, go directly to localStorage\r\n    console.log('Using localStorage for creating inspection requests (API unavailable)');\r\n    \r\n    // Fallback to localStorage\r\n    const existing = getStoredRequests();\r\n    const newRequest = {\r\n      id: `viewing-${Date.now()}`,\r\n      ...requestData,\r\n      createdAt: new Date().toISOString(),\r\n      status: 'pending'\r\n    };\r\n    existing.push(newRequest);\r\n    saveStoredRequests(existing);\r\n    \r\n    // Dispatch event to notify Dashboard and other components\r\n    safeWindowDispatch('viewingsUpdated', {\r\n      viewingRequest: newRequest,\r\n      action: 'created'\r\n    });\r\n    \r\n    // Also trigger a storage event for cross-tab synchronization\r\n    safeWindowDispatch('storage', {\r\n      key: VIEWING_REQUESTS_KEY,\r\n      newValue: JSON.stringify(existing)\r\n    });\r\n    logInspectionActivity('inspection_requested', newRequest);\r\n    \r\n    return newRequest;\r\n  } catch (error) {\r\n    console.error('Error creating inspection request:', error);\r\n    // Final fallback to localStorage\r\n    const existing = getStoredRequests();\r\n    const newRequest = {\r\n      id: `viewing-${Date.now()}`,\r\n      ...requestData,\r\n      createdAt: new Date().toISOString(),\r\n      status: 'pending'\r\n    };\r\n    existing.push(newRequest);\r\n    saveStoredRequests(existing);\r\n    \r\n    // Dispatch event to notify Dashboard and other components\r\n    safeWindowDispatch('viewingsUpdated', {\r\n      viewingRequest: newRequest,\r\n      action: 'created'\r\n    });\r\n    \r\n    // Also trigger a storage event for cross-tab synchronization\r\n    safeWindowDispatch('storage', {\r\n      key: VIEWING_REQUESTS_KEY,\r\n      newValue: JSON.stringify(existing)\r\n    });\r\n    logInspectionActivity('inspection_requested', newRequest);\r\n    \r\n    return newRequest;\r\n  }\r\n};\r\n\r\nexport const listInspectionRequestsByVendor = async (vendorId, vendorEmail) => {\r\n  try {\r\n    // Skip API call for now since it's returning 404, go directly to localStorage\r\n    console.log('Using localStorage for inspection requests (API unavailable)');\r\n    \r\n    // Fallback to localStorage\r\n    const local = getStoredRequests();\r\n    \r\n    // Filter by vendorId or vendorEmail\r\n    const filtered = local.filter((r) => \r\n      (vendorId && r.vendorId === vendorId) || \r\n      (vendorEmail && r.vendorEmail === vendorEmail)\r\n    );\r\n    \r\n    // Sort newest first\r\n    filtered.sort((a, b) => new Date(b.createdAt || 0) - new Date(a.createdAt || 0));\r\n    \r\n    return filtered;\r\n  } catch (error) {\r\n    console.error('Error listing inspection requests:', error);\r\n    // Final fallback to localStorage\r\n    const local = getStoredRequests();\r\n    const filtered = local.filter((r) => \r\n      (vendorId && r.vendorId === vendorId) || \r\n      (vendorEmail && r.vendorEmail === vendorEmail)\r\n    );\r\n    return filtered.sort((a, b) => new Date(b.createdAt || 0) - new Date(a.createdAt || 0));\r\n  }\r\n};\r\n\r\nexport const listInspectionRequestsByBuyer = async (buyerId) => {\r\n  try {\r\n    // Skip API call for now since it's returning 404, go directly to localStorage\r\n    console.log('Using localStorage for buyer inspection requests (API unavailable)');\r\n    \r\n    // Fallback to localStorage\r\n    const local = getStoredRequests();\r\n    const filtered = local.filter((r) => r.buyerId === buyerId);\r\n    return filtered.sort((a, b) => new Date(b.createdAt || 0) - new Date(a.createdAt || 0));\r\n  } catch (error) {\r\n    console.error('Error listing buyer inspection requests:', error);\r\n    return [];\r\n  }\r\n};\r\n\r\nexport const updateInspectionRequest = async (requestId, updates) => {\r\n  try {\r\n    // Skip API call for now since it's returning 404, go directly to localStorage\r\n    console.log('Using localStorage for updating inspection requests (API unavailable)');\r\n    \r\n    // Fallback to localStorage\r\n    const all = getStoredRequests();\r\n    let nextRecord = null;\r\n    const updated = all.map((r) => {\r\n      if (r.id === requestId) {\r\n        nextRecord = { ...r, ...updates, updatedAt: new Date().toISOString() };\r\n        return nextRecord;\r\n      }\r\n      return r;\r\n    });\r\n    if (!nextRecord) {\r\n      saveStoredRequests(all);\r\n      return false;\r\n    }\r\n    saveStoredRequests(updated);\r\n    \r\n    // Dispatch event to notify Dashboard and other components when status changes\r\n    safeWindowDispatch('viewingsUpdated', {\r\n      requestId,\r\n      updates,\r\n      action: 'updated'\r\n    });\r\n    \r\n    // Also trigger a storage event for cross-tab synchronization\r\n    safeWindowDispatch('storage', {\r\n      key: VIEWING_REQUESTS_KEY,\r\n      newValue: JSON.stringify(updated)\r\n    });\r\n    const action = deriveActionFromStatus(all.find((r) => r.id === requestId), nextRecord, updates);\r\n    if (action) {\r\n      logInspectionActivity(action, nextRecord);\r\n    }\r\n    \r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error updating inspection request:', error);\r\n    // Final fallback to localStorage\r\n    const all = getStoredRequests();\r\n    let nextRecord = null;\r\n    const updated = all.map((r) => {\r\n      if (r.id === requestId) {\r\n        nextRecord = { ...r, ...updates, updatedAt: new Date().toISOString() };\r\n        return nextRecord;\r\n      }\r\n      return r;\r\n    });\r\n    if (!nextRecord) {\r\n      saveStoredRequests(all);\r\n      return false;\r\n    }\r\n    saveStoredRequests(updated);\r\n    \r\n    // Dispatch event to notify Dashboard and other components when status changes\r\n    safeWindowDispatch('viewingsUpdated', {\r\n      requestId,\r\n      updates,\r\n      action: 'updated'\r\n    });\r\n    \r\n    // Also trigger a storage event for cross-tab synchronization\r\n    safeWindowDispatch('storage', {\r\n      key: VIEWING_REQUESTS_KEY,\r\n      newValue: JSON.stringify(updated)\r\n    });\r\n    const action = deriveActionFromStatus(all.find((r) => r.id === requestId), nextRecord, updates);\r\n    if (action) {\r\n      logInspectionActivity(action, nextRecord);\r\n    }\r\n    \r\n    return true;\r\n  }\r\n};\r\n\r\nexport const syncLocalInspectionRequests = async () => {\r\n  try {\r\n    // Try to sync with API if available\r\n    const local = getStoredRequests();\r\n    console.log('Inspection requests stored locally:', local.length);\r\n    return { synced: local.length };\r\n  } catch (error) {\r\n    console.error('syncLocalInspectionRequests failed:', error);\r\n    return { synced: 0 };\r\n  }\r\n};\r\n\r\nexport default {\r\n  createInspectionRequest,\r\n  listInspectionRequestsByVendor,\r\n  listInspectionRequestsByBuyer,\r\n  updateInspectionRequest,\r\n  syncLocalInspectionRequests,\r\n  getInspectionAnalytics\r\n};"],"names":["VendorInspectionRequests","user","useAuth","requests","setRequests","useState","loading","setLoading","showProposeModal","setShowProposeModal","requestToRespond","setRequestToRespond","proposalDate","setProposalDate","proposalTime","setProposalTime","prevStatusRef","useRef","showWebNotification","title","options","arguments","length","undefined","window","Notification","permission","e","toDateTime","dateStr","timeStr","Date","concat","_unused","buildCalendar","r","projectName","start","confirmedDate","confirmedTime","preferredDate","preferredTime","end","getTime","details","buyerName","projectLocation","location","formatDateICS","d","pad","n","String","padStart","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","load","async","data","listInspectionRequestsByVendor","id","email","console","error","useEffect","pollInterval","setInterval","requestPermission","ensureNotificationPermission","prev","current","previous","status","toast","success","body","icon","Object","fromEntries","map","x","clearInterval","_jsxs","className","children","_jsx","onClick","_r$status","buyerEmail","proposedDate","proposedTime","replaceAll","updateInspectionRequest","req","accept","decline","_Fragment","fmt","text","encodeURIComponent","dates","detailsEnc","locationEnc","url","open","openGoogleCalendar","ics","join","blob","Blob","type","URL","createObjectURL","a","document","createElement","href","download","appendChild","click","removeChild","revokeObjectURL","downloadICS","value","onChange","target","disabled","VIEWING_REQUESTS_KEY","INSPECTION_ACTIVITY_KEY","defaultAnalytics","totalRequests","pendingResponses","confirmed","vendorProposals","buyerReschedules","cancelledByBuyer","cancelledByVendor","timeline","safeWindowDispatch","eventName","detail","dispatchEvent","CustomEvent","StorageEvent","getStoredRequests","JSON","parse","localStorage","getItem","_unused2","saveStoredRequests","setItem","stringify","getActivityLog","_unused3","formatDateTimeLabel","date","time","logInspectionActivity","action","request","payload","buildActivityPayload","requestId","propertyTitle","projectTitle","buyerId","userId","vendorId","vendorEmail","timestamp","toISOString","log","unshift","pop","saveActivityLog","notifications","buildInspectionNotificationEntries","entries","userName","vendorName","vendor","owner","preferredLabel","confirmedLabel","proposedLabel","pushForVendor","message","push","recipientId","recipientEmail","roles","priority","metadata","pushForBuyer","userEmail","trim","payloads","filter","entry","_entry$metadata","_objectSpread","source","notificationService","createInspectionNotifications","then","result","warn","catch","persistInspectionNotifications","deriveActionFromStatus","next","updates","toLowerCase","matchesVendor","getInspectionAnalytics","role","relevant","matchesBuyer","analytics","pendingStatuses","forEach","includes","lastSevenDays","Array","from","_","idx","setDate","getDate","dateKey","slice","dailyCount","activityFilter","isoDate","count","createInspectionRequest","existing","newRequest","now","requestData","createdAt","viewingRequest","key","newValue","filtered","sort","b","all","nextRecord","updated","updatedAt","find"],"sourceRoot":""}