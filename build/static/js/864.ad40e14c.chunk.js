"use strict";(self.webpackChunkreal_estate_marketplace=self.webpackChunkreal_estate_marketplace||[]).push([[864],{3864(e,t,n){n.r(t),n.d(t,{default:()=>u});var r=n(9379),o=n(5043),s=n(3216),i=n(5016),a=n(5032),c=n(5369),d=n(2339),l=n(579);const u=()=>{var e;const{user:t}=(0,i.As)(),n=(0,s.Zp)(),[u,p]=(0,o.useState)([]),[m,g]=(0,o.useState)(null),y=(0,o.useRef)({}),[x,v]=(0,o.useState)(!1),[f,b]=(0,o.useState)(null),[h,w]=(0,o.useState)(""),[N,j]=(0,o.useState)(""),[I,_]=(0,o.useState)(""),D=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{if(!("Notification"in window))return;"granted"===Notification.permission&&new Notification(e,t)}catch(n){}},A=(e,t)=>{try{return new Date("".concat(e,"T").concat(t,":00"))}catch(n){return null}},S=e=>{const t="Property Inspection - ".concat(e.projectName),n=e.confirmedDate&&e.confirmedTime?A(e.confirmedDate,e.confirmedTime):A(e.preferredDate,e.preferredTime),r=n?new Date(n.getTime()+36e5):null;return{title:t,start:n,end:r,details:"Inspection at ".concat(e.projectLocation||""),location:e.projectLocation||""}},T=e=>{const t=e=>String(e).padStart(2,"0");return"".concat(e.getUTCFullYear()).concat(t(e.getUTCMonth()+1)).concat(t(e.getUTCDate()),"T").concat(t(e.getUTCHours())).concat(t(e.getUTCMinutes()),"00Z")},E=()=>{if(null===t||void 0===t||!t.id)return[];try{const e=JSON.parse(localStorage.getItem("viewingRequests")||"[]"),n=e.filter(e=>e.userId===t.id||e.buyerId===t.id).map(e=>(0,r.A)({id:e.id,projectName:e.propertyTitle||e.projectName||e.title||"Property",projectLocation:e.propertyLocation||e.projectLocation||e.location||"",preferredDate:e.preferredDate,preferredTime:e.preferredTime,confirmedDate:e.confirmedDate,confirmedTime:e.confirmedTime,proposedDate:e.proposedDate,proposedTime:e.proposedTime,status:e.status||"pending_vendor",createdAt:e.requestedAt||e.createdAt||(new Date).toISOString()},e));return n.sort((e,t)=>{const n=new Date(e.createdAt||0);return new Date(t.createdAt||0)-n}),n}catch(e){return console.error("Error loading requests from localStorage:",e),[]}},C=e=>{p(e),(async()=>{try{if(!("Notification"in window))return;"default"===Notification.permission&&await Notification.requestPermission()}catch(e){}})();const n=y.current||{};for(const t of e){const e=n[t.id];e&&e!==t.status&&("accepted"===t.status?D("Inspection confirmed",{body:"".concat(t.projectName," on ").concat(t.confirmedDate," ").concat(t.confirmedTime)}):"proposed_new_time"===t.status?D("Vendor proposed a new time",{body:"".concat(t.projectName,": ").concat(t.proposedDate," ").concat(t.proposedTime)}):"declined"===t.status?D("Inspection declined",{body:"".concat(t.projectName)}):"cancelled_by_vendor"===t.status&&(D("Vendor cancelled inspection",{body:"".concat(t.projectName," was cancelled by vendor")}),d.Ay.error("Vendor cancelled inspection for ".concat(t.projectName))))}y.current=Object.fromEntries(e.map(e=>[e.id,e.status])),null!==t&&void 0!==t&&t.id&&g((0,a.FH)({role:"buyer",userId:t.id}))};(0,o.useEffect)(()=>{if(null===t||void 0===t||!t.id)return void p([]);const e=E();C(e);const n=setInterval(()=>{const e=E();C(e)},5e3),r=()=>{const e=E();C(e)},o=e=>{if(null===t||void 0===t||!t.id)return;const n=e.detail||e;if(null!==n&&void 0!==n&&n.buyerId&&n.buyerId!==t.id)return;const r=(0,a.FH)({role:"buyer",userId:t.id});g(r)};return window.addEventListener("viewingsUpdated",r),window.addEventListener("inspectionAnalyticsUpdated",o),window.addEventListener("storage",e=>{"viewingRequests"===e.key&&r()}),()=>{clearInterval(n),window.removeEventListener("viewingsUpdated",r),window.removeEventListener("inspectionAnalyticsUpdated",o)}},[null===t||void 0===t?void 0:t.id]),(0,o.useEffect)(()=>{null!==t&&void 0!==t&&t.id?g((0,a.FH)({role:"buyer",userId:t.id})):g(null)},[null===t||void 0===t?void 0:t.id]);return(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"My Inspection Requests"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Track and respond to vendor proposals"})]}),m&&(0,l.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,l.jsxs)("div",{className:"bg-blue-50 border border-blue-100 rounded-xl p-4",children:[(0,l.jsx)("p",{className:"text-sm text-blue-600",children:"Pending Responses"}),(0,l.jsx)("p",{className:"text-3xl font-semibold text-blue-900",children:m.pendingResponses})]}),(0,l.jsxs)("div",{className:"bg-green-50 border border-green-100 rounded-xl p-4",children:[(0,l.jsx)("p",{className:"text-sm text-green-600",children:"Confirmed"}),(0,l.jsx)("p",{className:"text-3xl font-semibold text-green-900",children:m.confirmed})]}),(0,l.jsxs)("div",{className:"bg-purple-50 border border-purple-100 rounded-xl p-4",children:[(0,l.jsx)("p",{className:"text-sm text-purple-600",children:"Vendor Reschedules"}),(0,l.jsx)("p",{className:"text-3xl font-semibold text-purple-900",children:m.vendorProposals})]}),(0,l.jsxs)("div",{className:"bg-red-50 border border-red-100 rounded-xl p-4",children:[(0,l.jsx)("p",{className:"text-sm text-red-600",children:"Vendor Cancellations"}),(0,l.jsx)("p",{className:"text-3xl font-semibold text-red-900",children:m.cancelledByVendor})]})]}),(null===(e=m.timeline)||void 0===e?void 0:e.length)>0&&(0,l.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,l.jsx)("h3",{className:"text-sm font-semibold text-gray-900",children:"Last 7 days activity"}),(0,l.jsxs)("span",{className:"text-xs text-gray-500",children:[m.totalRequests," total requests"]})]}),(0,l.jsx)("div",{className:"flex gap-3 overflow-x-auto text-sm",children:m.timeline.map(e=>(0,l.jsxs)("div",{className:"flex-1 min-w-[90px] text-center",children:[(0,l.jsx)("p",{className:"text-gray-500 text-xs",children:new Date(e.date).toLocaleDateString()}),(0,l.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:e.count})]},e.date))})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,l.jsxs)("div",{className:"p-4 border-b border-gray-200 text-sm text-gray-600",children:[u.length," request(s)"]}),(0,l.jsxs)("div",{className:"divide-y",children:[0===u.length&&(0,l.jsx)("div",{className:"p-6 text-sm text-gray-600",children:"No inspection requests yet."}),u.map(e=>{var t;return(0,l.jsxs)("div",{className:"p-4 flex items-center text-sm",children:[(0,l.jsxs)("div",{className:"w-1/5",children:[(0,l.jsx)("div",{className:"font-medium text-gray-900",children:e.projectName}),(0,l.jsx)("div",{className:"text-gray-600",children:e.projectLocation})]}),(0,l.jsxs)("div",{className:"w-1/5",children:[(0,l.jsxs)("div",{children:["Preferred: ",e.preferredDate," ",e.preferredTime]}),e.proposedDate&&e.proposedTime&&(0,l.jsxs)("div",{className:"text-xs text-gray-600",children:["Vendor proposed: ",e.proposedDate," ",e.proposedTime]})]}),(0,l.jsx)("div",{className:"w-1/5",children:(0,l.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("pending_vendor"===e.status?"bg-yellow-100 text-yellow-800":"accepted"===e.status?"bg-green-100 text-green-800":"proposed_new_time"===e.status?"bg-blue-100 text-blue-800":"pending_vendor_confirmation"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:(null===(t=e.status)||void 0===t?void 0:t.replaceAll("_"," "))||"pending"})}),(0,l.jsxs)("div",{className:"w-2/5 flex flex-wrap gap-2 items-center",children:[(0,l.jsx)("button",{onClick:()=>(e=>{const t=e.propertyId||e.projectId;t?n("/property/".concat(t)):d.Ay.error("Property information not available")})(e),className:"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded transition-colors",title:"View Property Details",children:(0,l.jsx)(c.Ny1,{className:"w-5 h-5"})}),"proposed_new_time"===e.status&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{onClick:()=>(async e=>{if(!e.proposedDate||!e.proposedTime)return void d.Ay.error("No proposed time from vendor");await(0,a.HK)(e.id,{status:"accepted",confirmedDate:e.proposedDate,confirmedTime:e.proposedTime})?d.Ay.success("Proposal accepted"):d.Ay.error("Failed to accept")})(e),className:"px-3 py-1 bg-green-600 text-white rounded",children:"Accept Proposal"}),(0,l.jsx)("button",{onClick:()=>(async e=>{await(0,a.HK)(e.id,{status:"declined"})?d.Ay.success("Proposal declined"):d.Ay.error("Failed to decline")})(e),className:"px-3 py-1 bg-red-600 text-white rounded",children:"Decline"})]}),"accepted"===e.status&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{onClick:()=>(e=>{const{title:t,start:n,end:r,details:o,location:s}=S(e);if(!n||!r)return;const i=e=>"".concat(e.getUTCFullYear()).concat(String(e.getUTCMonth()+1).padStart(2,"0")).concat(String(e.getUTCDate()).padStart(2,"0"),"T").concat(String(e.getUTCHours()).padStart(2,"0")).concat(String(e.getUTCMinutes()).padStart(2,"0"),"00Z"),a=encodeURIComponent(t),c="".concat(i(n),"/").concat(i(r)),d=encodeURIComponent(o),l=encodeURIComponent(s),u="https://www.google.com/calendar/render?action=TEMPLATE&text=".concat(a,"&dates=").concat(c,"&details=").concat(d,"&location=").concat(l);window.open(u,"_blank")})(e),className:"px-3 py-1 bg-gray-800 text-white rounded",children:"Google Calendar"}),(0,l.jsx)("button",{onClick:()=>(e=>{const{title:t,start:n,end:r,details:o,location:s}=S(e);if(!n||!r)return;const i=["BEGIN:VCALENDAR","VERSION:2.0","PRODID:-//PropertyArk//Inspection//EN","BEGIN:VEVENT","UID:".concat(e.id,"@propertyark"),"DTSTAMP:".concat(T(new Date)),"DTSTART:".concat(T(n)),"DTEND:".concat(T(r)),"SUMMARY:".concat(t),"DESCRIPTION:".concat(o),"LOCATION:".concat(s),"END:VEVENT","END:VCALENDAR"].join("\r\n"),a=new Blob([i],{type:"text/calendar;charset=utf-8"}),c=URL.createObjectURL(a),d=document.createElement("a");d.href=c,d.download="inspection-".concat(e.id,".ics"),document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(c)})(e),className:"px-3 py-1 border rounded",children:"Download .ics"})]}),"cancelled_by_buyer"!==e.status&&"declined"!==e.status&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{onClick:()=>(e=>{b(e),w(e.preferredDate||""),j(e.preferredTime||""),_(""),v(!0)})(e),className:"px-3 py-1 bg-blue-600 text-white rounded",children:"Reschedule"}),(0,l.jsx)("button",{onClick:()=>(async e=>{if(!window.confirm("Cancel this inspection request? Vendors will be notified."))return;await(0,a.HK)(e.id,{status:"cancelled_by_buyer",cancelledAt:(new Date).toISOString()})?d.Ay.success("Inspection cancelled"):d.Ay.error("Failed to cancel")})(e),className:"px-3 py-1 bg-red-100 text-red-700 rounded border border-red-300",children:"Cancel"})]})]})]},e.id)})]})]}),x&&f&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[(0,l.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:"Reschedule Inspection"}),(0,l.jsx)("p",{className:"text-sm text-gray-500",children:f.projectName})]}),(0,l.jsx)("button",{onClick:()=>v(!1),className:"text-gray-500 hover:text-gray-700",children:"\xd7"})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New date"}),(0,l.jsx)("input",{type:"date",value:h,onChange:e=>w(e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New time"}),(0,l.jsx)("input",{type:"time",value:N,onChange:e=>j(e.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Message to vendor (optional)"}),(0,l.jsx)("textarea",{value:I,onChange:e=>_(e.target.value),rows:3,className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Share context for the new time"})]})]}),(0,l.jsxs)("div",{className:"flex justify-between mt-6",children:[(0,l.jsx)("button",{onClick:()=>v(!1),className:"px-5 py-2 border rounded-lg",children:"Close"}),(0,l.jsx)("button",{onClick:async()=>{if(!f||!h||!N)return void d.Ay.error("Select your new date and time");await(0,a.HK)(f.id,{status:"buyer_rescheduled",preferredDate:h,preferredTime:N,buyerMessage:I||"",proposedDate:null,proposedTime:null})?(d.Ay.success("Reschedule request sent to vendor"),v(!1),b(null),w(""),j(""),_("")):d.Ay.error("Failed to reschedule")},className:"px-5 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Send Update"})]})]})})]})}},5032(e,t,n){n.d(t,{FH:()=>x,HK:()=>b,Ix:()=>v,o2:()=>f});var r=n(9379),o=n(1692);const s="viewingRequests",i="inspectionActivityLog",a={totalRequests:0,pendingResponses:0,confirmed:0,vendorProposals:0,buyerReschedules:0,cancelledByBuyer:0,cancelledByVendor:0,timeline:[]},c=(e,t)=>{if("undefined"!==typeof window)if("storage"!==e)"function"===typeof window.dispatchEvent&&window.dispatchEvent(new CustomEvent(e,{detail:t}));else try{window.dispatchEvent(new StorageEvent("storage",t))}catch(n){window.dispatchEvent(new CustomEvent("storage",{detail:t}))}},d=()=>{try{return JSON.parse(localStorage.getItem(s)||"[]")}catch(e){return[]}},l=e=>{localStorage.setItem(s,JSON.stringify(e))},u=()=>{try{return JSON.parse(localStorage.getItem(i)||"[]")}catch(e){return[]}},p=(e,t)=>e||t?t?e?"".concat(e," ").concat(t):t:e:"",m=(e,t)=>{if(!e||!t)return;const n=((e,t)=>({action:e,requestId:t.id,propertyTitle:t.propertyTitle||t.projectTitle||t.projectName||t.title||"Property",buyerId:t.buyerId||t.userId,vendorId:t.vendorId,vendorEmail:t.vendorEmail,status:t.status,timestamp:(new Date).toISOString()}))(e,t),s=u();s.unshift(n),s.length>200&&s.pop(),(e=>{localStorage.setItem(i,JSON.stringify(e))})(s),c("inspectionActivity",n),c("inspectionAnalyticsUpdated",n);const a=((e,t,n)=>{const r=[],o=n.propertyTitle,s=t.buyerName||t.userName||"Buyer",i=t.vendorName||t.vendor||t.owner||"Vendor",a=p(t.preferredDate,t.preferredTime),c=p(t.confirmedDate,t.confirmedTime),d=p(t.proposedDate,t.proposedTime),l=(n,a)=>{(t.vendorId||t.vendorEmail)&&r.push({recipientId:t.vendorId,recipientEmail:t.vendorEmail,roles:["vendor"],type:e,title:n,message:a,priority:"medium",metadata:{requestId:t.id,propertyTitle:o,buyerName:s,vendorName:i}})},u=(n,a)=>{(t.buyerId||t.userId||t.buyerEmail||t.userEmail)&&r.push({recipientId:t.buyerId||t.userId,recipientEmail:t.buyerEmail||t.userEmail,roles:["buyer"],type:e,title:n,message:a,priority:"medium",metadata:{requestId:t.id,propertyTitle:o,buyerName:s,vendorName:i}})};switch(e){case"inspection_requested":l("New inspection request","".concat(s," requested to view ").concat(o," ").concat(a?"on ".concat(a):"").trim());break;case"inspection_confirmed":u("Inspection confirmed","".concat(i," confirmed ").concat(o," ").concat(c?"for ".concat(c):"").trim());break;case"vendor_proposed_new_time":u("Vendor proposed new time","".concat(i," suggested ").concat(d||"another slot"," for ").concat(o));break;case"buyer_rescheduled":l("Buyer requested new time","".concat(s," rescheduled ").concat(o," ").concat(a?"to ".concat(a):"").trim());break;case"inspection_cancelled_by_buyer":l("Inspection cancelled by buyer","".concat(s," cancelled ").concat(o));break;case"inspection_cancelled_by_vendor":u("Inspection cancelled by vendor","".concat(i," cancelled ").concat(o));break;case"inspection_declined":u("Inspection declined","".concat(i," declined the request for ").concat(o))}return r})(e,t,n);a.length&&(c("inspectionNotification",{action:e,payload:n,notifications:a,request:t}),function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!e.length||"undefined"===typeof window)return;const t=e.filter(e=>e.recipientId).map(e=>{var t;return{recipientId:e.recipientId,type:e.type,title:e.title,message:e.message,priority:e.priority||"medium",metadata:(0,r.A)((0,r.A)({},e.metadata||{}),{},{source:(null===(t=e.metadata)||void 0===t?void 0:t.source)||"inspection_client_sync"}),data:e.metadata||{}}});t.length&&o.A.createInspectionNotifications(t).then(e=>{null!==e&&void 0!==e&&e.success||console.warn("Failed to persist inspection notifications",e)}).catch(e=>{console.error("Error persisting inspection notifications:",e)})}(a))},g=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=((null===t||void 0===t?void 0:t.status)||n.status||"").toLowerCase();if(!r&&(n.proposedDate||n.proposedTime))return"vendor_proposed_new_time";switch(r){case"accepted":case"confirmed":return"inspection_confirmed";case"proposed_new_time":return"vendor_proposed_new_time";case"buyer_rescheduled":return"buyer_rescheduled";case"cancelled_by_buyer":return"inspection_cancelled_by_buyer";case"cancelled_by_vendor":return"inspection_cancelled_by_vendor";case"declined":return"inspection_declined";default:return e&&e.status!==(null===t||void 0===t?void 0:t.status)?"inspection_status_".concat((null===t||void 0===t?void 0:t.status)||"updated"):null}},y=(e,t,n)=>!(!t&&!n)&&(t&&(null===e||void 0===e?void 0:e.vendorId)===t||n&&(null===e||void 0===e?void 0:e.vendorEmail)===n),x=function(){let{role:e="buyer",userId:t,vendorId:n,vendorEmail:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("undefined"===typeof window)return(0,r.A)({},a);if("buyer"===e&&!t)return(0,r.A)({},a);if("vendor"===e&&!n&&!o)return(0,r.A)({},a);const s=d().filter(r=>{return"buyer"===e?(s=r,!!(i=t)&&((null===s||void 0===s?void 0:s.buyerId)===i||(null===s||void 0===s?void 0:s.userId)===i)):y(r,n||r.vendorId,o);var s,i}),i={totalRequests:s.length,pendingResponses:0,confirmed:0,vendorProposals:0,buyerReschedules:0,cancelledByBuyer:0,cancelledByVendor:0,timeline:[]},c=["pending","pending_vendor","pending_vendor_confirmation"],l=u();s.forEach(e=>{const t=(e.status||"").toLowerCase();c.includes(t)&&(i.pendingResponses+=1),["accepted","confirmed"].includes(t)&&(i.confirmed+=1),"proposed_new_time"===t&&(i.vendorProposals+=1),"buyer_rescheduled"===t&&(i.buyerReschedules+=1),"cancelled_by_buyer"===t&&(i.cancelledByBuyer+=1),["cancelled_by_vendor","declined"].includes(t)&&(i.cancelledByVendor+=1)});const p=Array.from({length:7}).map((r,s)=>{const i=new Date;i.setDate(i.getDate()-(6-s));const a=i.toISOString().slice(0,10),c=l.filter(r=>{return(r=>"buyer"===e?(null===r||void 0===r?void 0:r.buyerId)===t:y(r,n,o))(r)&&((s=r.timestamp)?new Date(s):new Date).toISOString().slice(0,10)===a;var s}).length;return{date:a,count:c}});return i.timeline=p,i},v=async e=>{try{console.log("Using localStorage for creating inspection requests (API unavailable)");const t=d(),n=(0,r.A)((0,r.A)({id:"viewing-".concat(Date.now())},e),{},{createdAt:(new Date).toISOString(),status:"pending"});return t.push(n),l(t),c("viewingsUpdated",{viewingRequest:n,action:"created"}),c("storage",{key:s,newValue:JSON.stringify(t)}),m("inspection_requested",n),n}catch(t){console.error("Error creating inspection request:",t);const n=d(),o=(0,r.A)((0,r.A)({id:"viewing-".concat(Date.now())},e),{},{createdAt:(new Date).toISOString(),status:"pending"});return n.push(o),l(n),c("viewingsUpdated",{viewingRequest:o,action:"created"}),c("storage",{key:s,newValue:JSON.stringify(n)}),m("inspection_requested",o),o}},f=async(e,t)=>{try{console.log("Using localStorage for inspection requests (API unavailable)");const n=d().filter(n=>e&&n.vendorId===e||t&&n.vendorEmail===t);return n.sort((e,t)=>new Date(t.createdAt||0)-new Date(e.createdAt||0)),n}catch(n){console.error("Error listing inspection requests:",n);return d().filter(n=>e&&n.vendorId===e||t&&n.vendorEmail===t).sort((e,t)=>new Date(t.createdAt||0)-new Date(e.createdAt||0))}},b=async(e,t)=>{try{console.log("Using localStorage for updating inspection requests (API unavailable)");const n=d();let o=null;const i=n.map(n=>n.id===e?(o=(0,r.A)((0,r.A)((0,r.A)({},n),t),{},{updatedAt:(new Date).toISOString()}),o):n);if(!o)return l(n),!1;l(i),c("viewingsUpdated",{requestId:e,updates:t,action:"updated"}),c("storage",{key:s,newValue:JSON.stringify(i)});const a=g(n.find(t=>t.id===e),o,t);return a&&m(a,o),!0}catch(n){console.error("Error updating inspection request:",n);const o=d();let i=null;const a=o.map(n=>n.id===e?(i=(0,r.A)((0,r.A)((0,r.A)({},n),t),{},{updatedAt:(new Date).toISOString()}),i):n);if(!i)return l(o),!1;l(a),c("viewingsUpdated",{requestId:e,updates:t,action:"updated"}),c("storage",{key:s,newValue:JSON.stringify(a)});const u=g(o.find(t=>t.id===e),i,t);return u&&m(u,i),!0}}}}]);
//# sourceMappingURL=864.ad40e14c.chunk.js.map