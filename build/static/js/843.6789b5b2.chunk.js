"use strict";(self.webpackChunkreal_estate_marketplace=self.webpackChunkreal_estate_marketplace||[]).push([[843],{2407(e,t,r){r.d(t,{A:()=>a});r(5043);var n=r(5475),s=r(3216),i=r(5369),o=r(579);const a=e=>{let{items:t}=e;const r=(0,s.zy)().pathname.split("/").filter(e=>e),a=t||[{label:"Home",path:"/"},...r.map((e,t)=>{const n="/".concat(r.slice(0,t+1).join("/"));return{label:e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),path:n}})];return(0,o.jsx)("nav",{className:"flex items-center space-x-2 text-sm text-gray-600 mb-4","aria-label":"Breadcrumb",children:(0,o.jsx)("ol",{className:"flex items-center space-x-2",children:a.map((e,t)=>{const r=t===a.length-1;return(0,o.jsxs)("li",{className:"flex items-center",children:[0===t&&(0,o.jsx)(i.rQ8,{className:"h-4 w-4 text-gray-400 mr-2","aria-hidden":"true"}),r?(0,o.jsx)("span",{className:"text-gray-900 font-medium","aria-current":"page",children:e.label}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.N_,{to:e.path,className:"hover:text-blue-600 transition-colors","aria-label":"Navigate to ".concat(e.label),children:e.label}),(0,o.jsx)(i.X6T,{className:"h-3 w-3 text-gray-400 mx-2","aria-hidden":"true"})]})]},e.path||t)})})})}},843(e,t,r){r.r(t),r.d(t,{default:()=>h});var n=r(5043),s=r(3216),i=r(5475),o=r(4345),a=r(5016),l=r(5369),c=r(2339),d=r(5032),m=r(2407),u=r(7210),p=r(579);const v=e=>{let{property:t,className:r=""}=e;const{user:s}=(0,a.As)(),[i,o]=(0,n.useState)(!1);(0,n.useEffect)(()=>{if(i){const{style:e}=document.body,t=e.overflow;return e.overflow="hidden",()=>{e.overflow=t}}},[i]);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("button",{onClick:()=>{s?o(!0):c.Ay.error("Login is temporarily unavailable while we rebuild the auth experience.")},className:"w-full bg-brand-blue hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors flex items-center justify-center space-x-2 ".concat(r),children:[(0,p.jsx)(l.AsH,{className:"h-5 w-5"}),(0,p.jsx)("span",{children:"Buy with Escrow Protection"}),(0,p.jsx)(l.SMR,{className:"h-4 w-4"})]}),i&&(0,p.jsx)(u.default,{property:t,onClose:()=>o(!1),isModal:!0})]})},h=()=>{var e,t,r,u,h,g,x,y,f,b,N,j,w,I,S,A,k,_,P,E,C,q,D;const{id:L}=(0,s.g)(),{properties:V,loading:O,error:T,toggleFavorite:B}=((0,s.Zp)(),(0,o.NC)()),{user:M,setAuthRedirect:J}=(0,a.As)(),[U,R]=(0,n.useState)(null),[F,z]=(0,n.useState)(0),[W,X]=(0,n.useState)(!1),[H,Q]=(0,n.useState)(""),[Z,G]=(0,n.useState)(!1),[K,Y]=(0,n.useState)(""),[$,ee]=(0,n.useState)(""),[te,re]=(0,n.useState)(!1);(0,n.useEffect)(()=>{if(V&&L){const e=V.find(e=>{var t;return e.id===L||e.propertyId===L||e.numericId===parseInt(L)||e.id==="prop_".concat(L)||(null===(t=e.id)||void 0===t?void 0:t.toString())===(null===L||void 0===L?void 0:L.toString())});if(e){if(e.location&&"string"===typeof e.location&&e.location.includes("undefined")){const t=[e.address,e.city,e.state].filter(e=>e&&"undefined"!==e&&void 0!==e&&null!==e);t.length>0&&(e.location=t.join(", "))}R(e),z(0)}}},[V,L]),(0,n.useEffect)(()=>{if(U&&M){const e="favorites_".concat(M.id),t=new Set(JSON.parse(localStorage.getItem(e)||"[]"));re(t.has(U.id))}else re(!1)},[U,M]);const ne=e=>"string"===typeof e?e:e&&e.url?e.url:"https://images.unsplash.com/photo-1564013799919-ab600027ffc6?w=80&h=80&fit=crop",se=()=>{navigator.clipboard.writeText(window.location.href).then(()=>{c.Ay.success("Property link copied to clipboard!")}).catch(()=>{c.Ay.error("Failed to copy link")})},ie=function(e,t){var r,n,s,i,o,a,l,c,d,m,u,p,v,h,g,x;let y=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!M||!e)return;const f=JSON.parse(localStorage.getItem("inquiries")||"[]"),b=f.find(t=>t.propertyId===e.id&&(t.userId===M.id||t.buyerId===M.id)&&("new"===t.status||"pending"===t.status||"contacted"===t.status));if(b)return b;const N={id:"inquiry-".concat(Date.now()),propertyId:e.id,propertyTitle:e.title,propertyLocation:"string"===typeof e.location?e.location:(null===(r=e.location)||void 0===r?void 0:r.address)||(null===(n=e.location)||void 0===n?void 0:n.city)||"Location not specified",propertyPrice:e.price||0,propertyImage:(null===(s=e.images)||void 0===s||null===(i=s[0])||void 0===i?void 0:i.url)||e.image||(null===(o=e.images)||void 0===o?void 0:o[0])||"",propertyBedrooms:e.bedrooms||(null===(a=e.details)||void 0===a?void 0:a.bedrooms)||0,propertyBathrooms:e.bathrooms||(null===(l=e.details)||void 0===l?void 0:l.bathrooms)||0,propertyArea:e.area||(null===(c=e.details)||void 0===c?void 0:c.sqft)||0,userId:M.id,buyerId:M.id,buyerName:"".concat(M.firstName," ").concat(M.lastName),buyerEmail:M.email,buyerPhone:M.phone||"",vendorId:e.vendorId||(null===(d=e.owner)||void 0===d?void 0:d.id)||(null===(m=e.vendor)||void 0===m?void 0:m.id)||"",vendorName:null!==(u=e.owner)&&void 0!==u&&u.firstName?"".concat(e.owner.firstName," ").concat(e.owner.lastName||"").trim():null!==(p=e.vendor)&&void 0!==p&&p.firstName?"".concat(e.vendor.firstName," ").concat(e.vendor.lastName||"").trim():"Property Vendor",vendorEmail:(null===(v=e.owner)||void 0===v?void 0:v.email)||(null===(h=e.vendor)||void 0===h?void 0:h.email)||e.vendorEmail||"",vendorPhone:(null===(g=e.owner)||void 0===g?void 0:g.phone)||e.vendorPhone||e.contactPhone||(null===(x=e.vendor)||void 0===x?void 0:x.phone)||"",inquiryType:t,message:y||"I'm interested in ".concat(e.title,". Please contact me."),status:"new",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),responses:[]};return f.push(N),localStorage.setItem("inquiries",JSON.stringify(f)),window.dispatchEvent(new CustomEvent("inquiriesUpdated",{detail:{inquiry:N,action:"created"}})),window.dispatchEvent(new StorageEvent("storage",{key:"inquiries",newValue:JSON.stringify(f)})),N};if(O)return(0,p.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,p.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})});if(T)return(0,p.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,p.jsxs)("div",{className:"text-center",children:[(0,p.jsx)("h2",{className:"text-2xl font-bold text-red-600 mb-4",children:"Error Loading Property"}),(0,p.jsx)("p",{className:"text-gray-600",children:T})]})});if(!U)return(0,p.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,p.jsxs)("div",{className:"text-center",children:[(0,p.jsx)(m.A,{items:[{label:"Home",path:"/"},{label:"Properties",path:"/properties"},{label:"Property Not Found",path:"#"}]}),(0,p.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Property Not Found"}),(0,p.jsx)("p",{className:"text-gray-600",children:"The property you're looking for doesn't exist."}),(0,p.jsx)(i.N_,{to:"/properties",className:"mt-4 inline-block text-blue-600 hover:text-blue-500",children:"Back to Properties"})]})});const oe=[{label:"Home",path:"/"},{label:"Properties",path:"/properties"},{label:(null===U||void 0===U?void 0:U.title)||"Property Details",path:"#"}];return(0,p.jsxs)("div",{className:"min-h-screen bg-gray-50 py-8",children:[(0,p.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,p.jsx)("div",{className:"mb-8",children:(0,p.jsx)(m.A,{items:oe})}),(0,p.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,p.jsxs)("div",{className:"lg:col-span-2",children:[(0,p.jsxs)("div",{className:"mb-8",children:[(0,p.jsxs)("div",{className:"relative",children:[(0,p.jsx)("img",{src:(()=>{if(!U)return"https://images.unsplash.com/photo-1564013799919-ab600027ffc6?w=800&h=600&fit=crop";if(U.images&&Array.isArray(U.images)&&U.images.length>0){const e=Math.max(0,Math.min(F,U.images.length-1)),t=U.images[e];if("string"===typeof t)return t;if(t&&t.url)return t.url}return U.image?U.image:"https://images.unsplash.com/photo-1564013799919-ab600027ffc6?w=800&h=600&fit=crop"})(),alt:U.title,className:"w-full h-96 object-cover rounded-lg"},"main-image-".concat(F)),(0,p.jsxs)("div",{className:"absolute top-4 right-4 flex gap-2",children:[(0,p.jsxs)("span",{className:"bg-blue-600 text-white px-3 py-1 rounded-full text-sm font-medium",children:["\u20a6",null===(e=U.price)||void 0===e?void 0:e.toLocaleString()]}),(0,p.jsx)("button",{onClick:async()=>{if(!M)return void c.Ay.error("Please login to add favorites");if(!U||!U.id)return void c.Ay.error("Property information not available");const e="favorites_".concat(M.id),t=te,r=String(U.id);let n;re(!t);try{const s=new Set(JSON.parse(localStorage.getItem(e)||"[]"));t?(s.delete(r),c.Ay.success("Property removed from saved properties")):(s.add(r),c.Ay.success("Property added to saved properties")),n=Array.from(s),localStorage.setItem(e,JSON.stringify(n))}catch(s){}try{const s=await B(r,U);if(!s||void 0===s.success)throw new Error("Failed to toggle favorite on server");window.dispatchEvent(new CustomEvent("favoritesUpdated",{detail:{propertyId:r,favorited:!t}})),n&&window.dispatchEvent(new StorageEvent("storage",{key:e,newValue:JSON.stringify(n)}))}catch(T){console.error("Error toggling favorite:",T),re(t);try{const n=new Set(JSON.parse(localStorage.getItem(e)||"[]"));t?n.add(r):n.delete(r),localStorage.setItem(e,JSON.stringify(Array.from(n)))}catch(i){}c.Ay.error("Failed to update saved properties. Please try again.")}},className:"bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-75 transition-colors ".concat(te?"text-red-500":""),title:te?"Remove from favorites":"Add to favorites",children:(0,p.jsx)(l.Mbv,{className:te?"fill-current":""})}),(0,p.jsx)("button",{onClick:async()=>{if(navigator.share)try{await navigator.share({title:U.title,text:U.description,url:window.location.href})}catch(T){console.log("Error sharing:",T),se()}else se()},className:"bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-75 transition-colors",children:(0,p.jsx)(l.Zzu,{})})]})]}),U.images&&Array.isArray(U.images)&&U.images.length>1&&(0,p.jsx)("div",{className:"mt-4 flex space-x-2 overflow-x-auto pb-2",children:U.images.map((e,t)=>(0,p.jsx)("button",{type:"button",onClick:e=>{e.preventDefault(),z(t)},className:"flex-shrink-0 w-20 h-20 rounded-md overflow-hidden border-2 transition-all ".concat(F===t?"border-blue-500 ring-2 ring-blue-300 ring-offset-2":"border-gray-200 hover:border-gray-300"),children:(0,p.jsx)("img",{src:ne(e),alt:"".concat(U.title," ").concat(t+1),className:"w-full h-full object-cover"})},"thumb-".concat(t)))})]}),(0,p.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:[(0,p.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:U.title}),(0,p.jsx)("p",{className:"text-lg text-gray-600 mb-6",children:(()=>{if("string"===typeof U.location)return U.location;if(U.location&&"object"===typeof U.location){return[U.location.address||"",U.location.city||"",U.location.state||""].filter(Boolean).join(", ")||"Location not specified"}return"Location not specified"})()}),(0,p.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[(0,p.jsxs)("div",{className:"text-center",children:[(0,p.jsxs)("div",{className:"text-2xl font-bold text-blue-600 flex items-center justify-center",children:[(0,p.jsx)(l.TiC,{className:"mr-2"}),U.bedrooms||(null===(t=U.details)||void 0===t?void 0:t.bedrooms)||0]}),(0,p.jsx)("div",{className:"text-sm text-gray-500",children:"Bedrooms"})]}),(0,p.jsxs)("div",{className:"text-center",children:[(0,p.jsxs)("div",{className:"text-2xl font-bold text-blue-600 flex items-center justify-center",children:[(0,p.jsx)(l.F6e,{className:"mr-2"}),U.bathrooms||(null===(r=U.details)||void 0===r?void 0:r.bathrooms)||0]}),(0,p.jsx)("div",{className:"text-sm text-gray-500",children:"Bathrooms"})]}),(0,p.jsxs)("div",{className:"text-center",children:[(0,p.jsxs)("div",{className:"text-2xl font-bold text-blue-600 flex items-center justify-center",children:[(0,p.jsx)(l.VlX,{className:"mr-2"}),U.area||(null===(u=U.details)||void 0===u?void 0:u.sqft)||0]}),(0,p.jsx)("div",{className:"text-sm text-gray-500",children:"Sq Ft"})]}),(0,p.jsxs)("div",{className:"text-center",children:[(0,p.jsx)("div",{className:"text-2xl font-bold text-blue-600 capitalize",children:U.type}),(0,p.jsx)("div",{className:"text-sm text-gray-500",children:"Type"})]})]}),(0,p.jsxs)("div",{className:"border-t pt-6",children:[(0,p.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Description"}),(0,p.jsx)("p",{className:"text-gray-600 leading-relaxed",children:U.description})]})]}),U.amenities&&U.amenities.length>0&&(0,p.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:[(0,p.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Amenities"}),(0,p.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:U.amenities.map((e,t)=>(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)("svg",{className:"w-5 h-5 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,p.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,p.jsx)("span",{className:"text-gray-700",children:e})]},t))})]})]}),(0,p.jsxs)("div",{className:"lg:col-span-1",children:[(0,p.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,p.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),(0,p.jsxs)("div",{className:"space-y-3",children:[(0,p.jsxs)("button",{onClick:()=>{var e,t;if(console.log("Contact Owner clicked, property:",U,"user:",M),!M)return void c.Ay.error("Please login to contact property vendor");ie(U,"message","I'm interested in ".concat(U.title,". Please contact me via WhatsApp."));const r=(null===U||void 0===U||null===(e=U.owner)||void 0===e?void 0:e.phone)||(null===U||void 0===U?void 0:U.vendorPhone)||(null===U||void 0===U?void 0:U.contactPhone)||(null===U||void 0===U||null===(t=U.vendor)||void 0===t?void 0:t.phone);if(!r)return void c.Ay.error("Vendor phone number not available");let n=r.replace(/\D/g,"");n.startsWith("234")||(n=n.startsWith("0")?"234"+n.substring(1):"234"+n);const s=(null===U||void 0===U?void 0:U.title)||"Property",i=null!==U&&void 0!==U&&U.price?"\u20a6".concat(U.price.toLocaleString()):"",o=encodeURIComponent("Hi, I'm interested in your property: ".concat(s).concat(i?" (".concat(i,")"):"",". Could you please provide more information?")),a="https://wa.me/".concat(n,"?text=").concat(o);window.open(a,"_blank"),c.Ay.success("Opening WhatsApp... Inquiry saved to My Inquiries.")},className:"w-full bg-green-600 text-white py-3 px-4 rounded-md hover:bg-green-700 transition-colors flex items-center justify-center",children:[(0,p.jsx)(l.EcP,{className:"mr-2"}),"Contact Vendor"]}),(0,p.jsxs)("button",{onClick:()=>{M?G(!0):c.Ay.error("Please login to schedule a viewing")},className:"w-full bg-green-600 text-white py-3 px-4 rounded-md hover:bg-green-700 transition-colors flex items-center justify-center",children:[(0,p.jsx)(l.itz,{className:"mr-2"}),"Schedule Viewing"]}),(0,p.jsxs)("button",{onClick:()=>{var e,t;if(!M)return void c.Ay.error("Please login to call property vendor");ie(U,"call","I'm interested in ".concat(U.title,". Please contact me via phone call."));const r=(null===U||void 0===U||null===(e=U.owner)||void 0===e?void 0:e.phone)||(null===U||void 0===U?void 0:U.vendorPhone)||(null===U||void 0===U?void 0:U.contactPhone)||(null===U||void 0===U||null===(t=U.vendor)||void 0===t?void 0:t.phone);if(!r)return void c.Ay.error("Vendor phone number not available");let n=r.replace(/\D/g,"");n.startsWith("234")||(n=n.startsWith("0")?"234"+n.substring(1):"234"+n),window.location.href="tel:+".concat(n),c.Ay.success("Inquiry saved to My Inquiries.")},className:"w-full bg-blue-600 text-white py-3 px-4 rounded-md hover:bg-blue-700 transition-colors flex items-center justify-center",children:[(0,p.jsx)(l.Cab,{className:"mr-2"}),"Call Vendor"]})]})]}),(0,p.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,p.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Property Vendor"}),(0,p.jsxs)("div",{className:"space-y-3",children:[(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)("div",{className:"w-12 h-12 bg-gray-300 rounded-full flex items-center justify-center mr-3",children:(0,p.jsxs)("span",{className:"text-gray-600 font-semibold",children:[(null===(h=U.owner)||void 0===h||null===(g=h.firstName)||void 0===g?void 0:g[0])||(null===(x=U.vendor)||void 0===x||null===(y=x.firstName)||void 0===y?void 0:y[0])||"V",(null===(f=U.owner)||void 0===f||null===(b=f.lastName)||void 0===b?void 0:b[0])||(null===(N=U.vendor)||void 0===N||null===(j=N.lastName)||void 0===j?void 0:j[0])||"D"]})}),(0,p.jsxs)("div",{children:[(0,p.jsxs)("div",{className:"font-semibold text-gray-900",children:[(null===(w=U.owner)||void 0===w?void 0:w.firstName)||(null===(I=U.vendor)||void 0===I?void 0:I.firstName)||"Vendor"," ",(null===(S=U.owner)||void 0===S?void 0:S.lastName)||(null===(A=U.vendor)||void 0===A?void 0:A.lastName)||""]}),(0,p.jsx)("div",{className:"text-sm text-gray-500",children:"Property Vendor"})]})]}),(0,p.jsxs)("div",{className:"pt-3 border-t",children:[(0,p.jsxs)("div",{className:"flex items-start text-gray-600 mb-3",children:[(0,p.jsx)(l.vq8,{className:"mr-2 mt-0.5 flex-shrink-0"}),(0,p.jsx)("span",{className:"text-sm",children:(()=>{const e=U.address||"",t=U.city||"",r=U.state||"",n=U.zipCode||"";if(e||t||r){const s=[e,t,r,n].filter(e=>e&&""!==e&&null!==e&&void 0!==e&&"undefined"!==e);if(s.length>0)return s.join(", ")}if(U.location&&"object"===typeof U.location){const e=[U.location.address,U.location.city,U.location.state,U.location.zipCode].filter(e=>e&&""!==e&&null!==e&&void 0!==e&&"undefined"!==e);if(e.length>0)return e.join(", ")}return"string"!==typeof U.location||""===U.location.trim()||U.location.includes("undefined")?"Location not specified":U.location})()})]}),U.createdAt&&(0,p.jsxs)("div",{className:"flex items-center text-gray-600 mb-3 text-sm",children:[(0,p.jsx)(l.itz,{className:"mr-2"}),(0,p.jsxs)("span",{children:["Listed: ",(()=>{const e=new Date(U.createdAt);return isNaN(e.getTime())?U.createdAt:e.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})()]})]}),(0,p.jsxs)("div",{className:"flex items-center text-gray-600 text-sm",children:[(0,p.jsxs)("span",{children:["Views: ",U.views||0]}),(0,p.jsx)("span",{className:"mx-2",children:"\u2022"}),(0,p.jsx)("span",{children:U.isVerified?"\u2705 Verified":"\u23f3 Pending Verification"})]})]})]})]}),(0,p.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,p.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Purchase Information"}),(0,p.jsxs)("div",{className:"space-y-3",children:[(0,p.jsxs)("div",{className:"flex justify-between",children:[(0,p.jsx)("span",{className:"text-gray-600",children:"Property Value:"}),(0,p.jsxs)("span",{className:"font-semibold",children:["\u20a6",null===(k=U.price)||void 0===k?void 0:k.toLocaleString()]})]}),(0,p.jsxs)("div",{className:"flex justify-between",children:[(0,p.jsx)("span",{className:"text-gray-600",children:"Property Type:"}),(0,p.jsx)("span",{className:"font-semibold capitalize",children:null===(_=U.status)||void 0===_?void 0:_.replace("-"," ")})]}),(0,p.jsxs)("div",{className:"flex justify-between",children:[(0,p.jsx)("span",{className:"text-gray-600",children:"Escrow Fee (0.5%):"}),(0,p.jsxs)("span",{className:"font-semibold",children:["\u20a6",Math.round(.005*(U.price||0)).toLocaleString()]})]}),(0,p.jsxs)("div",{className:"flex justify-between border-t pt-3",children:[(0,p.jsx)("span",{className:"text-gray-900 font-semibold",children:"Total Amount:"}),(0,p.jsxs)("span",{className:"font-bold text-lg",children:["\u20a6",Math.round(1.005*(U.price||0)).toLocaleString()]})]})]}),(0,p.jsx)("div",{className:"mt-4 space-y-2",children:(0,p.jsx)(v,{property:U,className:"bg-green-600 hover:bg-green-700"})})]}),(0,p.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,p.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Property Information"}),(0,p.jsxs)("div",{className:"space-y-3",children:[(0,p.jsxs)("div",{className:"flex justify-between",children:[(0,p.jsx)("span",{className:"text-gray-600",children:"Property ID:"}),(0,p.jsx)("span",{className:"font-medium",children:U.id})]}),U.createdAt&&(0,p.jsxs)("div",{className:"flex justify-between",children:[(0,p.jsx)("span",{className:"text-gray-600",children:"Listed:"}),(0,p.jsx)("span",{className:"font-medium",children:(()=>{const e=new Date(U.createdAt);return isNaN(e.getTime())?U.createdAt||U.dateListed||"N/A":e.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})()})]}),(0,p.jsxs)("div",{className:"flex justify-between",children:[(0,p.jsx)("span",{className:"text-gray-600",children:"Status:"}),(0,p.jsx)("span",{className:"font-medium text-green-600",children:"Available"})]}),(0,p.jsxs)("div",{className:"flex justify-between",children:[(0,p.jsx)("span",{className:"text-gray-600",children:"Vendor:"}),(0,p.jsx)("span",{className:"font-medium",children:U.ownerName||"".concat((null===(P=U.owner)||void 0===P?void 0:P.firstName)||(null===(E=U.vendor)||void 0===E?void 0:E.firstName)||""," ").concat((null===(C=U.owner)||void 0===C?void 0:C.lastName)||(null===(q=U.vendor)||void 0===q?void 0:q.lastName)||"").trim()||"Vendor"})]}),(null===(D=U.location)||void 0===D?void 0:D.googleMapsUrl)&&(0,p.jsxs)("div",{className:"border-t pt-4 mt-4",children:[(0,p.jsx)("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Location"}),(0,p.jsx)("div",{className:"space-y-2",children:(0,p.jsxs)("a",{href:U.location.googleMapsUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center w-full px-3 py-2 bg-blue-50 text-blue-700 rounded-md hover:bg-blue-100 transition-colors text-sm",children:[(0,p.jsxs)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,p.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,p.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Show on Google map"]})})]})]})]})]})]})]}),W&&(0,p.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,p.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[(0,p.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,p.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Send Inquiry"}),(0,p.jsx)("button",{onClick:()=>X(!1),className:"text-gray-400 hover:text-gray-600",children:(0,p.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,p.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,p.jsx)("div",{className:"mb-4",children:(0,p.jsxs)("p",{className:"text-sm text-gray-600",children:["Send a message to the property vendor about ",(0,p.jsx)("strong",{children:U.title})]})}),(0,p.jsxs)("div",{className:"space-y-4",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Your Message"}),(0,p.jsx)("textarea",{value:H,onChange:e=>Q(e.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"I'm interested in this property. Could you please provide more information about..."})]}),(0,p.jsxs)("div",{className:"flex gap-3",children:[(0,p.jsx)("button",{onClick:()=>X(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,p.jsx)("button",{onClick:()=>{H.trim()?(c.Ay.success("Inquiry sent successfully! The vendor will contact you soon."),X(!1),Q("")):c.Ay.error("Please enter your message")},className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Send Message"})]})]})]})}),Z&&(0,p.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,p.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[(0,p.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,p.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Schedule Viewing"}),(0,p.jsx)("button",{onClick:()=>G(!1),className:"text-gray-400 hover:text-gray-600",children:(0,p.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,p.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,p.jsxs)("div",{className:"space-y-4",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preferred Date"}),(0,p.jsx)("input",{type:"date",value:K,onChange:e=>Y(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preferred Time"}),(0,p.jsx)("input",{type:"time",value:$,onChange:e=>ee(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,p.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,p.jsx)("button",{onClick:()=>G(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,p.jsx)("button",{onClick:async()=>{var e,t,r;if(!K||!$)return void c.Ay.error("Please select a preferred date and time");const n={id:"viewing-".concat(Date.now()),propertyId:U.id,propertyTitle:U.title,propertyLocation:U.location,userId:M.id,userName:"".concat(M.firstName," ").concat(M.lastName),userEmail:M.email,status:"pending_vendor",requestedAt:(new Date).toISOString(),preferredDate:K,preferredTime:$,message:"",agentContact:U.agent||{name:"Property Agent",phone:"+234-XXX-XXXX",email:"agent@example.com"},projectId:U.id,projectName:U.title,projectLocation:(null===(e=U.location)||void 0===e?void 0:e.address)||U.location||"",buyerName:"".concat(M.firstName," ").concat(M.lastName),buyerEmail:M.email,vendorId:U.vendorId||(null===(t=U.owner)||void 0===t?void 0:t.id)||void 0,vendorEmail:U.vendorEmail||(null===(r=U.owner)||void 0===r?void 0:r.email)||void 0};try{await(0,d.Ix)(n),G(!1),Y(""),ee(""),c.Ay.success("Viewing scheduled! The vendor has been notified."),(0,c.Ay)("Agent: ".concat(n.agentContact.name," | Phone: ").concat(n.agentContact.phone))}catch(s){c.Ay.error("Failed to create request")}},className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:"Confirm"})]})]})]})})]})}},5032(e,t,r){r.d(t,{FH:()=>g,HK:()=>f,Ix:()=>x,o2:()=>y});var n=r(9379),s=r(1692);const i="viewingRequests",o="inspectionActivityLog",a={totalRequests:0,pendingResponses:0,confirmed:0,vendorProposals:0,buyerReschedules:0,cancelledByBuyer:0,cancelledByVendor:0,timeline:[]},l=(e,t)=>{if("undefined"!==typeof window)if("storage"!==e)"function"===typeof window.dispatchEvent&&window.dispatchEvent(new CustomEvent(e,{detail:t}));else try{window.dispatchEvent(new StorageEvent("storage",t))}catch(r){window.dispatchEvent(new CustomEvent("storage",{detail:t}))}},c=()=>{try{return JSON.parse(localStorage.getItem(i)||"[]")}catch(e){return[]}},d=e=>{localStorage.setItem(i,JSON.stringify(e))},m=()=>{try{return JSON.parse(localStorage.getItem(o)||"[]")}catch(e){return[]}},u=(e,t)=>e||t?t?e?"".concat(e," ").concat(t):t:e:"",p=(e,t)=>{if(!e||!t)return;const r=((e,t)=>({action:e,requestId:t.id,propertyTitle:t.propertyTitle||t.projectTitle||t.projectName||t.title||"Property",buyerId:t.buyerId||t.userId,vendorId:t.vendorId,vendorEmail:t.vendorEmail,status:t.status,timestamp:(new Date).toISOString()}))(e,t),i=m();i.unshift(r),i.length>200&&i.pop(),(e=>{localStorage.setItem(o,JSON.stringify(e))})(i),l("inspectionActivity",r),l("inspectionAnalyticsUpdated",r);const a=((e,t,r)=>{const n=[],s=r.propertyTitle,i=t.buyerName||t.userName||"Buyer",o=t.vendorName||t.vendor||t.owner||"Vendor",a=u(t.preferredDate,t.preferredTime),l=u(t.confirmedDate,t.confirmedTime),c=u(t.proposedDate,t.proposedTime),d=(r,a)=>{(t.vendorId||t.vendorEmail)&&n.push({recipientId:t.vendorId,recipientEmail:t.vendorEmail,roles:["vendor"],type:e,title:r,message:a,priority:"medium",metadata:{requestId:t.id,propertyTitle:s,buyerName:i,vendorName:o}})},m=(r,a)=>{(t.buyerId||t.userId||t.buyerEmail||t.userEmail)&&n.push({recipientId:t.buyerId||t.userId,recipientEmail:t.buyerEmail||t.userEmail,roles:["buyer"],type:e,title:r,message:a,priority:"medium",metadata:{requestId:t.id,propertyTitle:s,buyerName:i,vendorName:o}})};switch(e){case"inspection_requested":d("New inspection request","".concat(i," requested to view ").concat(s," ").concat(a?"on ".concat(a):"").trim());break;case"inspection_confirmed":m("Inspection confirmed","".concat(o," confirmed ").concat(s," ").concat(l?"for ".concat(l):"").trim());break;case"vendor_proposed_new_time":m("Vendor proposed new time","".concat(o," suggested ").concat(c||"another slot"," for ").concat(s));break;case"buyer_rescheduled":d("Buyer requested new time","".concat(i," rescheduled ").concat(s," ").concat(a?"to ".concat(a):"").trim());break;case"inspection_cancelled_by_buyer":d("Inspection cancelled by buyer","".concat(i," cancelled ").concat(s));break;case"inspection_cancelled_by_vendor":m("Inspection cancelled by vendor","".concat(o," cancelled ").concat(s));break;case"inspection_declined":m("Inspection declined","".concat(o," declined the request for ").concat(s))}return n})(e,t,r);a.length&&(l("inspectionNotification",{action:e,payload:r,notifications:a,request:t}),function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!e.length||"undefined"===typeof window)return;const t=e.filter(e=>e.recipientId).map(e=>{var t;return{recipientId:e.recipientId,type:e.type,title:e.title,message:e.message,priority:e.priority||"medium",metadata:(0,n.A)((0,n.A)({},e.metadata||{}),{},{source:(null===(t=e.metadata)||void 0===t?void 0:t.source)||"inspection_client_sync"}),data:e.metadata||{}}});t.length&&s.A.createInspectionNotifications(t).then(e=>{null!==e&&void 0!==e&&e.success||console.warn("Failed to persist inspection notifications",e)}).catch(e=>{console.error("Error persisting inspection notifications:",e)})}(a))},v=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=((null===t||void 0===t?void 0:t.status)||r.status||"").toLowerCase();if(!n&&(r.proposedDate||r.proposedTime))return"vendor_proposed_new_time";switch(n){case"accepted":case"confirmed":return"inspection_confirmed";case"proposed_new_time":return"vendor_proposed_new_time";case"buyer_rescheduled":return"buyer_rescheduled";case"cancelled_by_buyer":return"inspection_cancelled_by_buyer";case"cancelled_by_vendor":return"inspection_cancelled_by_vendor";case"declined":return"inspection_declined";default:return e&&e.status!==(null===t||void 0===t?void 0:t.status)?"inspection_status_".concat((null===t||void 0===t?void 0:t.status)||"updated"):null}},h=(e,t,r)=>!(!t&&!r)&&(t&&(null===e||void 0===e?void 0:e.vendorId)===t||r&&(null===e||void 0===e?void 0:e.vendorEmail)===r),g=function(){let{role:e="buyer",userId:t,vendorId:r,vendorEmail:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("undefined"===typeof window)return(0,n.A)({},a);if("buyer"===e&&!t)return(0,n.A)({},a);if("vendor"===e&&!r&&!s)return(0,n.A)({},a);const i=c().filter(n=>{return"buyer"===e?(i=n,!!(o=t)&&((null===i||void 0===i?void 0:i.buyerId)===o||(null===i||void 0===i?void 0:i.userId)===o)):h(n,r||n.vendorId,s);var i,o}),o={totalRequests:i.length,pendingResponses:0,confirmed:0,vendorProposals:0,buyerReschedules:0,cancelledByBuyer:0,cancelledByVendor:0,timeline:[]},l=["pending","pending_vendor","pending_vendor_confirmation"],d=m();i.forEach(e=>{const t=(e.status||"").toLowerCase();l.includes(t)&&(o.pendingResponses+=1),["accepted","confirmed"].includes(t)&&(o.confirmed+=1),"proposed_new_time"===t&&(o.vendorProposals+=1),"buyer_rescheduled"===t&&(o.buyerReschedules+=1),"cancelled_by_buyer"===t&&(o.cancelledByBuyer+=1),["cancelled_by_vendor","declined"].includes(t)&&(o.cancelledByVendor+=1)});const u=Array.from({length:7}).map((n,i)=>{const o=new Date;o.setDate(o.getDate()-(6-i));const a=o.toISOString().slice(0,10),l=d.filter(n=>{return(n=>"buyer"===e?(null===n||void 0===n?void 0:n.buyerId)===t:h(n,r,s))(n)&&((i=n.timestamp)?new Date(i):new Date).toISOString().slice(0,10)===a;var i}).length;return{date:a,count:l}});return o.timeline=u,o},x=async e=>{try{console.log("Using localStorage for creating inspection requests (API unavailable)");const t=c(),r=(0,n.A)((0,n.A)({id:"viewing-".concat(Date.now())},e),{},{createdAt:(new Date).toISOString(),status:"pending"});return t.push(r),d(t),l("viewingsUpdated",{viewingRequest:r,action:"created"}),l("storage",{key:i,newValue:JSON.stringify(t)}),p("inspection_requested",r),r}catch(t){console.error("Error creating inspection request:",t);const r=c(),s=(0,n.A)((0,n.A)({id:"viewing-".concat(Date.now())},e),{},{createdAt:(new Date).toISOString(),status:"pending"});return r.push(s),d(r),l("viewingsUpdated",{viewingRequest:s,action:"created"}),l("storage",{key:i,newValue:JSON.stringify(r)}),p("inspection_requested",s),s}},y=async(e,t)=>{try{console.log("Using localStorage for inspection requests (API unavailable)");const r=c().filter(r=>e&&r.vendorId===e||t&&r.vendorEmail===t);return r.sort((e,t)=>new Date(t.createdAt||0)-new Date(e.createdAt||0)),r}catch(r){console.error("Error listing inspection requests:",r);return c().filter(r=>e&&r.vendorId===e||t&&r.vendorEmail===t).sort((e,t)=>new Date(t.createdAt||0)-new Date(e.createdAt||0))}},f=async(e,t)=>{try{console.log("Using localStorage for updating inspection requests (API unavailable)");const r=c();let s=null;const o=r.map(r=>r.id===e?(s=(0,n.A)((0,n.A)((0,n.A)({},r),t),{},{updatedAt:(new Date).toISOString()}),s):r);if(!s)return d(r),!1;d(o),l("viewingsUpdated",{requestId:e,updates:t,action:"updated"}),l("storage",{key:i,newValue:JSON.stringify(o)});const a=v(r.find(t=>t.id===e),s,t);return a&&p(a,s),!0}catch(r){console.error("Error updating inspection request:",r);const s=c();let o=null;const a=s.map(r=>r.id===e?(o=(0,n.A)((0,n.A)((0,n.A)({},r),t),{},{updatedAt:(new Date).toISOString()}),o):r);if(!o)return d(s),!1;d(a),l("viewingsUpdated",{requestId:e,updates:t,action:"updated"}),l("storage",{key:i,newValue:JSON.stringify(a)});const m=v(s.find(t=>t.id===e),o,t);return m&&p(m,o),!0}}}}]);
//# sourceMappingURL=843.6789b5b2.chunk.js.map