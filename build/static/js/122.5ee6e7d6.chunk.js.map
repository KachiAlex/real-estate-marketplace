{"version":3,"file":"static/js/122.5ee6e7d6.chunk.js","mappings":"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","sources":["pages/Profile.js","services/storageService.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { FaUser, FaCamera, FaTimes, FaUpload } from 'react-icons/fa';\r\nimport axios from 'axios';\r\nimport toast from 'react-hot-toast';\r\nimport storageService from '../services/storageService';\r\nimport { getApiUrl } from '../utils/apiConfig';\r\n\r\nconst Profile = () => {\r\n  const { currentUser, updateUserProfile } = useAuth();\r\n  const user = currentUser;\r\n  const [formData, setFormData] = useState({\r\n    firstName: user?.firstName || '',\r\n    lastName: user?.lastName || '',\r\n    email: user?.email || user?.user?.email || '', // Use login email from auth\r\n    phone: user?.phone || '',\r\n    bio: user?.bio || '',\r\n    avatar: user?.avatar || ''\r\n  });\r\n  const [errors, setErrors] = useState({});\r\n  const [loading, setLoading] = useState(false);\r\n  const [uploadingAvatar, setUploadingAvatar] = useState(false);\r\n  const [avatarPreview, setAvatarPreview] = useState(user?.avatar || null);\r\n  const [success, setSuccess] = useState(false);\r\n  const fileInputRef = useRef(null);\r\n\r\n  // Sync form data and avatar preview when user changes\r\n  // But don't overwrite if we have a preview that's different (user just uploaded)\r\n  useEffect(() => {\r\n    if (user) {\r\n      // Check localStorage for a saved avatar (data URL from local upload)\r\n      let savedAvatar = null;\r\n      try {\r\n        const currentUserData = JSON.parse(localStorage.getItem('currentUser') || '{}');\r\n        if (currentUserData.avatar && currentUserData.avatar.startsWith('data:')) {\r\n          savedAvatar = currentUserData.avatar;\r\n        }\r\n      } catch (e) {\r\n        console.error('Error reading localStorage:', e);\r\n      }\r\n      \r\n      // Prioritize saved local avatar, then user avatar, then empty\r\n      const avatarToUse = savedAvatar || user?.avatar || '';\r\n      \r\n      // Only update avatar if we don't have a preview or if the avatar changed\r\n      const shouldUpdateAvatar = !avatarPreview || (avatarToUse && avatarToUse !== avatarPreview);\r\n      \r\n      setFormData({\r\n        firstName: user?.firstName || '',\r\n        lastName: user?.lastName || '',\r\n        email: user?.email || user?.user?.email || '',\r\n        phone: user?.phone || '',\r\n        bio: user?.bio || '',\r\n        avatar: avatarToUse\r\n      });\r\n      \r\n      if (shouldUpdateAvatar) {\r\n        setAvatarPreview(avatarToUse || null);\r\n      }\r\n    }\r\n  }, [user]);\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      [name]: value\r\n    }));\r\n    \r\n    if (errors[name]) {\r\n      setErrors(prev => ({\r\n        ...prev,\r\n        [name]: ''\r\n      }));\r\n    }\r\n  };\r\n\r\n  const validateForm = () => {\r\n    const newErrors = {};\r\n    if (!formData.firstName) newErrors.firstName = 'First name is required';\r\n    if (!formData.lastName) newErrors.lastName = 'Last name is required';\r\n    // Email validation removed - email cannot be changed\r\n    return newErrors;\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    const newErrors = validateForm();\r\n    \r\n    if (Object.keys(newErrors).length > 0) {\r\n      setErrors(newErrors);\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      // Use avatarPreview if available (from recent upload), otherwise use formData.avatar\r\n      const avatarToSave = avatarPreview && !avatarPreview.startsWith('data:') ? avatarPreview : (formData.avatar || user?.avatar || '');\r\n      \r\n      // Update profile via backend API if available, otherwise use local update\r\n      const token = localStorage.getItem('token');\r\n      if (token) {\r\n        try {\r\n          const response = await axios.put(\r\n            getApiUrl('/auth/profile'),\r\n            {\r\n              firstName: formData.firstName,\r\n              lastName: formData.lastName,\r\n              phone: formData.phone,\r\n              avatar: avatarToSave\r\n            },\r\n            {\r\n              headers: {\r\n                'Authorization': `Bearer ${token}`\r\n              }\r\n            }\r\n          );\r\n          \r\n          if (response.data.success) {\r\n            // Use the avatar from the response if available, otherwise use what we sent\r\n            const updatedAvatar = response.data.user?.avatar || response.data.data?.avatar || avatarToSave;\r\n            await updateUserProfile({\r\n              firstName: formData.firstName,\r\n              lastName: formData.lastName,\r\n              phone: formData.phone,\r\n              avatar: updatedAvatar\r\n            });\r\n            // Update formData and preview to ensure consistency\r\n            setFormData(prev => ({ ...prev, avatar: updatedAvatar }));\r\n            setAvatarPreview(updatedAvatar);\r\n          }\r\n        } catch (apiError) {\r\n          console.error('API update failed, using local update:', apiError);\r\n          // Fallback to local update\r\n          await updateUserProfile({\r\n            firstName: formData.firstName,\r\n            lastName: formData.lastName,\r\n            phone: formData.phone,\r\n            avatar: avatarToSave\r\n          });\r\n          // Update formData and preview\r\n          setFormData(prev => ({ ...prev, avatar: avatarToSave }));\r\n          setAvatarPreview(avatarToSave);\r\n        }\r\n      } else {\r\n        // No token, use local update only\r\n        await updateUserProfile({\r\n          firstName: formData.firstName,\r\n          lastName: formData.lastName,\r\n          phone: formData.phone,\r\n          avatar: avatarToSave\r\n        });\r\n        // Update formData and preview\r\n        setFormData(prev => ({ ...prev, avatar: avatarToSave }));\r\n        setAvatarPreview(avatarToSave);\r\n      }\r\n      \r\n      setSuccess(true);\r\n      setTimeout(() => setSuccess(false), 3000);\r\n    } catch (error) {\r\n      setErrors({ general: error.message });\r\n      toast.error('Failed to update profile');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleAvatarSelect = () => {\r\n    fileInputRef.current?.click();\r\n  };\r\n\r\n  const handleAvatarChange = async (e) => {\r\n    const file = e.target.files[0];\r\n    if (!file) return;\r\n\r\n    // Validate file\r\n    const validTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/webp', 'image/gif'];\r\n    const maxSize = 5 * 1024 * 1024; // 5MB\r\n\r\n    if (!validTypes.includes(file.type)) {\r\n      toast.error('Please select a valid image file (JPEG, PNG, WEBP, or GIF)');\r\n      return;\r\n    }\r\n\r\n    if (file.size > maxSize) {\r\n      toast.error('Image size must be less than 5MB');\r\n      return;\r\n    }\r\n\r\n    // Create preview immediately for better UX and get local data URL\r\n    const localDataUrl = await new Promise((resolve, reject) => {\r\n      const reader = new FileReader();\r\n      reader.onload = (event) => {\r\n        setAvatarPreview(event.target.result);\r\n        resolve(event.target.result);\r\n      };\r\n      reader.onerror = reject;\r\n      reader.readAsDataURL(file);\r\n    });\r\n\r\n    setUploadingAvatar(true);\r\n\r\n    try {\r\n      const userId = user?.id || user?.uid;\r\n\r\n      if (!userId) {\r\n        throw new Error('User not authenticated');\r\n      }\r\n\r\n      const uploadResult = await storageService.uploadUserAvatar(file, userId);\r\n      const avatarUrl = uploadResult.success ? uploadResult.url : localDataUrl;\r\n\r\n      if (!uploadResult.success) {\r\n        console.error('Avatar upload failed:', uploadResult.error);\r\n        toast.error('Upload failed. Using local preview until sync.');\r\n      }\r\n\r\n      const token = localStorage.getItem('token');\r\n      if (token) {\r\n        try {\r\n          await axios.put(\r\n            getApiUrl('/auth/profile'),\r\n            { avatar: avatarUrl },\r\n            {\r\n              headers: {\r\n                Authorization: `Bearer ${token}`\r\n              }\r\n            }\r\n          );\r\n        } catch (apiError) {\r\n          console.error('Backend API update error:', apiError);\r\n        }\r\n      }\r\n\r\n      try {\r\n        const currentUserData = JSON.parse(localStorage.getItem('currentUser') || '{}');\r\n        const updatedUser = { ...currentUserData, avatar: avatarUrl };\r\n        localStorage.setItem('currentUser', JSON.stringify(updatedUser));\r\n      } catch (localError) {\r\n        console.error('Error saving to localStorage:', localError);\r\n      }\r\n\r\n      if (updateUserProfile) {\r\n        await updateUserProfile({ avatar: avatarUrl });\r\n      }\r\n\r\n      setFormData(prev => ({ ...prev, avatar: avatarUrl }));\r\n      setAvatarPreview(avatarUrl);\r\n      toast.success('Profile picture saved');\r\n    } catch (error) {\r\n      console.error('Avatar upload error:', error);\r\n      \r\n      let errorMessage = 'Failed to upload profile picture';\r\n      \r\n      if (error.message?.includes('permission')) {\r\n        errorMessage = 'Storage permission denied. Please check your storage configuration.';\r\n      } else if (error.message) {\r\n        errorMessage = error.message;\r\n      }\r\n      \r\n      toast.error(errorMessage);\r\n      \r\n      // Revert preview on error\r\n      setAvatarPreview(user?.avatar || null);\r\n    } finally {\r\n      setUploadingAvatar(false);\r\n      // Reset file input\r\n      if (fileInputRef.current) {\r\n        fileInputRef.current.value = '';\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleRemoveAvatar = async () => {\r\n    try {\r\n      setFormData(prev => ({ ...prev, avatar: '' }));\r\n      setAvatarPreview(null);\r\n      await updateUserProfile({ avatar: '' });\r\n      toast.success('Profile picture removed');\r\n    } catch (error) {\r\n      console.error('Error removing avatar:', error);\r\n      toast.error('Failed to remove profile picture');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 py-8\">\r\n      <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8\">\r\n        <div className=\"mb-8\">\r\n          <h1 className=\"text-3xl font-bold text-gray-900\">Profile Settings</h1>\r\n          <p className=\"text-gray-600\">Manage your account information</p>\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n          {/* Profile Form */}\r\n          <div className=\"lg:col-span-2\">\r\n            <div className=\"bg-white rounded-lg shadow p-6\">\r\n              <h2 className=\"text-xl font-semibold text-gray-900 mb-6\">Personal Information</h2>\r\n              \r\n              {/* Profile Picture Upload Section */}\r\n              <div className=\"mb-8 pb-8 border-b border-gray-200\">\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-4\">Profile Picture</label>\r\n                <div className=\"flex items-center space-x-6\">\r\n                  {/* Avatar Display */}\r\n                  <div className=\"relative\">\r\n                    <div className=\"w-32 h-32 rounded-full overflow-hidden border-4 border-gray-200 shadow-lg bg-gray-100\">\r\n                      {avatarPreview ? (\r\n                        <img\r\n                          src={avatarPreview}\r\n                          alt=\"Profile\"\r\n                          className=\"w-full h-full object-cover\"\r\n                        />\r\n                      ) : (\r\n                        <div className=\"w-full h-full flex items-center justify-center\">\r\n                          <FaUser className=\"text-4xl text-gray-400\" />\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                    \r\n                    {/* Upload Overlay */}\r\n                    {!uploadingAvatar && (\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={handleAvatarSelect}\r\n                        className=\"absolute bottom-0 right-0 p-2 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-colors shadow-lg\"\r\n                        title=\"Change profile picture\"\r\n                      >\r\n                        <FaCamera className=\"text-sm\" />\r\n                      </button>\r\n                    )}\r\n                    \r\n                    {/* Uploading Indicator */}\r\n                    {uploadingAvatar && (\r\n                      <div className=\"absolute inset-0 rounded-full bg-black bg-opacity-50 flex items-center justify-center\">\r\n                        <div className=\"text-white text-center\">\r\n                          <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-white mx-auto mb-2\"></div>\r\n                          <p className=\"text-xs\">Uploading...</p>\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  \r\n                  {/* Upload Controls */}\r\n                  <div className=\"flex-1\">\r\n                    <div className=\"space-y-3\">\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={handleAvatarSelect}\r\n                        disabled={uploadingAvatar}\r\n                        className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2\"\r\n                      >\r\n                        <FaUpload className=\"text-sm\" />\r\n                        <span>{avatarPreview ? 'Change Picture' : 'Upload Picture'}</span>\r\n                      </button>\r\n                      \r\n                      {avatarPreview && (\r\n                        <button\r\n                          type=\"button\"\r\n                          onClick={handleRemoveAvatar}\r\n                          disabled={uploadingAvatar}\r\n                          className=\"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2\"\r\n                        >\r\n                          <FaTimes className=\"text-sm\" />\r\n                          <span>Remove Picture</span>\r\n                        </button>\r\n                      )}\r\n                      \r\n                      <p className=\"text-xs text-gray-500\">\r\n                        JPG, PNG, WEBP or GIF. Max size 5MB\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  {/* Hidden File Input */}\r\n                  <input\r\n                    ref={fileInputRef}\r\n                    type=\"file\"\r\n                    accept=\"image/jpeg,image/jpg,image/png,image/webp,image/gif\"\r\n                    onChange={handleAvatarChange}\r\n                    className=\"hidden\"\r\n                    disabled={uploadingAvatar}\r\n                  />\r\n                </div>\r\n              </div>\r\n              \r\n              <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n                {errors.general && (\r\n                  <div className=\"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-md\">\r\n                    {errors.general}\r\n                  </div>\r\n                )}\r\n\r\n                {success && (\r\n                  <div className=\"bg-green-50 border border-green-200 text-green-600 px-4 py-3 rounded-md\">\r\n                    Profile updated successfully!\r\n                  </div>\r\n                )}\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">First Name</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      name=\"firstName\"\r\n                      value={formData.firstName}\r\n                      onChange={handleChange}\r\n                      className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${\r\n                        errors.firstName ? 'border-red-300' : 'border-gray-300'\r\n                      }`}\r\n                    />\r\n                    {errors.firstName && <p className=\"mt-1 text-sm text-red-600\">{errors.firstName}</p>}\r\n                  </div>\r\n\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">Last Name</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      name=\"lastName\"\r\n                      value={formData.lastName}\r\n                      onChange={handleChange}\r\n                      className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${\r\n                        errors.lastName ? 'border-red-300' : 'border-gray-300'\r\n                      }`}\r\n                    />\r\n                    {errors.lastName && <p className=\"mt-1 text-sm text-red-600\">{errors.lastName}</p>}\r\n                  </div>\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                    Email <span className=\"text-gray-400 text-xs\">(Cannot be changed)</span>\r\n                  </label>\r\n                  <input\r\n                    type=\"email\"\r\n                    name=\"email\"\r\n                    value={formData.email}\r\n                    readOnly\r\n                    disabled\r\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-gray-600 cursor-not-allowed\"\r\n                  />\r\n                  <p className=\"mt-1 text-xs text-gray-500\">Your email is locked to your login credentials</p>\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">Phone Number</label>\r\n                  <input\r\n                    type=\"tel\"\r\n                    name=\"phone\"\r\n                    value={formData.phone}\r\n                    onChange={handleChange}\r\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                    placeholder=\"(555) 123-4567\"\r\n                  />\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">Bio</label>\r\n                  <textarea\r\n                    name=\"bio\"\r\n                    value={formData.bio}\r\n                    onChange={handleChange}\r\n                    rows={4}\r\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                    placeholder=\"Tell us about yourself...\"\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"flex justify-end\">\r\n                  <button\r\n                    type=\"submit\"\r\n                    disabled={loading}\r\n                    className=\"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50\"\r\n                  >\r\n                    {loading ? 'Saving...' : 'Save Changes'}\r\n                  </button>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Sidebar */}\r\n          <div className=\"lg:col-span-1\">\r\n            {/* Account Info */}\r\n            <div className=\"bg-white rounded-lg shadow p-6 mb-6\">\r\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Account Information</h3>\r\n              <div className=\"space-y-3\">\r\n                <div>\r\n                  <span className=\"text-sm text-gray-500\">Member Since</span>\r\n                  <p className=\"font-medium\">{user?.createdAt ? new Date(user.createdAt).toLocaleDateString() : 'N/A'}</p>\r\n                </div>\r\n                <div>\r\n                  <span className=\"text-sm text-gray-500\">Account Status</span>\r\n                  <p className=\"font-medium text-green-600\">Active</p>\r\n                </div>\r\n                <div>\r\n                  <span className=\"text-sm text-gray-500\">User ID</span>\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <p className=\"font-mono font-bold text-blue-600 text-lg tracking-wider\">{user?.userCode || 'PAK-XXXXXX'}</p>\r\n                    <button\r\n                      onClick={async (e) => {\r\n                        const button = e.currentTarget;\r\n                        const originalText = button.textContent;\r\n                        try {\r\n                          const textToCopy = user?.userCode || '';\r\n                          if (!textToCopy) {\r\n                            toast.error('User ID not available');\r\n                            return;\r\n                          }\r\n                          \r\n                          await navigator.clipboard.writeText(textToCopy);\r\n                          button.textContent = 'Copied!';\r\n                          button.classList.add('bg-green-100', 'text-green-700');\r\n                          button.classList.remove('bg-blue-100', 'text-blue-700');\r\n                          \r\n                          toast.success(`User ID \"${textToCopy}\" copied!`, {\r\n                            icon: '✅',\r\n                            duration: 3000,\r\n                            style: {\r\n                              background: '#10b981',\r\n                              color: '#fff',\r\n                            },\r\n                          });\r\n                          \r\n                          setTimeout(() => {\r\n                            button.textContent = originalText;\r\n                            button.classList.remove('bg-green-100', 'text-green-700');\r\n                            button.classList.add('bg-blue-100', 'text-blue-700');\r\n                          }, 2000);\r\n                        } catch (err) {\r\n                          // Fallback for older browsers\r\n                          const textToCopy = user?.userCode || '';\r\n                          if (!textToCopy) {\r\n                            toast.error('User ID not available');\r\n                            return;\r\n                          }\r\n                          \r\n                          const textArea = document.createElement('textarea');\r\n                          textArea.value = textToCopy;\r\n                          textArea.style.position = 'fixed';\r\n                          textArea.style.opacity = '0';\r\n                          document.body.appendChild(textArea);\r\n                          textArea.select();\r\n                          document.execCommand('copy');\r\n                          document.body.removeChild(textArea);\r\n                          \r\n                          button.textContent = 'Copied!';\r\n                          button.classList.add('bg-green-100', 'text-green-700');\r\n                          button.classList.remove('bg-blue-100', 'text-blue-700');\r\n                          \r\n                          toast.success(`User ID \"${textToCopy}\" copied!`, {\r\n                            icon: '✅',\r\n                            duration: 3000,\r\n                            style: {\r\n                              background: '#10b981',\r\n                              color: '#fff',\r\n                            },\r\n                          });\r\n                          \r\n                          setTimeout(() => {\r\n                            button.textContent = originalText;\r\n                            button.classList.remove('bg-green-100', 'text-green-700');\r\n                            button.classList.add('bg-blue-100', 'text-blue-700');\r\n                          }, 2000);\r\n                        }\r\n                      }}\r\n                      className=\"text-xs bg-blue-100 hover:bg-blue-200 text-blue-700 px-2 py-1 rounded transition-colors\"\r\n                    >\r\n                      Copy\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n                {/* Vendor ID - only shown if user is a vendor */}\r\n                {user?.vendorCode && user?.roles?.includes('vendor') && (\r\n                  <div>\r\n                    <span className=\"text-sm text-gray-500\">Vendor ID</span>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <p className=\"font-mono font-bold text-green-600 text-lg tracking-wider\">{user.vendorCode}</p>\r\n                      <button\r\n                        onClick={async (e) => {\r\n                          const button = e.currentTarget;\r\n                          const originalText = button.textContent;\r\n                          try {\r\n                            const textToCopy = user.vendorCode || '';\r\n                            if (!textToCopy) {\r\n                              toast.error('Vendor ID not available');\r\n                              return;\r\n                            }\r\n                            \r\n                            await navigator.clipboard.writeText(textToCopy);\r\n                            button.textContent = 'Copied!';\r\n                            button.classList.add('bg-blue-100', 'text-blue-700');\r\n                            button.classList.remove('bg-green-100', 'text-green-700');\r\n                            \r\n                            toast.success(`Vendor ID \"${textToCopy}\" copied!`, {\r\n                              icon: '✅',\r\n                              duration: 3000,\r\n                              style: {\r\n                                background: '#10b981',\r\n                                color: '#fff',\r\n                              },\r\n                            });\r\n                            \r\n                            setTimeout(() => {\r\n                              button.textContent = originalText;\r\n                              button.classList.remove('bg-blue-100', 'text-blue-700');\r\n                              button.classList.add('bg-green-100', 'text-green-700');\r\n                            }, 2000);\r\n                          } catch (err) {\r\n                            // Fallback for older browsers\r\n                            const textToCopy = user.vendorCode || '';\r\n                            if (!textToCopy) {\r\n                              toast.error('Vendor ID not available');\r\n                              return;\r\n                            }\r\n                            \r\n                            const textArea = document.createElement('textarea');\r\n                            textArea.value = textToCopy;\r\n                            textArea.style.position = 'fixed';\r\n                            textArea.style.opacity = '0';\r\n                            document.body.appendChild(textArea);\r\n                            textArea.select();\r\n                            document.execCommand('copy');\r\n                            document.body.removeChild(textArea);\r\n                            \r\n                            button.textContent = 'Copied!';\r\n                            button.classList.add('bg-blue-100', 'text-blue-700');\r\n                            button.classList.remove('bg-green-100', 'text-green-700');\r\n                            \r\n                            toast.success(`Vendor ID \"${textToCopy}\" copied!`, {\r\n                              icon: '✅',\r\n                              duration: 3000,\r\n                              style: {\r\n                                background: '#10b981',\r\n                                color: '#fff',\r\n                              },\r\n                            });\r\n                            \r\n                            setTimeout(() => {\r\n                              button.textContent = originalText;\r\n                              button.classList.remove('bg-blue-100', 'text-blue-700');\r\n                              button.classList.add('bg-green-100', 'text-green-700');\r\n                            }, 2000);\r\n                          }\r\n                        }}\r\n                        className=\"text-xs bg-green-100 hover:bg-green-200 text-green-700 px-2 py-1 rounded transition-colors\"\r\n                      >\r\n                        Copy\r\n                      </button>\r\n                    </div>\r\n                    <p className=\"text-xs text-gray-500 mt-1\">Share this with buyers to find your properties</p>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Quick Actions */}\r\n            <div className=\"bg-white rounded-lg shadow p-6\">\r\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Quick Actions</h3>\r\n              <div className=\"space-y-3\">\r\n                <button className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md\">\r\n                  Change Password\r\n                </button>\r\n                <button className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md\">\r\n                  Notification Settings\r\n                </button>\r\n                <button className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md\">\r\n                  Privacy Settings\r\n                </button>\r\n                <button className=\"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md\">\r\n                  Delete Account\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Profile; ","class StorageService {\r\n  async uploadFile(file, path, metadata = {}) {\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append('file', file);\r\n      formData.append('uploadType', 'generic');\r\n      formData.append('metadata', JSON.stringify({ path, ...metadata }));\r\n\r\n      const response = await fetch('/api/upload', {\r\n        method: 'POST',\r\n        headers: {\r\n          Authorization: `Bearer ${localStorage.getItem('token') || ''}`\r\n        },\r\n        body: formData\r\n      });\r\n\r\n      const result = await response.json();\r\n      if (!response.ok || !result?.success) {\r\n        throw new Error(result?.message || 'Upload failed');\r\n      }\r\n\r\n      return {\r\n        success: true,\r\n        url: result.data?.url,\r\n        path: result.data?.publicId || path,\r\n        name: result.data?.originalName || file.name,\r\n        size: result.data?.size || file.size,\r\n        type: result.data?.format || file.type\r\n      };\r\n    } catch (error) {\r\n      console.error('Error uploading file:', error);\r\n      return {\r\n        success: false,\r\n        error: error.message || 'Upload failed'\r\n      };\r\n    }\r\n  }\r\n\r\n  async uploadMultipleFiles(files, basePath, metadata = {}) {\r\n    try {\r\n      const formData = new FormData();\r\n      files.forEach((file) => formData.append('files', file));\r\n      formData.append('uploadType', 'multiple');\r\n      formData.append('metadata', JSON.stringify({ basePath, ...metadata }));\r\n\r\n      const response = await fetch('/api/upload/multiple', {\r\n        method: 'POST',\r\n        headers: {\r\n          Authorization: `Bearer ${localStorage.getItem('token') || ''}`\r\n        },\r\n        body: formData\r\n      });\r\n\r\n      const result = await response.json();\r\n      if (!response.ok || !result?.success) {\r\n        throw new Error(result?.message || 'Upload failed');\r\n      }\r\n\r\n      return {\r\n        success: true,\r\n        successful: result.data?.successful || [],\r\n        failed: result.data?.failed || [],\r\n        total: result.data?.total || files.length\r\n      };\r\n    } catch (error) {\r\n      console.error('Error uploading multiple files:', error);\r\n      return {\r\n        success: false,\r\n        error: error.message || 'Upload failed'\r\n      };\r\n    }\r\n  }\r\n\r\n  async moveFile(oldPath, newPath) {\r\n    return {\r\n      success: true,\r\n      url: null,\r\n      path: newPath || oldPath,\r\n      name: (newPath || oldPath || '').split('/').pop()\r\n    };\r\n  }\r\n\r\n  async uploadPropertyImages(files, propertyId, userId) {\r\n    try {\r\n      const formData = new FormData();\r\n      files.forEach((file) => {\r\n        formData.append('files', file);\r\n      });\r\n      formData.append('uploadType', 'property_images');\r\n      formData.append('metadata', JSON.stringify({\r\n        propertyId,\r\n        userId\r\n      }));\r\n\r\n      const response = await fetch('/api/upload/multiple', {\r\n        method: 'POST',\r\n        headers: {\r\n          Authorization: `Bearer ${localStorage.getItem('token') || ''}`\r\n        },\r\n        body: formData\r\n      });\r\n\r\n      const result = await response.json();\r\n      if (!response.ok || !result?.success) {\r\n        throw new Error(result?.message || 'Upload failed');\r\n      }\r\n\r\n      return {\r\n        success: true,\r\n        successful: result.data?.successful || [],\r\n        failed: result.data?.failed || [],\r\n        total: result.data?.total || files.length\r\n      };\r\n    } catch (error) {\r\n      console.error('Error uploading property images:', error);\r\n      return {\r\n        success: false,\r\n        error: error.message || 'Upload failed'\r\n      };\r\n    }\r\n  }\r\n\r\n  async uploadUserAvatar(file, userId) {\r\n    if (!userId) {\r\n      return { success: false, error: 'User ID is required' };\r\n    }\r\n\r\n    const timestamp = Date.now();\r\n    const fileExtension = file.name.split('.').pop();\r\n    const fileName = `avatar_${userId}_${timestamp}.${fileExtension}`;\r\n    const path = `users/${userId}/avatar/${fileName}`;\r\n\r\n    const validation = this.validateFile(file, ['image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/webp'], 5 * 1024 * 1024);\r\n    if (!validation.valid) {\r\n      return {\r\n        success: false,\r\n        error: validation.errors.join(', ')\r\n      };\r\n    }\r\n\r\n    const result = await this.uploadFile(file, path, { userId });\r\n    if (result.success) {\r\n      const avatarInfo = {\r\n        userId,\r\n        avatarUrl: result.url,\r\n        uploadDate: new Date().toISOString(),\r\n        fileName: result.name\r\n      };\r\n      localStorage.setItem(`user_avatar_${userId}`, JSON.stringify(avatarInfo));\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  getFallbackAvatar(userId) {\r\n    const mockAvatarUrl = `https://ui-avatars.com/api/?name=${encodeURIComponent(userId)}&background=random&size=200`;\r\n\r\n    const avatarInfo = {\r\n      userId,\r\n      avatarUrl: mockAvatarUrl,\r\n      uploadDate: new Date().toISOString(),\r\n      fileName: 'fallback_avatar',\r\n      isFallback: true\r\n    };\r\n\r\n    localStorage.setItem(`user_avatar_${userId}`, JSON.stringify(avatarInfo));\r\n\r\n    return {\r\n      success: true,\r\n      url: mockAvatarUrl,\r\n      path: `users/${userId}/avatar/fallback_${Date.now()}`,\r\n      name: 'fallback_avatar',\r\n      size: 0,\r\n      type: 'image/png',\r\n      isFallback: true\r\n    };\r\n  }\r\n\r\n  async uploadEscrowDocument(file, escrowId, documentType, userId) {\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append('file', file);\r\n      formData.append('uploadType', 'escrow_document');\r\n      formData.append('metadata', JSON.stringify({\r\n        escrowId,\r\n        documentType,\r\n        userId\r\n      }));\r\n\r\n      const response = await fetch('/api/upload', {\r\n        method: 'POST',\r\n        headers: {\r\n          Authorization: `Bearer ${localStorage.getItem('token') || ''}`\r\n        },\r\n        body: formData\r\n      });\r\n\r\n      const result = await response.json();\r\n      if (!response.ok || !result?.success) {\r\n        throw new Error(result?.message || 'Upload failed');\r\n      }\r\n\r\n      return {\r\n        success: true,\r\n        url: result.data?.url,\r\n        path: result.data?.publicId,\r\n        name: result.data?.originalName,\r\n        size: result.data?.size,\r\n        type: result.data?.format\r\n      };\r\n    } catch (error) {\r\n      console.error('Error uploading escrow document:', error);\r\n      return {\r\n        success: false,\r\n        error: error.message || 'Upload failed'\r\n      };\r\n    }\r\n  }\r\n\r\n  async deleteFile() {\r\n    return { success: false, error: 'Delete is not supported in this build.' };\r\n  }\r\n\r\n  async getFileMetadata() {\r\n    return { success: false, error: 'Metadata lookup is not supported in this build.' };\r\n  }\r\n\r\n  async listFiles() {\r\n    return { success: false, error: 'Listing files is not supported in this build.' };\r\n  }\r\n\r\n  async getPropertyImages() {\r\n    return { success: false, error: 'Listing images is not supported in this build.' };\r\n  }\r\n\r\n  async getEscrowDocuments() {\r\n    return { success: false, error: 'Listing documents is not supported in this build.' };\r\n  }\r\n\r\n  validateFile(file, allowedTypes = [], maxSize = 5 * 1024 * 1024) {\r\n    const errors = [];\r\n\r\n    if (allowedTypes.length > 0 && !allowedTypes.includes(file.type)) {\r\n      errors.push(`File type ${file.type} is not allowed. Allowed types: ${allowedTypes.join(', ')}`);\r\n    }\r\n\r\n    if (file.size > maxSize) {\r\n      errors.push(`File size ${(file.size / 1024 / 1024).toFixed(2)}MB exceeds maximum allowed size of ${(maxSize / 1024 / 1024).toFixed(2)}MB`);\r\n    }\r\n\r\n    return {\r\n      valid: errors.length === 0,\r\n      errors\r\n    };\r\n  }\r\n\r\n  formatFileSize(bytes) {\r\n    if (bytes === 0) return '0 Bytes';\r\n\r\n    const k = 1024;\r\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n\r\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\r\n  }\r\n}\r\n\r\nconst storageService = new StorageService();\r\nexport default storageService;\r\n"],"names":["Profile","_user$user","_user$roles","currentUser","updateUserProfile","useAuth","user","formData","setFormData","useState","firstName","lastName","email","phone","bio","avatar","errors","setErrors","loading","setLoading","uploadingAvatar","setUploadingAvatar","avatarPreview","setAvatarPreview","success","setSuccess","fileInputRef","useRef","useEffect","_user$user2","savedAvatar","currentUserData","JSON","parse","localStorage","getItem","startsWith","e","console","error","avatarToUse","shouldUpdateAvatar","handleChange","name","value","target","prev","_objectSpread","handleAvatarSelect","_fileInputRef$current","current","click","_jsx","className","children","_jsxs","src","alt","FaUser","type","onClick","title","FaCamera","disabled","FaUpload","async","toast","FaTimes","ref","accept","onChange","file","files","includes","size","localDataUrl","Promise","resolve","reject","reader","FileReader","onload","event","result","onerror","readAsDataURL","userId","id","uid","Error","uploadResult","storageService","uploadUserAvatar","avatarUrl","url","token","axios","put","getApiUrl","headers","Authorization","concat","apiError","updatedUser","setItem","stringify","localError","_error$message","errorMessage","message","onSubmit","preventDefault","newErrors","validateForm","Object","keys","length","avatarToSave","response","data","_response$data$user","_response$data$data","updatedAvatar","setTimeout","general","readOnly","placeholder","rows","createdAt","Date","toLocaleDateString","userCode","button","currentTarget","originalText","textContent","textToCopy","navigator","clipboard","writeText","classList","add","remove","icon","duration","style","background","color","err","textArea","document","createElement","position","opacity","body","appendChild","select","execCommand","removeChild","vendorCode","roles","uploadFile","path","metadata","arguments","undefined","_result$data","_result$data2","_result$data3","_result$data4","_result$data5","FormData","append","fetch","method","json","ok","publicId","originalName","format","uploadMultipleFiles","basePath","_result$data6","_result$data7","_result$data8","forEach","successful","failed","total","moveFile","oldPath","newPath","split","pop","uploadPropertyImages","propertyId","_result$data9","_result$data0","_result$data1","timestamp","now","fileExtension","fileName","validation","this","validateFile","valid","join","avatarInfo","uploadDate","toISOString","getFallbackAvatar","mockAvatarUrl","encodeURIComponent","isFallback","uploadEscrowDocument","escrowId","documentType","_result$data10","_result$data11","_result$data12","_result$data13","_result$data14","deleteFile","getFileMetadata","listFiles","getPropertyImages","getEscrowDocuments","allowedTypes","maxSize","push","toFixed","formatFileSize","bytes","i","Math","floor","log","parseFloat","pow"],"sourceRoot":""}