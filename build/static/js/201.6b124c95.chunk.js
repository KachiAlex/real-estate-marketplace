"use strict";(self.webpackChunkreal_estate_marketplace=self.webpackChunkreal_estate_marketplace||[]).push([[201],{6201(e,s,t){t.r(s),t.d(s,{default:()=>h});var a=t(5043),l=t(3216),n=t(5016),r=t(9379),c=t(3484),i=t(5369);const d=e=>{const s=new Date,t=new Date(e)-s;return Math.ceil(t/864e5)};var o=t(2339),x=t(579);const m=e=>{let{mortgageId:s,onPaymentSuccess:t,onClose:d}=e;const{user:m}=(0,n.As)(),{getMortgageById:g,makePayment:h}=(0,c.Q)(),u=(0,l.Zp)(),[y,p]=(0,a.useState)(1),[j,b]=(0,a.useState)("flutterwave"),[N,f]=(0,a.useState)({cardNumber:"",expiryDate:"",cvv:"",cardholderName:""}),[v,w]=(0,a.useState)(!1),[P,S]=(0,a.useState)(!1),D=g(s);if(!D)return(0,x.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,x.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[(0,x.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Mortgage Not Found"}),(0,x.jsx)("p",{className:"text-gray-600 mb-4",children:"The requested mortgage could not be found."}),(0,x.jsx)("button",{onClick:d,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:"Close"})]})});const C=(e,s)=>{f(t=>(0,r.A)((0,r.A)({},t),{},{[e]:s}))};return(0,x.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,x.jsxs)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,x.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:"Mortgage Payment"}),(0,x.jsx)("button",{onClick:d,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,x.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,x.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,x.jsxs)("div",{className:"p-6",children:[1===y&&(0,x.jsxs)("div",{className:"space-y-6",children:[(0,x.jsx)("div",{className:"bg-blue-50 rounded-lg p-4",children:(0,x.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,x.jsx)(i.rQ8,{className:"text-blue-600 text-xl"}),(0,x.jsxs)("div",{children:[(0,x.jsx)("h4",{className:"font-semibold text-blue-900",children:D.propertyTitle}),(0,x.jsx)("p",{className:"text-blue-700 text-sm",children:D.propertyLocation})]})]})}),(0,x.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,x.jsx)("h4",{className:"font-semibold text-gray-900 mb-3",children:"Payment Details"}),(0,x.jsxs)("div",{className:"space-y-2",children:[(0,x.jsxs)("div",{className:"flex justify-between",children:[(0,x.jsx)("span",{className:"text-gray-600",children:"Monthly Payment:"}),(0,x.jsxs)("span",{className:"font-semibold text-gray-900",children:["\u20a6",D.monthlyPayment.toLocaleString()]})]}),(0,x.jsxs)("div",{className:"flex justify-between",children:[(0,x.jsx)("span",{className:"text-gray-600",children:"Due Date:"}),(0,x.jsx)("span",{className:"font-semibold text-gray-900",children:new Date(D.nextPaymentDate).toLocaleDateString()})]}),(0,x.jsxs)("div",{className:"flex justify-between",children:[(0,x.jsx)("span",{className:"text-gray-600",children:"Payment #:"}),(0,x.jsxs)("span",{className:"font-semibold text-gray-900",children:[D.paymentsMade+1," of ",D.totalPayments]})]})]})]}),(0,x.jsx)("div",{className:"bg-green-50 rounded-lg p-4",children:(0,x.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,x.jsx)(i.JhU,{className:"text-green-600 text-xl"}),(0,x.jsxs)("div",{children:[(0,x.jsx)("h4",{className:"font-semibold text-green-900",children:"Secure Payment"}),(0,x.jsx)("p",{className:"text-green-700 text-sm",children:"Your payment is protected by bank-level security"})]})]})}),(0,x.jsx)("button",{onClick:()=>{p(2)},className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"Continue to Payment"})]}),2===y&&(0,x.jsxs)("div",{className:"space-y-6",children:[(0,x.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,x.jsx)("button",{onClick:()=>p(1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,x.jsx)(i.QVr,{className:"text-lg"})}),(0,x.jsx)("h4",{className:"text-lg font-semibold text-gray-900",children:"Payment Method"})]}),(0,x.jsxs)("div",{className:"space-y-3",children:[(0,x.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,x.jsx)("input",{type:"radio",id:"flutterwave",name:"paymentMethod",value:"flutterwave",checked:"flutterwave"===j,onChange:e=>b(e.target.value),className:"text-blue-600"}),(0,x.jsxs)("label",{htmlFor:"flutterwave",className:"flex items-center space-x-3 cursor-pointer",children:[(0,x.jsx)(i.x1c,{className:"text-blue-600"}),(0,x.jsx)("span",{className:"font-medium",children:"Pay with Flutterwave"})]})]}),(0,x.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,x.jsx)("input",{type:"radio",id:"card",name:"paymentMethod",value:"card",checked:"card"===j,onChange:e=>b(e.target.value),className:"text-blue-600"}),(0,x.jsxs)("label",{htmlFor:"card",className:"flex items-center space-x-3 cursor-pointer",children:[(0,x.jsx)(i.x1c,{className:"text-gray-600"}),(0,x.jsx)("span",{className:"font-medium",children:"Credit/Debit Card"})]})]})]}),"card"===j&&(0,x.jsxs)("div",{className:"space-y-4 p-4 bg-gray-50 rounded-lg",children:[(0,x.jsx)("h5",{className:"font-semibold text-gray-900",children:"Card Details"}),(0,x.jsxs)("div",{className:"space-y-3",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Card Number"}),(0,x.jsx)("input",{type:"text",value:N.cardNumber,onChange:e=>C("cardNumber",(e=>{const s=e.replace(/\s+/g,"").replace(/[^0-9]/gi,""),t=s.match(/\d{4,16}/g),a=t&&t[0]||"",l=[];for(let n=0,r=a.length;n<r;n+=4)l.push(a.substring(n,n+4));return l.length?l.join(" "):s})(e.target.value)),placeholder:"1234 5678 9012 3456",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",maxLength:19})]}),(0,x.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expiry Date"}),(0,x.jsx)("input",{type:"text",value:N.expiryDate,onChange:e=>C("expiryDate",(e=>{const s=e.replace(/\s+/g,"").replace(/[^0-9]/gi,"");return s.length>=2?s.substring(0,2)+"/"+s.substring(2,4):s})(e.target.value)),placeholder:"MM/YY",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",maxLength:5})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CVV"}),(0,x.jsx)("input",{type:"text",value:N.cvv,onChange:e=>C("cvv",e.target.value.replace(/\D/g,"")),placeholder:"123",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",maxLength:4})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cardholder Name"}),(0,x.jsx)("input",{type:"text",value:N.cardholderName,onChange:e=>C("cardholderName",e.target.value),placeholder:"John Doe",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),(0,x.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,x.jsx)("h5",{className:"font-semibold text-gray-900 mb-3",children:"Payment Summary"}),(0,x.jsxs)("div",{className:"space-y-2",children:[(0,x.jsxs)("div",{className:"flex justify-between",children:[(0,x.jsx)("span",{className:"text-gray-600",children:"Monthly Payment:"}),(0,x.jsxs)("span",{className:"font-semibold text-gray-900",children:["\u20a6",D.monthlyPayment.toLocaleString()]})]}),(0,x.jsxs)("div",{className:"flex justify-between",children:[(0,x.jsx)("span",{className:"text-gray-600",children:"Processing Fee:"}),(0,x.jsx)("span",{className:"font-semibold text-gray-900",children:"\u20a60"})]}),(0,x.jsx)("hr",{className:"border-gray-300"}),(0,x.jsxs)("div",{className:"flex justify-between",children:[(0,x.jsx)("span",{className:"font-semibold text-gray-900",children:"Total:"}),(0,x.jsxs)("span",{className:"font-semibold text-gray-900",children:["\u20a6",D.monthlyPayment.toLocaleString()]})]})]})]}),(0,x.jsx)("button",{onClick:async()=>{try{if("card"===j&&(!N.cardNumber||!N.expiryDate||!N.cvv||!N.cardholderName))return void o.Ay.error("Please fill in all payment details");w(!0),await new Promise(e=>setTimeout(e,2e3));const e=await h(D.id,D.monthlyPayment,j);e.success?(S(!0),p(3),t&&t(e.payment,e.mortgage)):o.Ay.error(e.error||"Payment failed")}catch(e){console.error("Payment error:",e),o.Ay.error("Payment processing failed")}finally{w(!1)}},disabled:v,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:v?"Processing Payment...":"Pay \u20a6"+D.monthlyPayment.toLocaleString()})]}),3===y&&P&&(0,x.jsxs)("div",{className:"space-y-6 text-center",children:[(0,x.jsx)("div",{className:"flex justify-center",children:(0,x.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center",children:(0,x.jsx)(i.CMH,{className:"text-green-600 text-2xl"})})}),(0,x.jsxs)("div",{children:[(0,x.jsx)("h4",{className:"text-xl font-bold text-gray-900 mb-2",children:"Payment Successful!"}),(0,x.jsxs)("p",{className:"text-gray-600",children:["Your mortgage payment of \u20a6",D.monthlyPayment.toLocaleString()," has been processed successfully."]})]}),(0,x.jsxs)("div",{className:"bg-green-50 rounded-lg p-4",children:[(0,x.jsxs)("div",{className:"flex items-center justify-center space-x-3 mb-2",children:[(0,x.jsx)(i.itz,{className:"text-green-600"}),(0,x.jsx)("span",{className:"font-semibold text-green-900",children:"Next Payment Due"})]}),(0,x.jsxs)("p",{className:"text-green-700",children:[new Date(D.nextPaymentDate).toLocaleDateString()," - \u20a6",D.monthlyPayment.toLocaleString()]})]}),(0,x.jsxs)("div",{className:"flex space-x-3",children:[(0,x.jsx)("button",{onClick:d,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:"Close"}),(0,x.jsx)("button",{onClick:()=>u("/mortgage"),className:"flex-1 bg-gray-600 text-white py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors",children:"View Mortgages"})]})]})]})]})})};const g=()=>{const{getUserMortgages:e,getUpcomingPayments:s,getPaymentSummary:t,enableAutoPay:n,disableAutoPay:g}=(0,c.Q)(),[h,u]=(0,a.useState)(!1),[y,p]=(0,a.useState)(null),[j,b]=(0,a.useState)({}),[N,f]=(0,a.useState)(!1),v=(0,l.Zp)(),w=e(),P=s(),S=t(),D=e=>{p(e),u(!0)},C=e=>{b(s=>(0,r.A)((0,r.A)({},s),{},{[e]:!s[e]}))},L=e=>e<=0?"Overdue":e<=7?"Due Soon":e<=14?"Upcoming":"Scheduled";return 0===w.length?(0,x.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,x.jsxs)("div",{className:"text-center py-8",children:[(0,x.jsx)(i.rQ8,{className:"text-gray-300 text-4xl mx-auto mb-3"}),(0,x.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Active Mortgages"}),(0,x.jsx)("p",{className:"text-gray-600 mb-4",children:"You don't have any active mortgage accounts."}),(0,x.jsx)("button",{onClick:()=>window.location.href="/mortgage",className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Apply for Mortgage"})]})}):(0,x.jsxs)("div",{className:"space-y-6",children:[(0,x.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,x.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:"Active Mortgages"}),(0,x.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:S.activeMortgages})]}),(0,x.jsx)(i.rQ8,{className:"text-blue-600 text-xl"})]})}),(0,x.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:"Monthly Payments"}),(0,x.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["\u20a6",S.totalMonthlyPayments.toLocaleString()]})]}),(0,x.jsx)(i.MxO,{className:"text-green-600 text-xl"})]})}),(0,x.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:"Total Paid"}),(0,x.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["\u20a6",S.totalPaid.toLocaleString()]})]}),(0,x.jsx)(i.A7C,{className:"text-purple-600 text-xl"})]})})]}),P.length>0&&(0,x.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,x.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,x.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[(0,x.jsx)(i.itz,{className:"mr-2 text-blue-600"}),"Upcoming Payments"]})}),(0,x.jsx)("div",{className:"p-6",children:(0,x.jsx)("div",{className:"space-y-4",children:P.map(e=>{return(0,x.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,x.jsxs)("div",{className:"flex-1",children:[(0,x.jsx)("h4",{className:"font-medium text-gray-900",children:e.mortgageTitle||e.propertyTitle}),(0,x.jsx)("p",{className:"text-sm text-gray-600",children:e.mortgageLocation||e.propertyLocation}),(0,x.jsxs)("p",{className:"text-sm text-gray-600",children:["Due: ",new Date(e.dueDate).toLocaleDateString()]})]}),(0,x.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,x.jsxs)("div",{className:"text-right",children:[(0,x.jsxs)("p",{className:"font-semibold text-gray-900",children:["\u20a6",e.paymentAmount.toLocaleString()]}),(0,x.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full ".concat((s=e.daysUntilPayment,s<=0?"text-red-600 bg-red-100":s<=7?"text-orange-600 bg-orange-100":s<=14?"text-yellow-600 bg-yellow-100":"text-green-600 bg-green-100")),children:L(e.daysUntilPayment)}),e.payment&&(0,x.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[e.daysUntilPayment," days away"]})]}),(0,x.jsxs)("button",{onClick:()=>{const s=w.find(s=>s.id===e.mortgageId);s&&D(s)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[(0,x.jsx)(i.x1c,{}),(0,x.jsx)("span",{children:"Pay Now"})]})]})]},e.mortgageId);var s})})})]}),(0,x.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,x.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,x.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Your Mortgages"})}),(0,x.jsx)("div",{className:"p-6",children:(0,x.jsx)("div",{className:"space-y-6",children:w.map(e=>{const s=(e=>{const s=e.totalPayments*e.monthlyPayment-e.loanAmount,t=e.paymentsMade*e.monthlyPayment,a=(e.totalPayments-e.paymentsMade)*e.monthlyPayment,l=e.paymentHistory.reduce((s,t)=>{var a;const l=null===(a=e.paymentSchedule)||void 0===a?void 0:a.find(e=>e.paymentNumber===t.paymentNumber);return s+((null===l||void 0===l?void 0:l.interest)||0)},0);return{totalInterest:s,totalPaid:t,remainingBalance:a,interestPaid:l,principalPaid:t-l,percentagePaid:(e.paymentsMade/e.totalPayments*100).toFixed(1)}})(e);return(0,x.jsxs)("div",{className:"border border-gray-200 rounded-lg p-6",children:[(0,x.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,x.jsxs)("div",{className:"flex-1",children:[(0,x.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-1",children:e.propertyTitle}),(0,x.jsx)("p",{className:"text-gray-600 mb-2",children:e.propertyLocation}),(0,x.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[(0,x.jsxs)("span",{children:["Loan: \u20a6",e.loanAmount.toLocaleString()]}),(0,x.jsxs)("span",{children:["Rate: ",e.interestRate,"%"]}),(0,x.jsxs)("span",{children:["Term: ",e.loanTerm," years"]})]})]}),(0,x.jsx)("span",{className:"inline-flex px-3 py-1 text-sm font-medium rounded-full ".concat("active"===e.status?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.status})]}),(0,x.jsx)("div",{className:"bg-blue-50 rounded-lg p-4 mb-4",children:(0,x.jsxs)("div",{className:"flex items-start",children:[(0,x.jsx)(i.__w,{className:"text-blue-600 mt-1 mr-2"}),(0,x.jsxs)("div",{className:"flex-1",children:[(0,x.jsx)("p",{className:"text-sm font-medium text-blue-900 mb-2",children:"Financial Overview"}),(0,x.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("span",{className:"text-blue-700",children:"Principal Paid:"}),(0,x.jsxs)("p",{className:"font-semibold text-blue-900",children:["\u20a6",s.principalPaid.toLocaleString()]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("span",{className:"text-blue-700",children:"Interest Paid:"}),(0,x.jsxs)("p",{className:"font-semibold text-blue-900",children:["\u20a6",s.interestPaid.toLocaleString()]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("span",{className:"text-blue-700",children:"Remaining Balance:"}),(0,x.jsxs)("p",{className:"font-semibold text-blue-900",children:["\u20a6",s.remainingBalance.toLocaleString()]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("span",{className:"text-blue-700",children:"Completion:"}),(0,x.jsxs)("p",{className:"font-semibold text-blue-900",children:[s.percentagePaid,"%"]})]})]})]})]})}),(0,x.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[(0,x.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,x.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,x.jsx)(i.MxO,{className:"text-green-600"}),(0,x.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Monthly Payment"})]}),(0,x.jsxs)("p",{className:"text-xl font-bold text-gray-900",children:["\u20a6",e.monthlyPayment.toLocaleString()]}),e.paymentSchedule&&e.paymentSchedule.length>0&&(0,x.jsxs)("button",{onClick:()=>C(e.id),className:"text-xs text-blue-600 hover:underline mt-2 flex items-center",children:[(0,x.jsx)(i.OKX,{className:"mr-1"}),"View Schedule"]})]}),(0,x.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,x.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,x.jsx)(i.itz,{className:"text-blue-600"}),(0,x.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Next Payment"})]}),(0,x.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:new Date(e.nextPaymentDate).toLocaleDateString()}),e.paymentSchedule&&e.paymentSchedule.length>0&&e.paymentSchedule.find(e=>"pending"===e.status)&&(0,x.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[d(e.paymentSchedule.find(e=>"pending"===e.status).dueDate)," days away"]})]}),(0,x.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,x.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,x.jsx)(i.YYR,{className:"text-purple-600"}),(0,x.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Progress"})]}),(0,x.jsxs)("p",{className:"text-lg font-semibold text-gray-900",children:[e.paymentsMade,"/",e.totalPayments]}),(0,x.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-1",children:(0,x.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all",style:{width:"".concat(s.percentagePaid,"%")}})})]})]}),j[e.id]&&e.paymentSchedule&&(0,x.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,x.jsxs)("h5",{className:"font-semibold text-gray-900 flex items-center",children:[(0,x.jsx)(i.OKX,{className:"mr-2"}),"Payment Schedule"]}),(0,x.jsx)("button",{onClick:()=>C(e.id),className:"text-sm text-blue-600 hover:underline",children:"Hide"})]}),(0,x.jsxs)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[e.paymentSchedule.slice(0,12).map(e=>(0,x.jsxs)("div",{className:"flex items-center justify-between py-2 px-3 bg-white rounded border",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("span",{className:"font-medium text-sm",children:"down-payment"===e.type?"Down Payment":"Payment #".concat(e.paymentNumber)}),(0,x.jsxs)("p",{className:"text-xs text-gray-500",children:["Due: ",new Date(e.dueDate).toLocaleDateString(),e.principal&&e.interest&&(0,x.jsxs)("span",{className:"ml-2",children:["(\u20a6",e.principal.toLocaleString()," principal, \u20a6",e.interest.toLocaleString()," interest)"]})]})]}),(0,x.jsxs)("div",{className:"text-right",children:[(0,x.jsxs)("p",{className:"font-semibold text-sm",children:["\u20a6",e.amount.toLocaleString()]}),(0,x.jsx)("span",{className:"inline-flex px-2 py-0.5 text-xs rounded-full ".concat("paid"===e.status?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.status})]})]},e.id)),e.paymentSchedule.length>12&&(0,x.jsxs)("p",{className:"text-sm text-gray-500 text-center py-2",children:["+ ",e.paymentSchedule.length-12," more payments"]})]})]}),(0,x.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,x.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,x.jsxs)("p",{children:["Remaining: \u20a6",s.remainingBalance.toLocaleString()]}),(0,x.jsxs)("p",{children:["Total Paid: \u20a6",s.totalPaid.toLocaleString()]})]}),(0,x.jsxs)("div",{className:"flex space-x-2",children:[(0,x.jsxs)("button",{onClick:()=>v("/property/".concat(e.propertyId)),className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors flex items-center space-x-2",children:[(0,x.jsx)(i.Ny1,{}),(0,x.jsx)("span",{children:"View Property"})]}),(0,x.jsxs)("button",{onClick:()=>D(e),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[(0,x.jsx)(i.x1c,{}),(0,x.jsx)("span",{children:"Make Payment"})]})]})]}),(0,x.jsxs)("div",{className:"border-t border-gray-200 mt-4 pt-4",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[(0,x.jsx)("button",{onClick:()=>(async(e,s)=>{s?await g(e.id):await n(e.id)})(e,e.autoPay),className:"flex items-center space-x-2 px-4 py-2 rounded-lg transition-colors ".concat(e.autoPay?"bg-green-100 text-green-700 hover:bg-green-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:e.autoPay?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(i.RIx,{className:"text-xl"}),(0,x.jsx)("span",{className:"text-sm font-medium",children:"Auto-Pay On"})]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(i.jZj,{className:"text-xl"}),(0,x.jsx)("span",{className:"text-sm font-medium",children:"Auto-Pay Off"})]})}),(0,x.jsxs)("div",{className:"flex space-x-2",children:[(0,x.jsxs)("button",{onClick:()=>f(e),className:"bg-purple-100 text-purple-700 px-4 py-2 rounded-lg hover:bg-purple-200 transition-colors flex items-center space-x-2",children:[(0,x.jsx)(i.Ani,{}),(0,x.jsx)("span",{className:"text-sm",children:"Extra Payment"})]}),(0,x.jsxs)("button",{onClick:()=>(e=>{if(!e.paymentHistory||0===e.paymentHistory.length)return void o.Ay.error("No payment history to export");const s=[["Payment ID","Date","Amount","Due Date","Status","Method"].join(","),...e.paymentHistory.map(e=>[e.id,new Date(e.paidDate).toLocaleDateString(),"\u20a6".concat(e.amount.toLocaleString()),new Date(e.dueDate).toLocaleDateString(),e.status,e.paymentMethod].join(","))].join("\n"),t=new Blob([s],{type:"text/csv"}),a=window.URL.createObjectURL(t),l=document.createElement("a");l.href=a,l.download="mortgage-payments-".concat(e.id,"-").concat((new Date).toISOString().split("T")[0],".csv"),document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(a),o.Ay.success("Payment history exported successfully!")})(e),className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors flex items-center space-x-2",children:[(0,x.jsx)(i.i3g,{}),(0,x.jsx)("span",{className:"text-sm",children:"Export History"})]})]})]}),e.autoPay&&(0,x.jsx)("p",{className:"text-xs text-green-600 mt-2",children:"\u2713 Payments will be automatically processed on the due date"})]})]},e.id)})})})]}),h&&y&&(0,x.jsx)(m,{mortgageId:y.id,onPaymentSuccess:(e,s)=>{o.Ay.success("Payment processed successfully!"),u(!1),p(null)},onClose:()=>{u(!1),p(null)}})]})},h=()=>{const{user:e}=(0,n.As)(),s=(0,l.Zp)();return e?(0,x.jsxs)("div",{className:"p-6",children:[(0,x.jsx)("div",{className:"mb-8",children:(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"My Mortgages"}),(0,x.jsx)("p",{className:"text-gray-600",children:"Manage your mortgage payments and track your property financing progress."})]}),(0,x.jsxs)("button",{onClick:()=>s("/mortgage"),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[(0,x.jsx)(i.OiG,{}),(0,x.jsx)("span",{children:"Apply for Mortgage"})]})]})}),(0,x.jsx)(g,{})]}):(s("/"),null)}}}]);
//# sourceMappingURL=201.6b124c95.chunk.js.map